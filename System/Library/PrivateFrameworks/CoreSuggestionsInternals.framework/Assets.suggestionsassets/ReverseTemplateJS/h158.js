// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t,a){var i=Scanner.fromMessage(e);i.setLocale(r);var p,n,o,u,s,m,d,l=i.getSpan(),c=[],g=[],h=[],v=1,z="Confirmed",y="All Nippon Airways";o=l.innerCapture(regExpFormatted(/\1.*\n\s(.*)\n/,t.reservationId_prefix),1),p=l.innerCapture(regExpFormatted(/\1\s+([\s\S]*?)\s{2}\u25a0/,t.name_prefix),1),g=p.split(/\n/);for(var F=l.innerCapture(regExpFormatted(/\1(.*)\n(.*)\n(.*)\n(.*)\n/,"["+v+"]"));F;){var f,D,n={};f=D=getFuzzyDate(i.getDetachedSpan(""+F[1]).firstDate()),n.flightNumber=/[N|L][H|X](.*)/.exec(F[1])[1],n.airlineCode=F[1].innerCapture(/(\D{2})\d{2,}/,1);var A=/\s(.*)\s-\s(.*)/.exec(F[2]);n.departureAirportFuzzy=A[1],n.arrivalAirportFuzzy=A[2];var C=/\s(.*)\u767a(.*)\u7740/.exec(F[3]),T=C[1],N=C[2];n.departureDateTime=getFuzzyDate(i.getDetachedSpan(""+f+(""+T)).firstDate()),n.arrivalDateTime=getFuzzyDate(i.getDetachedSpan(""+D+(""+N)).firstDate()),d=/\s(.*)\//.exec(F[4]),d&&(n.seatingType=d[1]),ASSERT(n.flightNumber,n.departureDateTime,n.arrivalDateTime,n.departureAirportFuzzy,n.arrivalAirportFuzzy)&&c.push(n),v++,F=l.innerCapture(regExpFormatted(/\1(.*)\n(.*)\n(.*)\n(.*)\n/,"["+v+"]"))}for(var x=0;g.length>x;x++)for(var S=0;c.length>S;S++){var b=c[S],k={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:y,airlineCode:b.airlineCode,flightNumber:b.flightNumber,departureAirportFuzzy:b.departureAirportFuzzy,departureAirportCode:b.departureAirportCode,departureTime:b.departureDateTime,arrivalAirportFuzzy:b.arrivalAirportFuzzy,arrivalAirportCode:b.arrivalAirportCode,arrivalTime:b.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:g[x].trim()},checkinUrl:m,reservationId:o,reservationStatus:"http://schema.org/Reservation"+z,totalPrice:u,priceCurrency:s,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:b.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:b.seatNumber,seatingType:b.seatingType}}};h.push(k)}return h.length?h:void 0}}).call();
