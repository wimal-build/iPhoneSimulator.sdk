// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var i,n,p,o,g,d=a.getSpan(),s=[],u=[];i=d.innerCapture(regExpFormatted(/\1 (.*),/,r.underPersonName_prefix),1),n=d.innerCapture(regExpFormatted(/\1 ([A-Z0-9]+)/,r.reservationId_prefix),1),g=d.nextText(r.checkinUrl_prefix).nextLink();for(var l=d.nextText(r.reservationForBlock_prefix).nextTag("table2");l!=a.getNullSpan()&&(""+l).indexOf("table4")>-1;)s.push(l),l=l.nextTag("table2");var c=function(e,t){e.forEach(function(e,i){var n,p,o,g,d,s,u,l,c,m,x,T,h,v,C,f=e.nextTag("td3").tagContents();[,p,o,n]=/^([a-zA-Z]+) ([a-zA-Z0-9]+) (.*)/.exec(f),g=e.innerCapture(regExpFormatted(/\1 ([a-zA-Z0-9]+)./,r.ticketNumber_prefix),1),d=e.nextTag("td4").nextTag("td4").tagContents().innerCapture(regExpFormatted(/\1\n(.*)/,r.seatType_prefix),1);var A=e.nextTag("td2").tagContents().split("-")[0].trim();[,c,m]=/(.*) \((.*)\)/.exec(A);var N=e.nextTag("td2").tagContents().split("-")[1].trim();[,v,C]=/(.*) \((.*)\)/.exec(N),s=(""+e.nextTag("td3").nextTag("td3").tagContents()).split("\n")[2].substring(3).replace(/ /g,"-"),u=e.nextTag("td3").nextTag("td3").tagContents().split("\n")[3],l=getFuzzyDate(a.getDetachedSpan(s+", "+u).firstDate()),x=(""+e.nextTag("td3").nextTag("td3").nextTag("td3").tagContents()).split("\n")[2].substring(3).replace(/ /g,"-"),T=e.nextTag("td3").nextTag("td3").nextTag("td3").tagContents().split("\n")[3],h=getFuzzyDate(a.getDetachedSpan(x+", "+T).firstDate()),t({airlineName:n,airlineCode:p,flightNumber:o,departureDateTime:l,departureAirport:c,departureAirportCode:m,arrivalDateTime:h,arrivalAirport:v,arrivalAirportCode:C,ticketNumber:g,seatType:d})})};return c(s,function(e){ASSERT(e.flightNumber,e.departureAirport,e.arrivalAirport)&&u.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:i},checkinUrl:g,reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:p,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}}})}),u.length>=1?u:CONTINUE}}).call();
