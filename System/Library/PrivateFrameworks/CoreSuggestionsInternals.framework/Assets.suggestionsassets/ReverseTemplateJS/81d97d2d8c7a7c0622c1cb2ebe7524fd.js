// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("opentable.com-cancellation-en",function(e){return/(?:reservation has been canceled|Cancell?ation|booking cancellation)$/.test(e.subject)},function(e){if(/(?:reservation has been canceled|Cancell?ation|booking cancellation)$/.test(e.subject)){var t=loadHelper("opentable.com-microdata-parser.js"),n=t(e);if(n)return n;var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,o,s,i,p,l,c,u,m,g,d;if(r=a.getSpan().innerCapture(/(?:Dear|Hello) (.*),/,1),o=a.getSpan().innerCapture(/\boriginal reservation(?::| was) (\d+)/,1),a.getSpan().innerCapture(/\b has cancell?ed your reservation/)?(s=a.getSpan().innerCapture(concatRegExp(/^Dear ($<underName>.*)\,/,/\s*\n($<name>.*) has cancell?ed your reservation for ($<partySize>\d+) ($<startTime>on .*)\./,/\s*\n.*please contact ($=name) at ($<phone>.*?)\./)),p=s?s.$partySize:null,i=s?s.$name:null,c=s?s.$startTime:null,u=s?s.$phone.innerPhoneNumber():null):a.getSpan().innerCapture(/\bYou've successfully cancell?ed your reservation/)?(s=a.getSpan().innerCapture(/\breservation for a party of ($<partySize>\d+) at ($<name>.*) ($<startTime>on .*)\./),p=s?s.$partySize:null,i=s?s.$name:null,c=s?s.$startTime:null):a.getSpan().innerCapture(/\bYou've successfully cancelled your booking:/)&&(c=a.getSpan().firstDate(),p=a.getSpan().innerCapture(/Table for (\d+)/,1),i=a.getSpan().innerCapture(/Restaurant:\s+\n(.*)/,1).trim()),ASSERT(p,i,c,r))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:p,reservationId:o,reservationStatus:"http://schema.org/ReservationCancelled",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:i,url:l,telephone:u,address:m},startTime:c,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:r},cancelReservationUrl:d,modifyReservationUrl:g}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1284","SGf6006ebb"),new ReverseTemplate("opentable.com-cancellation-es",function(e){return/^Cancelaci\xf3n/.test(e.subject)},function(e){if(!/^Cancelaci\xf3n/.test(e.subject))return CONTINUE;var t={};t.hello="Estimado(a)",t.number="N\xfamero de confirmaci\xf3n",t.person=/Grupo de\s+(\d+)/,t.cancel="cancelada:";var n="es_MX",a="opentable.com.mx",r=loadHelper("opentable.com-cancellation-skeleton.js");return r(e,n,t,a)},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1285","SGf717ba62"),new ReverseTemplate("opentable.com-confirmation-en",function(e){return/^Your Reservation Confirmation for/.test(e.subject)||/^Your request for a reservation [\s\S]* is confirmed$/.test(e.subject)||/booking change$/.test(e.subject)},function(e){if(/^Your Reservation Confirmation for/.test(e.subject)||/^Your request for a reservation [\s\S]* is confirmed$/.test(e.subject)||/booking change$/.test(e.subject)){var t="en_US",n=loadHelper("opentable.com-microdata-parser.js"),a=n(e,t);if(a)return a;if(int(e.epoch)<1325376e3)return CONTINUE;var r=Scanner.fromMessage(e);r.setLocale(t);var o={};o.partySize=/(?:Table\sfor|Party\sof)/,o.reservation="Your reservation is confirmed for",o.thanks="Thanks for using OpenTable!";var s,i,p,l,c,u,m,g,d,S,b;p=r.getSpan().innerCapture(/Your (?:table|reservation) for ($<partySize>\d+) at ($<name>.*)\s+(?:will be ready on|is confirmed for)\s+($<startTime>.*)\. The reservation is held under: ($<underName>.*)\./),s=r.getSpan().innerCapture(/^Dear (.*),/,1),s=p?p.$underName||s:null,s!==r.getNullSpan()&&null!==s||(s=r.getSpan().innerCapture(/Dear (.*),/,1),""+s==""&&(s=r.getSpan().next(o.partySize).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/(.*)\s+\1/,o.partySize),1)),""+s==""&&(s=r.getSpan().next(o.partySize).previousTag("td6").tagContents()),""+s==""&&(s=r.getSpan().next("Confirmation #").previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1 (.*)/,"Name:"),1))),c=p?p.$partySize:null,null===c&&(c=r.getSpan().next(o.partySize).parentAnyTag("td").innerCapture(regExpFormatted(/\1\s(\d+)\s/,o.partySize),1));var h=""+r.getSpan().next("Confirmation #: ").parentAnyTag("td").tagContents();if(h&&h!==r.getNullSpan()&&(i=/Confirmation #: ([0-9]*)/.exec(h)[1]),i&&i!==r.getNullSpan()||(i=r.getSpan().innerCapture(/\bYour confirmation number: (\d+)/,1)),i&&i!==r.getNullSpan()||(i=r.getSpan().nextText("Have questions?").parentTag("td4").innerCapture(/\bYou can reference reservation number (\d+)/,1)),d&&d!==r.getNullSpan()||(d=r.getSpan().next("Get directions").nextAnyTag("td"),d.innerAddress()!==r.getNullSpan()&&(d=d.innerAddress())),d&&d!==r.getNullSpan()||(d=r.getSpan().nextText("To get there:").collapseToEnd().withEnd(r.getSpan().nextText("Cross Street:").getStart()).trim(),d=not(d.innerAddress())?d.innerCapture(/^.*\r?\n(.*)$/,1):d.innerAddress()),d&&d!==r.getNullSpan()||(d=r.getSpan().nextTag("table8").nextTag("td8").tagContents().innerCapture(/^([.\S\s]*)\sCross\sStreet/,1),d.innerAddress()!==r.getNullSpan()&&(d=d.innerAddress())),g=r.getSpan().nextText("Questions about your reservation? You can always contact").nextPhoneNumber(),g===r.getNullSpan()&&(g=r.getSpan().nextTag("table8").nextTag("td8").innerPhoneNumber()),l=p?p.$name:null,null===l&&(e.epoch>1472768064&&/Reservation Confirmation/.exec(e.subject)?l=/Your Reservation Confirmation for (.*)/.exec(e.subject)[1]:(l=r.getSpan().innerCapture(/Restaurant:\s+\n(.*)/,1).trim(),l.exists()||(l=(""+r.getSpan().nextTag("table3").nextTag("td3").nextTag("td3").tagContents()).replace(o.reservation,"").replace(o.thanks,"").trim()))),m=p?r.getDetachedSpan(""+p.$startTime):null,null===m&&(m=r.getSpan().next(o.partySize).parentAnyTag("td").innerDate()),S=r.getSpan().nextText("Update your reservation date").nextLink(),S===r.getNullSpan()&&(S=r.getSpan().nextText("View or modify reservation").parentTag("td6").innerLink()),b=r.getSpan().nextText("Cancel your reservation").nextLink(),b===r.getNullSpan()&&(b=r.getSpan().nextText("Cancel reservation").parentTag("td6").innerLink()),ASSERT(c,l,m,s))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:c,reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:l,url:u,telephone:g,address:d},startTime:m,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:s},cancelReservationUrl:b,modifyReservationUrl:S}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1286","SG9fec6b7b"),new ReverseTemplate("opentable.com-confirmation-es",function(e){return/^Confirmaci\xf3n/.test(e.subject)},function(e){if(!/^Confirmaci\xf3n/.test(e.subject))return CONTINUE;var t={};t.number="N\xfamero de confirmaci\xf3n",t.address="DIRECCI\xd3N",t.description="DESCRIPCI\xd3N DEL RESTAURANT",t.reservation="reservaci\xf3n en",t.person="Grupo de",t.modify="CAMBIAR SU RESERVACI\xd3N",t.cancel="CANCELAR SU RESERVACI\xd3N",t.infos=/DETALLES DE LA RESERVACI\xd3N/,t.hello="";var n="es_MX",a="opentable.com.mx",r=loadHelper("opentable.com-confirmation-skeleton.js");return r(e,n,t,a)},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1287","SG903e0ebf"),new ReverseTemplate("opentable.com-reservation-change-en",function(e){return/Change$/.test(e.subject)},function(e){if(/Change$/.test(e.subject)){var t=loadHelper("opentable.com-microdata-parser.js"),n=t(e);if(n)return n;var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,o,s,i,p,l,c,u,m,g,d,S;if(r=a.getSpan().innerCapture(/(?:Dear|Hello) (.*),/,1),o=a.getSpan().innerCapture(/\bConfirmation Number: (\d+)/,1),g=a.getSpan().nextText("To get there:").collapseToEnd().withEnd(a.getSpan().nextText("Cross Street:").getStart()).trim(),g=not(g.innerAddress())?g.innerCapture(/^.*\r?\n(.*)$/,1):g.innerAddress(),m=a.getSpan().nextText("Questions about your reservation? You can always contact").nextPhoneNumber(),s=a.getSpan().innerCapture(/\. ($<name>.*) will be ready for your party of ($<partySize>\d+) ($<startTime>at .*)\./),i=s?s.$name:null,p=s?s.$partySize:null,u=s?s.$startTime:null,d=a.getSpan().nextText("To make another change:").nextLink(),S=a.getSpan().nextText("To cancel:").nextLink(),ASSERT(p,i,u,r))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:p,reservationId:o,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:i,url:l,telephone:m,address:g},startTime:u,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:r},cancelReservationUrl:S,modifyReservationUrl:d}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1288","SG7381b4bd"),new ReverseTemplate("opentable.com-reservation-change-es",function(e){return/^Cambio/.test(e.subject)},function(e){if(!/^Cambio/.test(e.subject))return CONTINUE;var t={};t.person="Grupo de",t.reservation="reservaci\xf3n en",t.number="N\xfamero de confirmaci\xf3n",t.address="DIRECCI\xd3N",t.description="DESCRIPCI\xd3N DEL RESTAURANTE",t.modify="CAMBIAR SU RESERVACI\xd3N",t.cancel="CANCELAR SU RESERVACI\xd3N",t.infos="DETALLES DE LA RESERVACI\xd3N",t.infosCapture=/(DETALLES DE LA RESERVACI\xd3N)/,t.hello="";var n="es_MX",a="opentable.com.mx",r=loadHelper("opentable.com-reservation-change-skeleton.js");return r(e,n,t,a)},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1289","SGbde67902"),new ReverseTemplate("opentable.com-upcoming-reservation-en",function(e){return/^Your Upcoming Reservation at/.test(e.subject)},function(e){if(/^Your Upcoming Reservation at/.test(e.subject)){var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,o,s,i,p,l,c,u,m,g;if(n=t.getSpan().innerCapture(/^Dear (.*),/,1),a=t.getSpan().innerCapture(/\bConfirmation Number: (\d+)/,1),u=t.getSpan().nextText("To get there:").collapseToEnd().withEnd(t.getSpan().nextText("Cross Street:").getStart()).trim(),u=not(u.innerAddress())?u.innerCapture(/^.*\r?\n(.*)$/,1):u.innerAddress(),c=t.getSpan().nextText("Questions about your reservation? You can always contact").nextPhoneNumber(),r=t.getSpan().innerCapture(/\s+($<name>.*) will be ready for your\s+party of ($<partySize>\d+) ($<startTime>at .*)\./),s=r?r.$partySize:null,o=r?r.$name:null,l=r?t.getDetachedSpan(""+r.$startTime):null,n=r?r.$underName||n:null,m=t.getSpan().nextText("Update your reservation date").nextLink(),g=t.getSpan().nextText("Cancel your reservation").nextLink(),ASSERT(s,o,l,n))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:s,reservationId:a,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:o,url:i,telephone:c,address:u},startTime:l,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:n},cancelReservationUrl:g,modifyReservationUrl:m}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1292","SGf61fee40")]);
