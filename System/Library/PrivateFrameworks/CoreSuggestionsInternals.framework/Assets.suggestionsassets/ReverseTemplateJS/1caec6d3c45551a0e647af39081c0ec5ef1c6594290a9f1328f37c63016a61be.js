// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("southwest.com-earlybird-confirmation-en",function(e){return/^Southwest Airlines EarlyBird Confirmation/.test(e.subject)},function(e){if(/^Southwest Airlines EarlyBird Confirmation/.test(e.subject)){var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,n,i,o,s,p,m,l,u,c,h,g,d,v,b,C,f,T,y,N=[],A={},S=loadHelper("southwest.com-common.js");a=r.getSpan().innerCapture(/\bCheck-In Online <(.*?)>/,1),t=r.getSpan().innerCapture(/\bConfirmation Number: (\w+)/,1),l=r.getSpan().nextText("Departure/Arrival").parentTag("table4").allInnerTags("tr4").map(function(e){return e.allInnerTagsFiltered("td4")}),m=r.getSpan().innerCapture(/\bTotal Cost: .*?([\d,.]+)/,1);for(var k=1;l.length>k;k++)s=l[k],4===s.length&&(i=s[0],o=s[3].innerDate(),p=s[2].innerCapture(/(\d+)/,1),g=s[1].innerCapture(S.departureRegex),C=s[1].innerCapture(S.arrivalRegex),valid(g,C)&&(u=s[1].allDates(),h=g.$name.result()||g.$changeName.result()||"Southwest Airlines",v=g.$departureAirport,b=g.$departureCode,d=combineDateAndTime(o,u[0]),T=C.$arrivalAirport,y=C.$arrivalCode,f=combineDateAndTime(o,u[1])),ASSERT(i,h,p,b,d,y,f)&&(A[""+i]={name:i,seats:{},seatingType:{},totalPrice:m},N.push({airlineName:h,flightNumber:p,reservationId:t,departureAirport:v,departureCode:b,departureTime:d,arrivalAirport:T,arrivalCode:y,arrivalTime:f,passengers:A}),c=p=u=h=v=b=d=T=y=f=null,A={}));for(var I=[],w=0;N.length>w;w++)for(var x=N[w],F=Object.keys(x.passengers),R=0;F.length>R;R++){var j=x.passengers[F[R]];n={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode||"WN",flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:j.name},checkinUrl:a,reservationId:x.reservationId,reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:j.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:j.seats[x.flightNumber]}},totalPrice:j.totalPrice,priceCurrency:j.currency},valid(j.membershipNumber)&&(n.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:j.membershipNumber,programName:"Rapid Rewards"}),I.push(n)}if(I.length)return I}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/185/422/423","SG92044fc9"),new ReverseTemplate("southwest.com-itinerary-en",function(e){return/^Southwest Airlines Confirmation/.test(e.subject)||/^(?:(?:UPDATED|CANCELLED) )?[Ff]light reservation/.test(e.subject)||/^Ticketless Travel Passenger Itinerary/.test(e.subject)},function(e){if(/^Southwest Airlines Confirmation/.test(e.subject)||/^(?:(?:UPDATED|CANCELLED) )?[Ff]light reservation/.test(e.subject)||/^Ticketless Travel Passenger Itinerary/.test(e.subject)){var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,n,i,o,s,p=[],m={},l=loadHelper("southwest.com-common.js"),u=/^CANCELLED flight reservation/.test(e.subject)?"Carryon Items:":/What you need to know to travel:/.test(e.plain)?"What you need to know to travel:":"Carry-on Items";/^CANCELLED flight reservation/.test(e.subject)&&(a="Cancelled"),t=r.getSpan().innerCapture(/\bCheck In Online <(.*?)>/,1),o=r.getSpan().nextText("Total Air Cost").nextTag("td5").nextTag("td5").tagContents();for(var c=r.getSpan();c.nextText("AIR Itinerary").exists();){c=c.nextText("AIR Itinerary").withEnd(c.nextText(u).getEnd()),m={},s=c.innerText("Passenger(s)").nextTag("table4").withEnd(c.innerText("Departure/Arrival").parentTag("table4").getStart()).allInnerTags("table4").map(function(e){return e.allInnerTagsFiltered("td4")}).filter(function(e){return e.length>=1&&e[0].innerCapture(/^[A-Z\/\s]+$/)});for(var h,g=0;h=s[g++];)i=""+h[0],m[i]={name:i,membershipNumber:h[1]&&h[1].innerCapture(/^(\d+)/,1),ticketNumber:h[2],totalPrice:o,seats:{},seatingType:{}};l.addFlightLegs(p,m,u,c),c=c.collapseToEnd()}for(var d=[],g=0;p.length>g;g++)for(var v=p[g],b=Object.keys(v.passengers),C=0;b.length>C;C++){var f=v.passengers[b[C]];n={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:v.airlineName,airlineCode:v.airlineCode||"WN",flightNumber:v.flightNumber,departureAirportFuzzy:v.departureAirport,departureAirportCode:v.departureCode,departureTime:v.departureTime,arrivalAirportFuzzy:v.arrivalAirport,arrivalAirportCode:v.arrivalCode,arrivalTime:v.arrivalTime},underName:{"@type":"http://schema.org/Person",name:f.name},checkinUrl:t,reservationId:v.reservationId,reservationStatus:"http://schema.org/Reservation"+(a||"Confirmed"),reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:f.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:f.seats[v.flightNumber]}},totalPrice:f.totalPrice,priceCurrency:f.currency},not(f.membershipNumber)||(n.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:f.membershipNumber,programName:"Rapid Rewards"}),d.push(n)}if(d.length)return d}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/185/422/424","SG4dc16108"),new ReverseTemplate("southwest.com-trip-reminder-en",function(e){return/^Your trip is around the corner!/.test(e.subject)||/^Your Upcoming .*? Itinerary/.test(e.subject)},function(e){if(/^Your trip is around the corner!/.test(e.subject)||/^Your Upcoming .*? Itinerary/.test(e.subject)){var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,n,i,o,s=[],p={},m=loadHelper("southwest.com-common.js");t=r.getSpan().innerCapture(/\bCheck In Online <(.*?)>/,1),o=r.getSpan().nextText("Passenger(s)").nextTag("table4").withEnd(r.getSpan().nextText("Departure/Arrival").parentTag("table4").getStart()),i=o.allInnerTags("table4").map(function(e){return e.allInnerTags("td4").map(function(e){return e.tagContents()}).filter(function(e){return e.getLength()})}).filter(function(e){return e.length>=1}).map(function(e){return e[e.length-1]});for(var n,l=0;n=i[l++];)n=""+n,p[n]={name:n,seats:{},seatingType:{}};var u=/What you need to know to travel:/.test(e.plain)?"What you need to know to travel:":"Carry-on Items";m.addFlightLegs(s,p,u,r.getSpan());for(var c=[],l=0;s.length>l;l++)for(var h=s[l],g=Object.keys(h.passengers),d=0;g.length>d;d++){var v=h.passengers[g[d]];a={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:h.airlineName,airlineCode:h.airlineCode||"WN",flightNumber:h.flightNumber,departureAirportFuzzy:h.departureAirport,departureAirportCode:h.departureCode,departureTime:h.departureTime,arrivalAirportFuzzy:h.arrivalAirport,arrivalAirportCode:h.arrivalCode,arrivalTime:h.arrivalTime},underName:{"@type":"http://schema.org/Person",name:v.name},checkinUrl:t,reservationId:h.reservationId,reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:v.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:v.seats[h.flightNumber]}},totalPrice:v.totalPrice,priceCurrency:v.currency},not(v.membershipNumber)||(a.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:v.membershipNumber,programName:"Rapid Rewards"}),c.push(a)}if(c.length)return c}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/185/422/425","SGb3901f53")]);