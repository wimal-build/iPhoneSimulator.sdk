// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,o,p,s,l,m,u,c,g,d=a.getSpan();i=d.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonName_prefix),1),n=d.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonEmail_prefix),1),o=d.innerCapture(regExpFormatted(/\1 (.*)/,t.underPersonPhone_prefix),1),p=d.innerCapture(regExpFormatted(/\1 (.*)/,t.reservationId_prefix),1);var h=""+d.nextText(t.totalPrice_prefix).nextTag("td4").tagContents();s=h.substring(1),l=h[0],u=c=g=d.nextText(t.checkinUrl_prefix).nextLink();var v=(""+d.nextText(t.isHotelEmail)).length>0;if(!v){var x=[],f=[];x=d.nextText(t.reservationForBlock_prefix).nextTag("table4").allInnerTags("tr4");var T=function(e,r){e.forEach(function(e){var t=e.allInnerTags("td4");if(1==t.length&&0!=(""+t[0].tagContents()).length){e=t[0];var i,n,o,p,s,l,m,u,c,g,d,h=(""+e.tagContents()).split("\n");i=s=h[0].trim(),n=h[3].split("-")[0].trim(),l=h[3].split("-")[1].trim(),o=i+", "+n,o=getFuzzyDate(a.getDetachedSpan(o).firstDate()),m=s+", "+l,m=getFuzzyDate(a.getDetachedSpan(m).firstDate()),p=h[4].split("-")[0].trim(),u=h[4].split("-")[1].trim(),[,c,g,d]=/^([a-zA-Z0-9]+) ([a-zA-Z0-9]+) (.*)/.exec(h[2]),r({airlineName:d,airlineCode:c,flightNumber:g,departureDateTime:o,departureAirport:p,departureAirportCode:null,arrivalDateTime:m,arrivalAirport:u,arrivalAirportCode:null})}})};return T(x,function(e){ASSERT(e.flightNumber,e.departureAirport,e.arrivalAirport)&&f.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:i},checkinUrl:u,reservationId:p,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:s,priceCurrency:l,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:m,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}}})}),f.length>=1?f:CONTINUE}var C,y,A,F,N,z,S="Confirmed";return[,A,C,y,z]=d.nextText(t.reservationForBlock_prefix).nextTag("table4").nextTag("td4").tagContents().innerCapture(regExpFormatted(/(.*)\n\n(.*)\n(.*)\n(.*)/)),ASSERT(C,y,A)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:i,email:n},totalPrice:s,priceCurrency:l,checkinTime:C,checkoutTime:y,modifyReservationUrl:c,cancelReservationUrl:g,reservationStatus:"http://schema.org/Reservation"+S,reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:A,url:F,telephone:N,address:z}}]:void 0}}).call();