// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var r=Scanner.fromMessage(e);r.setLocale(t);var a=loadHelper("europcar-microdata-parser.js"),p=a(e);if(p)return p;var i,o,s,c,d,l,g,m,u,h,x,C,v,T,f,A,S,k,y,R,I;if(n.confirmSubject.test(e.subject)){s=r.getSpan().nextRegExp(n.reservationId).innerCapture(n.reservationId,1),i=r.getSpan().nextText(n.guestName).nextTag("td4").nextTag("td4").tagContents(),l=r.getSpan().nextText(n.modifyUrl).parentTag("td3").tagContents().innerLink(),g=l,h=r.getSpan().nextText(n.car).nextTag("table3").nextTag("td3").tagContents();var N=r.getSpan().nextText(n.pickup).parentTag("table3");I=N.allInnerDates(t),R=/\:/.test(I[0])?I[0]:I[1],y=N.innerPhoneNumber(),k=N.next(n.pickupAddress).innerCapture(n.pickupAddress,1).trim(),0===(""+k).length&&n.pickupAddressAlt&&(k=N.next(n.pickupAddressAlt).parentTag("td3").innerCapture(n.pickupAddressAlt,1).trim());var b=r.getSpan().nextText(n.dropoff).parentTag("table3");I=b.allInnerDates(t),A=/\:/.test(I[0])?I[0]:I[1],f=b.innerPhoneNumber(),T=b.next(n.pickupAddress).innerCapture(n.pickupAddress,1).trim(),0===(""+T).length&&n.pickupAddressAlt&&(T=b.next(n.pickupAddressAlt).innerCapture(n.pickupAddressAlt,1).trim());var P=r.getSpan().nextText(n.price).nextTag("td4").tagContents();0===(""+P).length&&n.priceAlt&&(P=r.getSpan().nextText(n.priceAlt).nextTag("td4").tagContents());var E=P.innerCapture(/^(.+)\(/,1);if(0===(""+P).length&&(P=E),n.priceInner){var U=P.innerCapture(n.priceInner,1);0!==(""+U).length&&(P=P.innerCapture(n.priceInner,1))}if(m=P.innerCapture(/([\d,.]+)/,1),u=P.innerCapture(/([^\d,.]+)/,1).trim(),!ASSERT(i,s,R,A,k,T))return CONTINUE}else if(n.cancellationSubject.test(e.subject)&&(i=r.getSpan().nextRegExp(n.cancelGuestName).tagContents().innerCapture(n.cancelGuestName,1),s=r.getSpan().nextRegExp(n.cancelReservationId).tagContents().innerCapture(n.cancelReservationId,1),c="Cancelled",R=r.getSpan().nextText(n.time).nextDate(),!ASSERT(i,s)))return CONTINUE;return h?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:m,priceCurrency:u,reservationId:s,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),checkinUrl:d,modifyReservationUrl:l,cancelReservationUrl:g,underName:{"@type":"http://schema.org/Person",name:i,email:o},provider:{"@type":"http://schema.org/Organization",name:"Europcar"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:h},license:x,color:C},pickupTime:R,pickupLocation:{"@type":"http://schema.org/Place",name:S,telephone:y,address:k},dropoffTime:A,dropoffLocation:{"@type":"http://schema.org/Place",name:v,telephone:f,address:T}}]:[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:m,priceCurrency:u,reservationId:s,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),checkinUrl:d,modifyReservationUrl:l,cancelReservationUrl:g,underName:{"@type":"http://schema.org/Person",name:i,email:o},provider:{"@type":"http://schema.org/Organization",name:"Europcar"},pickupTime:R,pickupLocation:{"@type":"http://schema.org/Place",name:S,telephone:y,address:k},dropoffTime:A,dropoffLocation:{"@type":"http://schema.org/Place",name:v,telephone:f,address:T}}]}}).call();
