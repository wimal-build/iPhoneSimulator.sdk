// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("rezserver.com-car-en",function(e){return/Your (?:[AC]AA|Travel.com)\s.*?Car (?:Itinerary|Cancellation)/.test(e.subject)},function(e){if(!/Your (?:[AC]AA|Travel.com)\s.*?Car (?:Itinerary|Cancellation)/.test(e.subject))return CONTINUE;var t="en_US",r={};r.reservationIdPrefix="Confirmation #:",r.reservationStatusPrefix="Booking Status:",r.underNamePrefix="Driver Name:",r.providerNamePrefix="Rental Partner:",r.carBrandRegExp=/(.+) or similar/,r.pickUpDetailsPrefix="Pick-up Details:",r.dropOffDetailsPrefix="Drop-Off Details:",r.modifyReservationUrlPrefix="Change Your Reservation";var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,s,g,p,m,c,d,x,u=a.getSpan();return n=u.next(r.reservationIdPrefix).nextAnyTag("td").tagContents(),i=u.next(r.reservationStatusPrefix).nextAnyTag("td").tagContents(),o=u.next(r.underNamePrefix).nextAnyTag("td").tagContents(),s=u.next(r.providerNamePrefix).nextAnyTag("td").tagContents(),g=u.next(r.carBrandRegExp).parentAnyTag("td").tagContents().innerCapture(r.carBrandRegExp,1),[p,m]=(""+u.next(r.pickUpDetailsPrefix).nextAnyTag("td").tagContents()).split(/\n/),p=a.getDetachedSpan(p),m=a.getDetachedSpan(m),[c,d]=(""+u.next(r.dropOffDetailsPrefix).nextAnyTag("td").tagContents()).split(/\n/),c=a.getDetachedSpan(c),d=a.getDetachedSpan(d),x=u.next(r.modifyReservationUrlPrefix).nextLink(),ASSERT(m||pickUpLocationName,p)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",reservationStatus:"http://schema.org/Reservation"+i,reservationId:n,modifyReservationUrl:x,cancelReservationUrl:x,underName:{"@type":"http://schema.org/Person",name:o},provider:{"@type":"http://schema.org/Organization",name:s},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:g}},pickupTime:p,pickupLocation:{"@type":"http://schema.org/Place",address:m},dropoffTime:c,dropoffLocation:{"@type":"http://schema.org/Place",address:d}}]:void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1015/1016","SG16b5974b"),new ReverseTemplate("rezserver.com-flight-confirmation-en",function(e){return/Your (?:[AC]AA|Travel\.com).*?\sFlight Itinerary/.test(e.subject)},function(e){if(!/Your (?:[AC]AA|Travel\.com).*?\sFlight Itinerary/.test(e.subject))return CONTINUE;var t="en_US",r={};r.reservationIdPrefix="Airline Confirmation:",r.reservationStatusPrefix="Booking Status:",r.flightsHeaderRegExp=/Your Trip from .+ to .+/,r.legsHeaderRegExp=/(?:(?:Departing|Returning) )?Flight:/,r.hasMoreLegsRegExp=/Connection at .+ \([A-Z]{3}\)/,r.airlineNameRegExp=/(.+?)(?:\s?\(.+?\))?\s-/,r.flightNumberRegExp=/Flight\s(\d+)/,r.passengerNameSuffix="Passenger and Ticket Information",r.passengerNameRegExp=/(.+) - Passenger and Ticket Information/,r.ticketNumberRegExp=/Ticket number: (\d+)/;var a=Scanner.fromMessage(e);a.setLocale(t);for(var n=a.getSpan(),i=[],o=[],s=[],g=n.next(r.reservationIdPrefix).nextAnyTag("td").tagContents(),p=n.next(r.reservationStatusPrefix).nextAnyTag("td").tagContents(),m=n.next(r.flightsHeaderRegExp).next(r.legsHeaderRegExp);m.exists();){var c=m.parentAnyTag("td").tagContents().innerDate(),d=!1;do{m=m.nextTag("table3");var x=m.allInnerTags("td3").map(function(e){return e.tagContents()}).filter(function(e){return(""+e).length>0});if(x&&x.length){var u=a.getDetachedSpan(c+" "+x[1]),f=a.getDetachedSpan(c+" "+x[6]);i.push({airlineName:x[9].innerCapture(r.airlineNameRegExp,1),flightNumber:x[9].innerCapture(r.flightNumberRegExp,1),departureAirport:x[2],departureAirportCode:x[3],departureDateTime:u,arrivalAirport:x[7],arrivalAirportCode:x[8],arrivalDateTime:f})}d=m.next(r.hasMoreLegsRegExp).exists(),d&&(m=m.next(r.hasMoreLegsRegExp))}while(d);m=m.next(r.legsHeaderRegExp)}for(m=n.next(r.passengerNameSuffix);m.exists();)o.push({name:m.parentAnyTag("td").tagContents().innerCapture(r.passengerNameRegExp,1),ticketNumber:m.nextAnyTag("td").tagContents().innerCapture(r.ticketNumberRegExp,1)}),m=m.next(r.passengerNameSuffix);return 0===o.length&&o.push({}),i.forEach(function(e){o.forEach(function(t){ASSERT(e.airlineCode||e.airlineName,e.flightNumber,e.departureAirport,e.departureDateTime),s.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineCode:e.airlineCode,airlineName:e.airlineName,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:t.name},reservationId:g,reservationStatus:"http://schema.org/Reservation"+p,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:t.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:t.seat,seatingType:null}}})})}),s},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1015/1017","SGdf6c3da1"),new ReverseTemplate("rezserver.com-hotel-confirmation-en",function(e){return/Your Travel\.com Hotel Itinerary/.test(e.subject)},function(e){if(!/Your Travel\.com Hotel Itinerary/.test(e.subject))return CONTINUE;var t="en_US",r={};r.reservationIdPrefix="Confirmation #:",r.reservationStatusPrefix="Booking Status:",r.underNamePrefix="Guest Name:",r.hotelNamePrefix="Hotel Name:",r.hotelAddressPrefix="Address:",r.hotelPhonePrefix="Phone:",r.checkInDateTimePrefix="Check In:",r.checkOutDateTimePrefix="Check Out:",r.modifyReservationUrlPrefix="Review/Cancel Your Reservation";var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,s,g,p,m,c,d,x=a.getSpan();return n=x.next(r.reservationIdPrefix).nextAnyTag("td").tagContents(),i=x.next(r.reservationStatusPrefix).nextAnyTag("td").tagContents(),o=x.next(r.underNamePrefix).nextAnyTag("td").tagContents(),s=x.next(r.hotelNamePrefix).nextAnyTag("td").tagContents(),g=x.next(r.hotelPhonePrefix).nextAnyTag("td").tagContents().innerCapture(/([0-9\+\-]+)/,1),p=x.next(r.hotelAddressPrefix).nextAnyTag("td").tagContents(),m=x.next(r.checkInDateTimePrefix).nextAnyTag("td").tagContents(),c=x.next(r.checkOutDateTimePrefix).nextAnyTag("td").tagContents(),d=x.next(r.modifyReservationUrlPrefix).nextLink(),ASSERT(m,s||p)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:o},checkinTime:m,checkoutTime:c,modifyReservationUrl:d,reservationStatus:"http://schema.org/Reservation"+i,reservationId:n,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:s,telephone:g,address:p}}]:void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1015/1018","SGbf027964")]);
