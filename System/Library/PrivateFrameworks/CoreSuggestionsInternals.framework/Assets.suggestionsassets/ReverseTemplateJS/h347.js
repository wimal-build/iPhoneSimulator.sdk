// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,s,i,o,d,g,p,x,c,h,l,m;r=a.getSpan().nextText(n.underPersonNamePrefix).nextAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/(.*)\n/,1),s=""+e.to,p=a.getSpan().innerCapture(regExpFormatted(/\1\s+?(\d+)\s+?/,n.reservationIdPrefix),1);var T=a.getSpan().nextText(n.reservationIdPrefix).nextDate().parentAnyTag("table");i=T.nextAnyTag("td").tagContents(),T=T.nextAnyTag("td").nextAnyTag("td").tagContents(),l=a.getSpan().innerCapture(regExpFormatted(/\1\s+(.*)/,n.checkInTime),1);var u=a.getDateDD(T);if(u&&u.iso8601&&u.endIso8601)x=combineDateAndTime(u.iso8601,l),c=u.endIso8601;else{var A=T.innerCapture(/[a-zA-Z]{3}(.*) - [a-zA-Z]{3}(.+?)\s/);x=a.getDetachedSpan((""+A[1]).replace(/\//g," ")+" "+l).innerDate(),c=a.getDetachedSpan((""+A[2]).replace(/\//g," ")).innerDate()}g=a.getSpan().nextText(n.hotelAddressPrefix).nextLink(),d=a.getSpan().nextText(n.hotelAddressPrefix).nextAddress(),o=(""+a.getSpan().nextText(n.hotelAddressPrefix).nextPhoneNumber()).replace(n.phonePrefix,"").trim();var C=a.getSpan().nextText(n.totalPricePrefix).parentAnyTag("td").tagContents();C.innerCapture(/(\d+)/,1).exists()||(C=C.nextAnyTag("td").tagContents()),m=C.innerCapture(/(.)\d+/,1),h=C.innerCapture(/([\d,.]+)/,1);var v=n.cancelled.test(e.plain)?"Cancelled":"Confirmed";return ASSERT(OR(r,s),d,x)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:s},totalPrice:h,priceCurrency:m,checkinTime:x,checkoutTime:c,reservationStatus:"http://schema.org/Reservation"+v,reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:i,telephone:o,url:g,address:d}}]:CONTINUE}}).call();