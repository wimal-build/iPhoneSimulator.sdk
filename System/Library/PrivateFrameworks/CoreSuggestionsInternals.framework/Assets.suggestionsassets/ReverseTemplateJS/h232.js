// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t,a){if(int(e.epoch)<=1443052800)return CONTINUE;var i=Scanner.fromMessage(e);i.setLocale(r);var n,p,o,s,m,g,u=i.getSpan(),d=[],l=[];n=u.next(t.reservationId_prefix).nextAnyTag("table").nextAnyTag("td").tagContents(),o=u.next(t.price_prefix).nextAnyTag("td").tagContents(),p=u.next(t.price_prefix).nextAnyTag("td").nextAnyTag("td").tagContents(),s=u.next(t.checkinUrl_prefix).nextLink();var c=u.allInnerTags("tr3").filter(function(e,r){var t=""+e.tagContents();return 0!==t.length&&(t.indexOf("Depart ")>-1||t.indexOf("Arrive in")>-1)});return c.forEach(function(e,r){var a,n,p,o,s,l,c,h,v,A,N,T,x,C="Southwest Airlines",f="WN";e=e.allInnerTags("td3"),""+e[0].tagContents()!=""&&(m=g=e[0].tagContents()),a=e[1].tagContents();var y;y=e[e.length-1],p=/(?:Depart|Change planes.*in)\s(.*)\s\((.*)\).*at\s(.*)/.exec(""+y),l=p[1],c=p[2],o=p[3],h=/Arrive in\s(.*)\s\((.*)\)\s.*at\s(.*)\s\s\n/.exec(""+y),N=h[1],T=h[2],v=h[3],s=getFuzzyDate(i.getDetachedSpan(m+" "+o).firstDate()),A=getFuzzyDate(i.getDetachedSpan(g+" "+v).firstDate()),x=u.next(t.passengers_prefix).nextAnyTag("table").nextAnyTag("td").nextAnyTag("td").tagContents();var b,D="Rapid Rewards";d.push({airlineName:C,airlineCode:f,flightNumber:a,departureDateTime:s,departureAirport:l,departureAirportCode:c,arrivalDateTime:A,arrivalAirport:N,arrivalAirportCode:T,ticketNumber:n,underPersonName:x,programName:D,membershipNumber:b})}),d.forEach(function(e,r){ASSERT(e.departureDateTime,e.arrivalDateTime,e.departureAirportCode,e.arrivalAirportCode),l.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:e.underPersonName},checkinUrl:s,reservationId:n,reservationStatus:"http://schema.org/Reservation"+a,totalPrice:p,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}},programMembershipUsed:{"@type":"http://schema.org/ProgramMembership",membershipNumber:e.membershipNumber,programName:e.programName}})}),l.length>=1?l:CONTINUE}}).call();
