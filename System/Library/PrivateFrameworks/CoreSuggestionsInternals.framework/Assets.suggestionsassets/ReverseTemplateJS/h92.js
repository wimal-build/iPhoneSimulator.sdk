// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,p,o,g,u,l,d,m=[],s=[],h=[];p=a.getSpan().nextText(r.pnr).parentTag("td2").tagContents().innerCapture(regExpFormatted(/\1 (.*)/,r.pnr),1),o=a.getSpan().nextText(r.total).nextTag("td6").nextTag("td6"),g=a.getDetachedSpan(o.tagContents().innerCapture(regExpFormatted(/([\d\.,]+)/),1)+o.nextTag("td6").tagContents().trim()),u=o.tagContents().innerCapture(regExpFormatted(/([^\d\.,]+)/),1).trim(),n=a.getSpan().nextTag("table6").allInnerTags("tr6");for(var v=0;n.length>v;v+=2)d={},d.name=n[v].innerTag("td6").nextTag("td6").tagContents(),n[v+1]&&(d.ticketNumber=n[v+1].lastInnerTag("td6").tagContents().innerCapture(regExpFormatted(/(\d+)/),1),s.push(d));i=a.getSpan().allInnerTags("tr5");for(var T=0;i.length-1>T;T++){var c=i[T].allInnerTags("td5");l={};var z;7===c.length&&(z=c[1].innerDate(),l.flightNumber=c[0].tagContents().innerCapture(/(\d+)/,1).trim(),l.departureTime=getFuzzyDate(a.getDetachedSpan(z+" "+c[2].innerDate())),l.arrivalTime=getFuzzyDate(a.getDetachedSpan(z+" "+c[5].innerDate())),unSpanDate_(l.departureTime)>unSpanDate_(l.arrivalTime)&&(l.arrivalTime=modifyDate(l.arrivalTime,1)),l.departureAirportFuzzy=c[3].tagContents(),l.arrivalAirportFuzzy=c[6].tagContents(),ASSERT(l.arrivalAirportFuzzy,l.departureAirportFuzzy,l.flightNumber,l.departureTime,l.arrivalTime)&&m.push(l))}for(var C=0;m.length>C;C++){l=m[C];for(var y=0;s.length>y;y++){d=s[y];var F={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Alitalia Linee Aeree Italiane",airlineCode:"AZ",flightNumber:l.flightNumber,departureAirportFuzzy:l.departureAirportFuzzy,departureAirportCode:l.departureAirportCode,departureTime:l.departureTime,arrivalAirportFuzzy:l.arrivalAirportFuzzy,arrivalAirportCode:l.arrivalAirportCode,arrivalTime:l.arrivalTime},underName:{"@type":"http://schema.org/Person",name:d.name},checkinUrl:"",reservationId:p,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:g,priceCurrency:u,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:d.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}};h.push(F)}}return h.length?h:void 0}}).call();