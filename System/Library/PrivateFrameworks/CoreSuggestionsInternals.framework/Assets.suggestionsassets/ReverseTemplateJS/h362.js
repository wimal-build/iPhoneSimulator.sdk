// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,g,s,p,x,l,m,c,d,C,u,h;if(!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;s=a.getSpan().nextRegExp(n.reservationId).nextAnyTag("td").tagContents(),r=a.getSpan().nextRegExp(n.guestName).nextAnyTag("td").tagContents(),i=a.getSpan().nextRegExp(n.guestEmail).nextAnyTag("td").tagContents(),c=a.getSpan().nextRegExp(n.hotelName).nextAnyTag("td").tagContents().innerCapture(regExpFormatted(/\>\s(.+)\s</),1),m=""+a.getSpan().nextRegExp(n.hotelName).nextAnyTag("td").tagContents().innerCapture(/(http.+)\>/,1);var T=a.getSpan().nextText(n.dates).nextAnyTag("td").tagContents();x=T.innerDate(),l=T.innerCapture(/(.+) . (.+)/,2),l=a.getDetachedSpan(l+" ").innerDate();var S=a.getSpan().nextRegExp(n.price).nextAnyTag("td").tagContents();if(o=S.innerCapture(/([\d,.]+)/,1),g=S.innerCapture(/([^\d,.]+)/,1).trim(),C=a.getSpan().nextRegExp(n.hotelAddress).nextRegExp(n.hotelAddress).nextAnyTag("td").tagContents(),d=a.getSpan().nextRegExp(n.hotelPhone).tagContents().innerCapture(n.hotelPhone,1),u=h=a.getSpan().nextText(n.modifyUrl).tagContents().nextLink(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(r,s,x,l,C))return CONTINUE;p="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(!ASSERT(r,x,l,C))return CONTINUE;p="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:o,priceCurrency:g,checkinTime:x,checkoutTime:l,modifyReservationUrl:u,cancelReservationUrl:h,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:c,url:m,telephone:d,address:C}}]}}).call();
