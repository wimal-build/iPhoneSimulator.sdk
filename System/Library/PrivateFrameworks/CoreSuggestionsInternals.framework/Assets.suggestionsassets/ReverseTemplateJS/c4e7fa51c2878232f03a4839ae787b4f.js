// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("expedia.com-flight-changes-en",function(e){return/^Changes have been made to your .*? flight/.test(e.subject)||/^Your flight itinerary .*? changed$/.test(e.subject)},function(e){if(/^Changes have been made to your .*? flight/.test(e.subject)||/^Your flight itinerary .*? changed$/.test(e.subject)){if(!/notifications@expedia.com/.test(e.from)){var t="en_US",r={};r.itineraryLabel="Revised Itinerary",r.confirmationLabel="Airline confirmation code",r.passenger="Traveler(s)",r.traveler="Traveler",r.ticketNo="Airline Ticket No.",r.cancelled=/Per your request, your flight is canceled/,r.cancelledLabel="CANCELED",r.reservationId="Expedia Itinerary No.";var a=loadHelper("expediamail.com-flight-alternative-skeleton.js");return a(e,t,r)}var i=Scanner.fromMessage(e);i.setLocale("en_US");var n,l,o,s,c,d,p,u,m,v,h,f,g,b,T,y,C,k=[],j={};if(n=i.getSpan().nextText("Passenger(s):").parentAnyTag("td").tagContents().innerCapture(/\bPassenger\(s\): (.*)/,1),not(n))return CONTINUE;n=n.split(",").map(function(e){return e.trim()});for(var x=0;n.length>x;x++)j[""+n[x]]={name:n[x],seats:{},seatingType:{}};c=i.getSpan().next(/Your updated flight (?:schedule|itinerary) is below/).next(/(?:Flight (?:Change )?Details|Cancelled Flight)/).parentAnyTag("table");var I=c.getTagNumber();c=c.withStart(i.getSpan().next(/Your updated flight (?:itinerary|schedule) is below/).getEnd()).allInnerTags("tr"+I).map(function(e){return e.allInnerTagsFiltered("td"+I)}).filter(function(e){return e.length>0});for(var S=0;c.length>S;S++)if(l=c[S],l[0].innerCapture(/^(?:Flight(?: Change)? Details|Cancelled Flight)/)&&l[1])h=l[1],/Cancelled Flight/.test(l[0])&&(C="Cancelled");else if(l[1]&&l[1].innerCapture(/^Flight Number:/))p=l[0],d=l[1].innerCapture(/^Flight Number: ($<code>\w{2})\s*(?:\d+\s+)?($<flightNumber>\d+)/),u=d?d.$code:null,m=d?d.$flightNumber:null,i.getSpan().nextText(""+p+" confirmation code:").exists()&&(o=i.getSpan().innerCapture(RegExp(regExpEscape(""+p)+" confirmation code: (.*)\\s"),1));else if(l[0].innerCapture(/^From:/)&&l[1])f=l[0].innerCapture(/^From:.*\(([A-Z]{3})[-\)]/,1);else if(l[0].innerCapture(/^To:/)&&l[1])b=l[0].innerCapture(/^To:.*\(([A-Z]{3})[-\)]/,1),T=l[1].innerCapture(/^Arrive: .* \+1 day$/),g=combineDateAndTime(h,l[1].lastInnerDate()),not(T)||(g=modifyDate(g,1));else if(l[1]&&l[1].innerCapture(/^Class:/))y=l[1].innerCapture(/^Class: (.*)/,1);else if(l[0].innerCapture(/^Equipment:/)){if(l[1]&&l[1].innerCapture(/^Seats:/)&&(s=l[1].innerCapture(/^Seats: (.*)/,1).split(",").map(function(e){return e.trim()})),valid(m)){n=Object.keys(j);for(var x=0;n.length>x;x++)valid(s)&&(j[n[x]].seats[""+m]=s[x]),valid(y)&&(j[n[x]].seatingType[""+m]=y)}ASSERT(u,m,h,f,g,b)&&k.push({airlineName:p,airlineCode:u,flightNumber:m,departureTime:h,departureCode:f,arrivalTime:g,arrivalCode:b,reservationId:o,passengers:j,reservationStatus:C}),d=p=u=m=v=h=f=g=b=y=s=o=C=null}for(var N,E=[],S=0;k.length>S;S++){N=k[S];for(var R=Object.keys(N.passengers),A=0;R.length>A;A++){var P=N.passengers[R[A]],F={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:N.airlineName,airlineCode:N.airlineCode,flightNumber:N.flightNumber,departureAirportFuzzy:N.departureAirport,departureAirportCode:N.departureCode,departureTime:N.departureTime,arrivalAirportFuzzy:N.arrivalAirport,arrivalAirportCode:N.arrivalCode,arrivalTime:N.arrivalTime},underName:{"@type":"http://schema.org/Person",name:P.name},checkinUrl:N.checkinUrl,reservationId:N.reservationId,reservationStatus:"http://schema.org/Reservation"+(N.reservationStatus||"Confirmed"),totalPrice:P.price,priceCurrency:P.currency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:P.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:P.seats[N.flightNumber],seatingType:P.seatingType[N.flightNumber]}}};valid(P.membershipNumber,P.programName)&&(F.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:P.membershipNumber,programName:P.programName}),E.push(F)}}if(E.length)return E}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1069","SG6be94b68"),new ReverseTemplate("expediamail.com-car-cancellation-en",function(e){return/^Expedia Car Booking Cancelled/.test(e.subject)},function(e){if(/^Expedia Car Booking Cancelled/.test(e.subject)){var t="en_US",r={};r.total="Total Price",r.reserved="Reserved for",r.pickUp="Pick up",r.dropOff="Drop off",r.cancelled=/Expedia Car Booking Cancelled/;var a=loadHelper("expediamail.com-car-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1070","SGcfafbf82"),new ReverseTemplate("expediamail.com-car-cancellation-es_MX",function(e){return/(?:Itinerario - Renta de autos|Se cancel\xf3 la reservaci\xf3n de auto de Expedia)/.test(e.subject)},function(e){if(/(?:Itinerario - Renta de autos|Se cancel\xf3 la reservaci\xf3n de auto de Expedia)/.test(e.subject)){var t="es_MX",r={};r.total="Precio total",r.reserved="Reservado para",r.pickUp="Entrega",r.dropOff="Devoluci\xf3n",r.reservationId="Itinerario #",r.cancelled=/(?:Tu reserva se ha cancelado por completo|Se ha cancelado la reserva de coche|Esta reservaci\xf3n fue cancelada por completo)/;var a=loadHelper("expediamail.com-car-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1072","SG1676c11b"),new ReverseTemplate("expediamail.com-car-cancellation-nl",function(e){return/^Expedia-autoreservering geannuleerd/.test(e.subject)},function(e){if(/^Expedia-autoreservering geannuleerd/.test(e.subject)){var t="nl_NL",r={};r.total="Totaalprijs",r.reserved="Geboekt voor",r.pickUp="Ophalen",r.dropOff="Inleveren",r.cancelled=/^Expedia-autoreservering geannuleerd/;var a=loadHelper("expediamail.com-car-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1075","SGa8829a12"),new ReverseTemplate("expediamail.com-car-confirmation-nl",function(e){return/^Reisbevestiging van Expedia/.test(e.subject)},function(e){if(/^Reisbevestiging van Expedia/.test(e.subject)&&/Autoverhuur/.test(e.plain)){var t="nl_NL",r={};r.total="Totaalprijs",r.reserved="Geboekt voor",r.pickUp="Ophalen",r.dropOff="Afleveren",r.reservationId="Reisplan #",r.cancelled=/Expedia Car Booking Cancelled/;var a=loadHelper("expediamail.com-car-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1081","SG33d9e30f"),new ReverseTemplate("expediamail.com-flight-cancellation-en",function(e){return/^Your flight itinerary .*? cancell?ed$/.test(e.subject)||/\(Itin(?:erary)?# \d+\)$/.test(e.subject)},function(e){var t,r="en_US",a={};return/This reservation has been fully cancell?ed/.test(e.plain)?(a.travellers=/Travell?er Information/,a.priceSummary="Price Summary",a.totalPrice="Total:",a.priceCurrency="All prices quoted in",a.reservationId="Itinerary #",a.cancelled=/This reservation has been fully cancell?ed/,a.noProgramName="No frequent flyer details provided",a.ticketNumber="Ticket #",a.totalTravelTime="Total travel time",a.seat="Seat",(t=loadHelper("expediamail.com-flight-itinerary-skeleton.js"))(e,r,a)):/^Your flight itinerary .*? cancell?ed$/.test(e.subject)?(a.itineraryLabel="Revised Itinerary",a.confirmationLabel="Airline confirmation code",a.passenger="Traveler(s)",a.traveler="Traveler",a.ticketNo="Airline Ticket No.",a.reservationId="Expedia Itinerary No.",a.cancelled=/Per your request, your flight is canceled/,a.cancelledLabel="CANCELED",(t=loadHelper("expediamail.com-flight-alternative-skeleton.js"))(e,r,a)):void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1082","SG76e58ba2"),new ReverseTemplate("expediamail.com-flight-itinerary-en",function(e){return/\(?Itin(?:erary)?(?:\s*)?#(?:\s*)?\d+\)?$/.test(e.subject)||/^Expedia\s+travel\s+confirmation/.test(e.subject)},function(e){if(/(?:Travell?er Information|Traveler\(s\))/i.test(e.plain)&&/Airline Rules (?:& Regulations|\+ restrictions)/i.test(e.plain)){var t,r="en_US",a={};return/Thanks!/.test(e.plain)?(a.date=/(Departure|Return)/,a.cabin=/(Cabin:)/,a.passengers=/Traveler\(s\)/,a.passengerEnd="Special requests",a.reservationId="Itinerary #",t=loadHelper("expediamail.com-flight-itinerary-skeleton-2.js")):(a.travellers=/Travell?er Information/,a.priceSummary="Price Summary",a.priceCurrency="All prices quoted in",a.totalPrice="Total:",a.reservationId="Itinerary #",a.cancelled=/This reservation has been fully cancell?ed/,a.noProgramName="No frequent flyer details provided",a.ticketNumber="Ticket #",a.totalTravelTime="Total travel time",a.seat="Seat",t=loadHelper("expediamail.com-flight-itinerary-skeleton.js")),t(e,r,a)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1084","SGbc43224e"),new ReverseTemplate("expediamail.com-flight-itinerary-es_MX",function(e){return/^Itinerario/.test(e.subject)||/(?:\(No\.\s+de\s+itin\.:\s+|\(Itin(?:erario)?#)/.test(e.subject)},function(e){if((/Itinerario/.test(e.subject)||/(?:\(No\.\s+de\s+itin\.:\s+|\(Itin(?:erario)?#)/.test(e.subject))&&/Informaci\xf3n del pasajero/.test(e.plain)){var t="es_MX",r={};r.travellers=/Informaci\xf3n del pasajero/,r.priceSummary="Resumen de precios",r.totalPrice="Total:",r.priceCurrency="Todos los precios se muestran en",r.reservationId="Itinerario #",r.cancelled=/Se ha cancelado por completo esta reserva/,r.noProgramName="No se proporcion\xf3 la informaci\xf3n de viajero frecuente",r.ticketNumber="No. de boleto ",r.totalTravelTime="Tiempo total de viaje",r.seat="Seat";var a=loadHelper("expediamail.com-flight-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1086","SG10b07ee6"),new ReverseTemplate("expediamail.com-flight-itinerary-it",function(e){return/\(Itin(?:erario)?#\s+\d+\)$/.test(e.subject)||/^Itinerario/.test(e.subject)},function(e){if(/Informazioni sul viaggiatore/.test(e.plain)&&/Regolamenti della compagnia aerea/.test(e.plain)){var t={};t.travellers="Informazioni sul viaggiatore",t.priceSummary="Riepilogo prezzi",t.totalPrice="Totale:",t.priceCurrency="Prezzi calcolati in",t.reservationId="Itinerario #",t.cancelled=/La prenotazione \xe8 stata cancellata/,t.noProgramName="Dettagli Frequent Flyer non forniti",t.ticketNumber="N\xb0 biglietto",t.totalTravelTime="Durata totale del viaggio",t.seat="Posto a sedere";var r="it_IT",a=loadHelper("expediamail.com-flight-itinerary-skeleton.js");return a(e,r,t)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1088","SG9dc91859"),new ReverseTemplate("expediamail.com-flight-itinerary-nl",function(e){return/^Reisbevestiging van Expedia/.test(e.subject)||/Reisplan#/.test(e.subject)},function(e){if((/^Reisbevestiging van Expedia/.test(e.subject)||/Reisplan#/.test(e.subject))&&/Extra vluchtservices/.test(e.plain)){var t="nl_NL",r={};r.travellers=/Reizigersinformatie/,r.priceSummary="Prijsoverzicht",r.totalPrice="Totaal:",r.priceCurrency="Alle prijzen vermeld in",r.reservationId="Reisplan #",r.cancelled=/Deze boeking is volledig geannuleerd/,r.pending=/Je ticket is nog niet bevestigd/,r.noProgramName="Geen Frequent Flyer-informatie gegeven",r.ticketNumber="Ticketnummer ",r.totalTravelTime="Totale reistijd",r.seat="Seat";var a=loadHelper("expediamail.com-flight-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1090","SG57ee2310"),new ReverseTemplate("expediamail.com-hotel-cancellation-en",function(e){return/^Expedia Hotel Cancellation Confirmation/.test(e.subject)||/\(Itin(?:erary)?#\s+\d+\)$/},function(e){if(/^Expedia Hotel Cancellation Confirmation/.test(e.subject)||/View hotel/.test(e.plain)&&/CANCELLED/.test(e.plain)){var t,r="en_US",a={};return/^Expedia Hotel Cancellation Confirmation/.test(e.subject)?(a.reservationId="Expedia Itinerary number:",a.name="Reserved for",t=loadHelper("expediamail.com-hotel-cancellation-skeleton.js")):(a.reservationId="Itinerary #",a.reservedFor="Reserved for",a.totalPrice="Total",a.hotelDetails="View hotel details <",a.telephone="Tel:",a.checkin="Checking in",a.checkinTime="Check-in time starts",a.priceSummary="Price Summary",a.priceCurrency="All prices quoted in",a.cancelled=/CANCELLED/,t=loadHelper("expediamail.com-hotel-itinerary-skeleton.js")),t(e,r,a)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1091","SG6a201eaf"),new ReverseTemplate("expediamail.com-hotel-cancellation-it",function(e){return/^Expedia\s+(?:-\s+)?Conferma\s+cancellazione\s+hotel/.test(e.subject)},function(e){if(/^Expedia\s+(?:-\s+)?Conferma\s+cancellazione\s+hotel/.test(e.subject)){var t="it_IT",r={};r.reservationId="Numero itinerario Expedia:",r.name="Prenotata per";var a=loadHelper("expediamail.com-hotel-cancellation-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1095","SG68ad5e48"),new ReverseTemplate("expediamail.com-hotel-cancellation-nl",function(e){return/^Expedia\s+(?:-\s+)?Annuleringsbevestiging\s+hotel/.test(e.subject)},function(e){if(/^Expedia\s+(?:-\s+)?Annuleringsbevestiging\s+hotel/.test(e.subject)){var t="nl_NL",r={};r.reservationId="Expedia-reisplannummer:",r.name="Geboekt voor";var a=loadHelper("expediamail.com-hotel-cancellation-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1096","SGd6b17598"),new ReverseTemplate("expediamail.com-hotel-itinerary-en",function(e){return/^Expedia Itinerary #:/.test(e.subject)||/^Expedia travel confirmation/.test(e.subject)||/\(Itin(?:erary)?\s?#/.test(e.subject)},function(e){if(/View hotel/.test(e.plain)){var t,r={},a="en_US";return r.reservationId="Itinerary #",r.reservedFor="Reserved for",r.totalPrice="Total",/Thanks!/.test(e.plain)?(r.hotelDetails="Hotel overview",r.reservationDetails="Reservation dates",r.checkInTime="Check-in time",r.checkOutTime="Check-out time",r.hotelUrl="View hotel",t=loadHelper("expediamail.com-hotel-itinerary-skeleton-alternative.js")):(r.hotelDetails="View hotel details <",r.telephone="Tel:",r.checkin=/(?:Checking in|Check-in)/,r.checkinTime="Check-in time starts",r.priceSummary="Price Summary",r.priceCurrency="All prices quoted in",r.cancelled=/CANCELLED/,t=loadHelper("expediamail.com-hotel-itinerary-skeleton.js")),t(e,a,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1098","SG3115dc7f"),new ReverseTemplate("expediamail.com-hotel-itinerary-es_MX",function(e){return/^Confirmaci\xf3n de viaje de Expedia/.test(e.subject)||/\(Itinerario\s?#/.test(e.subject)},function(e){if((/^Confirmaci\xf3n de viaje de Expedia/.test(e.subject)||/\(Itinerario\s?#/.test(e.subject))&&/Ver los detalles del hotel/.test(e.plain)){var t="es_MX",r={};r.reservationId=/(?:No\. de itinerario|Itinerario #)/,r.reservedFor="Reservado para",r.totalPrice="Total",r.hotelDetails="Ver los detalles del hotel <",r.telephone="Tel:",r.checkin=/(?:Checking in|Check-in)/,r.checkinTime="El check-in comienza",r.priceSummary="Resumen de precios",r.priceCurrency="Todos los precios se muestran en",r.cancelled=/Se han cancelado todas las habitaciones/;var a=loadHelper("expediamail.com-hotel-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1100","SGaa90b076"),new ReverseTemplate("expediamail.com-hotel-itinerary-it",function(e){return/Itin#/.test(e.subject)||/^Itinerario aggiornato/.test(e.subject)},function(e){if((/Itin#/.test(e.subject)||/^Itinerario aggiornato/.test(e.subject))&&/Servizi aggiuntivi hotel/.test(e.plain)){var t="it_IT",r={};r.reservedFor="Prenotata per",r.reservationId=/(?:Numero di itinerario|Itinerario #)/,r.hotelDetails="Mostra dettagli hotel <",r.telephone="Tel:",r.checkin="Arrivo",r.checkinTime="Check-in dalle ore",r.priceSummary="Riepilogo prezzi",r.totalPrice="Totale",r.priceCurrency="Prezzi calcolati in",r.cancelled=/CANCELLED/;var a=loadHelper("expediamail.com-hotel-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1102","SG8f07d1ab"),new ReverseTemplate("expediamail.com-hotel-itinerary-nl",function(e){return/^Bijgewerkt reisplan/.test(e.subject)||/^Reisbevestiging van Expedia/.test(e.subject)},function(e){if((/^Bijgewerkt reisplan/.test(e.subject)||/^Reisbevestiging van Expedia/.test(e.subject))&&/Extra hoteldiensten/.test(e.plain)){var t="nl_NL",r={};r.reservedFor="Geboekt voor",r.reservationId=/(?:Reisplan #|Reisplannummer)/,r.hotelDetails="Hotelinformatie weergeven <",r.telephone="Tel:",r.checkin="Inchecken",r.checkinTime=/(?:Check-in|Inchecken) vanaf/,r.priceSummary="Prijsoverzicht",r.totalPrice="Totaal",r.priceCurrency="Alle prijzen vermeld in",r.cancelled=/CANCELLED/;var a=loadHelper("expediamail.com-hotel-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1103","SGa009ca1e"),new ReverseTemplate("expediamail.com-travel-itinerary-en",function(e){return/^Your Trip Details/.test(e.subject)||/^Final Details For Your Trip/.test(e.subject)},function(e){if(/^Your Trip Details/.test(e.subject)||/^Final Details For Your Trip/.test(e.subject)){var t={flight:{},car:{},hotel:{}};t.emailHeader=["My Itineraries","My Account","Customer Support","Feedback"],t.mainContact="Main contact:",t.emailAddress="Email address:",t.confirmationCode="Confirmation Code:",t.flight.verify="Airline rules and regulations",t.flight.travelers=/Travell?er's name\(s\):/,t.flight.checkinUrl=/Online(?: Flight)? Check-in/,t.flight.details="Flight Details",t.flight.depart="Depart",t.flight.arrive="Arrive",t.flight.flightNumber="Flight Number:",t.flight.seatUnassigned="Seat Unassigned",t.car.verify="Car rules and regulations",t.car.pickup="Pick-up",t.car.dropoff="Drop-off",t.car.address="Address:",t.car.modify="Change/ Cancel <",t.hotel.verify="Hotel rules and regulations",t.hotel.checkin="Check-in",t.hotel.checkout="Check-out",t.hotel.modify="Change/Cancel",t.hotel.address="Address:",t.hotel.telephone="Telephone:";var r="en_US",a=loadHelper("expediamail.com-travel-itinerary-skeleton.js");return a(e,r,t)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1014/1068/1114","SG5268ee0b")]);
