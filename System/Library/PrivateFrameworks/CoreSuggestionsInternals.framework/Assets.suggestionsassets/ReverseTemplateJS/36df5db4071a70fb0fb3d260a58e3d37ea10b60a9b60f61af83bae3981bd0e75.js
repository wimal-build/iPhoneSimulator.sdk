// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("jetblue.com-itinerary-checkin-2013",function(e){return int(e.epoch)>1412914336?!1:/^Itinerary for your upcoming trip$/.test(e.subject)||/^Check in for your flight to/.test(e.subject)},function(e){if(/^Itinerary for your upcoming trip/.test(e.subject)||/^Check in for your flight to/.test(e.subject)){var r=Scanner.fromMessage(e);if(r.setLocale("en_US"),r.getSpan().nextRegExp(/Your ticket(?:\(s\) is\/| numbers )?are:/).exists()){var t,a,i,n,o,s,u,l,p,m,c,g,h,d,b=[],f={};t=r.getSpan().innerCapture(/\bYour confirmation number is (\w+)[.\s]/,1),a=r.getSpan().nextText("Skip the line, check in now!").nextTag("td2").innerLink(),not(a)&&(a=r.getSpan().nextText("Your confirmation number is").nextTag("table3").allInnerLinks(),a=5==a.length?a[1]:null),o=r.getSpan().nextRegExp(/Your ticket(?:\(s\) is\/| numbers )?are:/).nextTag("table3").allInnerTagsFiltered("td3");for(var v=0;o.length>v;v++){i=o[v].innerCapture(/($<name>.*): ($<ticketNumber>\w+)/),n=i?i.$name:null;var y=i?i.$ticketNumber:null;valid(n)&&(f[""+n]={name:n,ticketNumber:y,seats:{},seatingType:{}})}u=r.getSpan().nextText("Your itinerary").nextAnyTag("table"),tagNum=u.getTagNumber(),u=u.allInnerTags("tr"+tagNum).map(function(e){return e.allInnerTags("td"+tagNum).map(function(e){return e.innerTag("td"+(int(tagNum)+1)).exists()?e.allInnerTagsFiltered("td"+(int(tagNum)+1)):e.tagContents()})}).filter(function(e){return e.length>=6});for(var T=0;u.length>T;T++){i=[];for(var N=0;u[T].length>N;N++)u[T][N]instanceof Array?i=i.concat(u[T][N]):i.push(u[T][N]);u[T]=i}for(var T=0;u.length>T;T++)if(u[T][0].innerDate().exists()){s=u[T],p=combineDateAndTime(s[0].innerDate(),s[1].innerDate()),g=combineDateAndTime(s[0].lastInnerDate(),s[1].lastInnerDate()),i=s[2].innerCapture(/^($<departureAirport>.*?)(?:\s+\(($<departureCode>[A-Z]{3})\))?\s+to\s+($<arrivalAirport>.*?)(?:\s+\(($<arrivalCode>[A-Z]{3})\))?$/),m=i?i.$departureAirport:null,c=i?i.$departureCode:null,h=i?i.$arrivalAirport:null,d=i?i.$arrivalCode:null,l=s[3],n=s[4];var k=""+s[5]=="N/A"?"":s[5],C=/Select seat/.test(""+s[6])?"":s[6];valid(n,l)&&(valid(k)&&(f[""+n].membershipNumber=k,f[""+n].programName="Frequent Flyer"),valid(C)&&(f[""+n].seats[""+l]=C)),ASSERT(l,p,m,g,h)&&b.push({airlineName:"JetBlue",airlineCode:"B6",flightNumber:l,departureTime:p,departureCode:c,departureAirport:m,arrivalTime:g,arrivalCode:d,arrivalAirport:h,passengers:f})}for(var A=[],T=0;b.length>T;T++)for(var x=b[T],S=Object.keys(x.passengers),N=0;S.length>N;N++){var j=x.passengers[S[N]],$={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode,flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:j.name},checkinUrl:a,reservationId:t,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:j.totalPrice,priceCurrency:j.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:j.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:j.seats[x.flightNumber],seatingType:j.seatingType[x.flightNumber]}}};valid(j.membershipNumber,j.programName)&&($.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:j.membershipNumber,programName:j.programName}),A.push($)}if(A.length)return A}}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/185/358/360","SG4bb0ac88"),new ReverseTemplate("jetblue.com-itinerary-checkin-2014",function(e){return/^(?:Your\s)?Itinerary for your upcoming trip$/i.test(e.subject)||/^Check in for your flight to/.test(e.subject)},function(e){if(/^(?:Your\s)?Itinerary for your upcoming trip$/i.test(e.subject)||/^Check in for your flight to/.test(e.subject)){var r,t="en_US",a={};return/^Your/.test(e.subject)?(a.terminal="TERMINAL",a.to="to",a.select_seat=/select seat/,a.total=/TOTAL/,a.reservationId=/Your confirmation code is\s+(.*)\s+</,r=loadHelper("jetblue-itinerary-skeleton-2015.js")):r=loadHelper("jetblue-itinerary-skeleton-2014.js"),r(e,a,t)}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/185/358/361","SG9042978f")]);