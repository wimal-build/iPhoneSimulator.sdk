// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,p,g,s,o,c,l,x,d,u,C,m,h,S,T,f,v,R,b,y,D,E;if(n.confirm.test(e.subject)||n.street.test(e.plain)){p=a.getSpan().innerCapture(n.reservationId,1),r=(""+a.getSpan().innerCapture(n.guestName,1)).trim();var k=a.getSpan().nextRegExp(n.bookingDetails).nextTag("table4").tagContents();y=k.innerDate(),b=k.innerPhoneNumber(),n.street.test(e.plain)&&(D=a.getSpan().nextRegExp(n.pickupDetails).nextRegExp(n.street).nextTag("td5").tagContents().trim(),D=D.split(/\//).join(" "),E=a.getSpan().nextRegExp(n.pickupDetails).nextRegExp(n.city).nextTag("td5").tagContents().trim(),R=a.getDetachedSpan(D+" "+E).innerAddress(),R.exists()||(R=D+" "+E)),R&&0!==(""+R).length||(R=k.innerAddress()),R&&0!==(""+R).length||(k=""+k,k=k.substr(0,k.indexOf(""+b)),k=k.split("\n"),k=""+k.slice(2).join("\n"),R=k);var P=a.getSpan().nextRegExp(n.bookingDetails).nextTag("table4").nextTag("table4").tagContents();f=P.innerDate(),T=P.innerPhoneNumber(),n.street.test(e.plain)&&(D=a.getSpan().nextRegExp(n.dropoffDetails).nextRegExp(n.street).nextTag("td5").tagContents().trim(),D=D.split(/\//).join(" "),E=a.getSpan().nextRegExp(n.dropoffDetails).nextRegExp(n.city).nextTag("td5").tagContents().trim(),S=a.getDetachedSpan(D+" "+E).innerAddress(),S.exists()||(S=D+" "+E)),S&&0!==(""+S).length||(S=P.innerAddress()),S&&0!==(""+S).length||(P=""+P,P=P.substr(0,P.indexOf(""+T)),P=P.split("\n"),P=""+P.slice(2).join("\n"),S=P),d=a.getSpan().nextText(n.car).nextTag("table4").nextTag("td4").nextTag("td4").nextTag("td4").nextTag("td4").tagContents(),0===(""+d).length&&(d=a.getSpan().nextText(n.car).nextTag("table5").nextTag("td5").tagContents().trim()),l=a.getSpan().nextText(n.totalPrice).nextTag("td5").tagContents().innerCapture(/([\d,.]+)/,1),x=a.getSpan().nextText(n.totalPrice).nextTag("td5").tagContents().innerCapture(/([^\d,.]+)/,1),l.exists()||(l=a.getSpan().nextText(n.totalPrice).nextTag("td4").tagContents().innerCapture(/([\d,.]+)/,1),x=a.getSpan().nextText(n.totalPrice).nextTag("td4").tagContents().innerCapture(/([^\d,.]+)/,1)),c=o=a.getSpan().nextText(n.modifyUrl).parentTag("td3").innerLink(),g=a.getSpan().next(n.cancelled).exists()?"Cancelled":"Confirmed"}else{if(!n.cancel.test(e.subject))return CONTINUE;p=a.getSpan().innerCapture(n.cancellationId,1),r=a.getSpan().innerCapture(n.guestNameCancel,1),i=a.getSpan().innerCapture(n.guestEmailCancel,1);var k=""+a.getSpan().innerCapture(n.pickUp,1);k=k.split("\n"),y=""+k[0],R=k[1]+"\n"+k[2],b=""+k[3];var m=""+a.getSpan().innerCapture(n.pickUp,1);m=m.split("\n"),y=getFuzzyDate(a.getDetachedSpan(""+m[0])),R=m[1]+"\n"+m[2],b=""+m[3];var m=""+a.getSpan().innerCapture(n.dropOff,1);m=m.split("\n"),f=getFuzzyDate(a.getDetachedSpan(""+m[0])),S=m[1]+"\n"+m[2],T=""+m[3],d=a.getSpan().innerCapture(n.carCancel,1);var N=a.getSpan().innerCapture(n.priceCancel,1);l=N.innerCapture(/([\d,.]+)/,1),x=N.innerCapture(/([^\d,.]+)/,1),g="Cancelled"}return ASSERT(p,r,d,R,y)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:l,priceCurrency:x,reservationId:p,reservationStatus:"http://schema.org/Reservation"+(g||"Confirmed"),checkinUrl:s,modifyReservationUrl:o,cancelReservationUrl:c,underName:{"@type":"http://schema.org/Person",name:r,email:i},provider:{"@type":"http://schema.org/Organization",name:"Budget"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:d},license:u,color:C},pickupTime:y,pickupLocation:{"@type":"http://schema.org/Place",name:v,telephone:b,address:R},dropoffTime:f,dropoffLocation:{"@type":"http://schema.org/Place",name:h,telephone:T,address:S}}]:void 0}}).call();
