// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r){var n=Scanner.fromMessage(e);n.setLocale("en_US");for(var t=n.getSpan(),o=[],a=[],p=[],i=e.plain.split(/Pick-Up/i).length-1,c=(e.plain.slice(),0);i>c;c++)t=t.next(/(^Car Rental[\s\S]*?)(?:^Flight [A-Z]|^Hotel$|^Car Rental$|^Plan)/gm),p.push(""+t);return p.forEach(function(e,t){var o,p,i,c,s,d,l,h,m,f,u,g,v,k,y,T,U,R,C="Confirmed",N=n.getDetachedSpan(e),x=e.slice(),e=e.split("\n");U=/Company.*\n.*\n(.*)\n/.exec(x),U&&2===U.length&&(U=U[1]),s=/Pick-Up At.*\n.*\n(.*)\n/.exec(x),s&&2===s.length&&(s=U+", "+s[1]),m=s,p=N.nextDate(),d=N.nextDate().nextDate(),o=/Confirmation #.*\n.*\n(.*)\n/.exec(x),o&&2===o.length&&(o=o[1]),R=/Vehicle Type.*\n.*\n(.*)\n/.exec(x),R&&2===R.length&&(R=R[1]),f=/Rate.*\n.*\n([\d,.]+)\s*([A-Z]{2,3})/.exec(x),f&&3===f.length&&(u=f[1],g=f[2]),a.push({reservationId:o,pickupTime:p,pickupName:i,pickupTelephone:c,pickupAddress:s,dropoffTime:d,dropoffName:l,dropoffTelephone:h,dropoffAddress:m,totalPrice:u,priceCurrency:g,reservationStatus:C,checkinUrl:v,modifyReservationUrl:k,cancelReservationUrl:y,underName:T,brand:R,provider:U,underPersonName:r.underName})}),a.forEach(function(e,r){ASSERT(e.pickupTime,e.pickupAddress,e.dropoffTime,e.dropoffAddress),o.push({"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",reservationId:e.reservationId,totalPrice:e.totalPrice,priceCurrency:e.priceCurrency,reservationStatus:"http://schema.org/"+e.reservationStatus,checkinUrl:e.checkinUrl,modifyReservationUrl:e.modifyReservationUrl,cancelReservationUrl:e.cancelReservationUrl,underName:{"@type":"http://schema.org/Person",name:e.underName},provider:{"@type":"http://schema.org/Organization",name:e.provider},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:e.brand},license:"",color:""},pickupTime:e.pickupTime,pickupLocation:{"@type":"http://schema.org/Place",name:e.pickupName,telephone:e.pickupTelephone,address:e.pickupAddress},dropoffTime:e.dropoffTime,dropoffLocation:{"@type":"http://schema.org/Place",name:e.dropoffName,telephone:e.dropoffTelephone,address:e.dropoffAddress}})}),o.length>=1?o:CONTINUE}}).call();
