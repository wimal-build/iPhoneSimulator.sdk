// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,g,s,p,x,c,m,l,u,d,C,h;if(!n.emailTitelConfirmation.test(e.subject))return CONTINUE;s=a.getSpan().nextRegExp(n.reservationId).tagContents().innerCapture(n.reservationId,1),r=a.getSpan().nextRegExp(n.guestName).nextAnyTag("td").tagContents(),x=a.getSpan().nextRegExp(n.checkInDate).nextAnyTag("td").tagContents().innerDate(),c=a.getSpan().nextRegExp(n.checkOutDate).nextAnyTag("td").tagContents().innerDate();var T=a.getSpan().nextRegExp(n.price).nextAnyTag("td").tagContents();o=T.innerCapture(/([\d,.]+)/,1),g=T.innerCapture(/([^\d,.]+)/,1).trim();var E=a.getSpan().nextRegExp(n.hotelInfo).nextAnyTag("table").nextAnyTag("td").nextAnyTag("td").tagContents();if(l=E.innerCapture(regExpFormatted(/(.+)\s</),1),0===(""+l).length&&(l=a.getSpan().nextRegExp(n.checkOutDate).nextTag("table8").nextAnyTag("td").tagContents().innerCapture(regExpFormatted(/(.+)</),1),l=a.getSpan().innerCapture(n.hotelName,1).trim()),m=E.nextLink(),u=E.lastInnerPhoneNumber(),d=n.hotelPhone.test(""+E)?E.innerCapture(regExpFormatted(/.+\n([\s\S]*)\1/,n.hotelPhone),1).trim():E.innerCapture(regExpFormatted(/.+\n([\s\S]*)/),1).trim(),C=a.getSpan().nextRegExp(n.modifyUrl).nextLink(),h=a.getSpan().nextRegExp(n.cancelUrl).nextLink(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(r,s,x,c,l))return CONTINUE;p="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(!ASSERT(r,s,x,c,d))return CONTINUE;p="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:o,priceCurrency:g,checkinTime:x,checkoutTime:c,modifyReservationUrl:C,cancelReservationUrl:h,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:l,url:m,telephone:u,address:d}}]}}).call();