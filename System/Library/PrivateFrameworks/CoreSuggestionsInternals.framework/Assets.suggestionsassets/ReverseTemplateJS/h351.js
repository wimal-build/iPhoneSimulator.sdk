// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var r=Scanner.fromMessage(e);r.setLocale(t);var a,i,o,s,c,p,u,g,l,m,C,d,h,f;if(!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;c=r.getSpan().innerCapture(n.reservationId,1),a=r.getSpan().innerCapture(n.guestName,2),u=r.getSpan().nextRegExp(n.checkInDate).nextDate(),g=r.getSpan().nextRegExp(n.checkOutDate).nextDate();var S=r.getSpan().innerCapture(n.price,1);if(o=S.innerCapture(/([\d,.]+)/,1),s=S.innerCapture(/([^\d,.]+)/,1).trim(),m=r.getSpan().innerCapture(n.guestName,1),d=r.getSpan().nextRegExp(n.hotelAddress).parentAnyTag("td").tagContents().innerCapture(n.hotelAddressRegexCapture,1),f=r.getSpan().nextRegExp(n.cancelUrl).nextLink(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(a,c,u,g,d))return CONTINUE;p="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(c=r.getSpan().innerCapture(n.cancelReservationId,1),!ASSERT(a,c,u,g,m))return CONTINUE;p="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:i},totalPrice:o,priceCurrency:s,checkinTime:u,checkoutTime:g,modifyReservationUrl:h,cancelReservationUrl:f,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:c,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:l,telephone:C,address:d}}]}}).call();
