// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,g,o,p,s,c,x,u,C,d,m,h,l,T,S,E,R;if(!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;p=a.getSpan().nextRegExp(regExpFormatted(n.reservationId)).tagContents().innerCapture(regExpFormatted(n.reservationId),1),R=E=a.getSpan().nextRegExp(n.reservationId).nextLink(),r=a.getSpan().nextRegExp(n.guest).nextAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/(.+)/,1),i=a.getSpan().nextRegExp(n.guest).nextAnyTag("td").nextAnyTag("td").tagContents().nextLink(),x=a.getSpan().nextRegExp(n.checkInDate).tagContents().innerCapture(n.checkInDate,1),d=a.getSpan().nextRegExp(n.checkOutDate).tagContents().innerCapture(n.checkOutDate,1),c=a.getSpan().nextRegExp(n.checkInTime).tagContents().innerCapture(n.checkInTime,1),C=a.getSpan().nextRegExp(n.checkOutTime).tagContents().innerCapture(n.checkOutTime,1),u=getFuzzyDate(a.getDetachedSpan(x+" "+c).innerDate()),m=getFuzzyDate(a.getDetachedSpan(d+" "+C).innerDate());var y=a.getSpan().nextRegExp(n.price).nextAnyTag("td").tagContents();if(g=y.innerCapture(/([\d,.]+)/,1),o=y.innerCapture(/([^\d,.]+)/,1).trim(),l=a.getSpan().nextRegExp(n.hotel).nextAnyTag("td").tagContents().innerCapture(/(.+)/,1),S=a.getSpan().nextRegExp(n.hotel).parentAnyTag("td").tagContents().innerAddress(),T=a.getSpan().nextRegExp(n.hotel).parentAnyTag("td").tagContents().innerPhoneNumber(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(r,p,u,m,S))return CONTINUE;s="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(l=a.getSpan().nextRegExp(n.hotel).nextAnyTag("td").nextAnyTag("td").tagContents().innerCapture(/(.+)/,1),!ASSERT(r,p,u,m,S))return CONTINUE;s="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:g,priceCurrency:o,checkinTime:u,checkoutTime:m,modifyReservationUrl:E,cancelReservationUrl:R,reservationStatus:"http://schema.org/Reservation"+(s||"Confirmed"),reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:l,url:h,telephone:T,address:S}}]}}).call();
