// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){function r(e){return e=e.replace(/[^\d\sa-zA-z:]+/g," ").replace(/\s+/g," ").replace(/^(\d+)\s(\d+)\s/,"$1/$2/"),e=getFuzzyDate(a.getDetachedSpan(e))}var a=Scanner.fromMessage(e);a.setLocale(t);var i,c,o,s,p,u,l,m,g,C,h,d,S,f,T,v,N,I;if(!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;p=a.getSpan().innerCapture(n.reservationId,1),i=a.getSpan().innerCapture(n.guestName,1);var k=a.getSpan().innerCapture(n.price,1);if(o=k.innerCapture(/([\d,.]+)/,1),s=k.innerCapture(/([^\d,.]+)/,1),m=""+a.getSpan().innerCapture(n.checkInDate,1),l=""+a.getSpan().innerCapture(n.checkInTime,1),g=m+" "+l,g=r(g),h=""+a.getSpan().innerCapture(n.checkOutDate,1),C=""+a.getSpan().innerCapture(n.checkOutTime,1),d=h+" "+C,d=r(d),f=a.getSpan().innerCapture(n.hotelName,1),T=a.getSpan().innerCapture(n.hotelPhone,1),v=a.getSpan().innerCapture(n.hotelAddress,1),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(i,p,g,f))return CONTINUE;u="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){if(!ASSERT(i,p,g,f))return CONTINUE;u="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:i,email:c},totalPrice:o,priceCurrency:s,checkinTime:g,checkoutTime:d,modifyReservationUrl:N,cancelReservationUrl:I,reservationStatus:"http://schema.org/Reservation"+(u||"Confirmed"),reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:f,url:S,telephone:T,address:v}}]}}).call();
