// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,o,i,g,s,p,c,x,l,d,u,m,T,h,C,S,v,$,y,b,k;if(1===n.version)b=a.getSpan().nextRegExp(regExpFormatted(/\1/,n.manageUrl)).parentAnyTag("td").innerLink(),C=a.getSpan().nextText(n.hotelContactDetails).parentTag("table5").innerCapture(regExpFormatted(/>\s+($<name>.*?) <($<url>.*?)>(?:[\s\S]+)\s\1\s($<address>[\s\S]+?)\s($<phone>[\d+]+)\s\s/,n.hotelContactDetails)),C&&(v=C.$name.trim(),S=C.$url,y=C.$address.innerAddress(),y.exists()||(y=C.$address),$=C.$phone.trim()),r=a.getSpan().nextText(n.occupancy).parentTag("td5").nextTag("td5").tagContents().innerCapture(/(.+)([,]|[\uff0c]|[\u3001]).+/,1),o=a.getSpan().lastInnerText(n.email).parentTag("table4").lastInnerTag("td4").tagContents().innerCapture(/(.+)\,.+/,1),p=a.getSpan().innerCapture(n.occupancyConfirmationNumber,1),l=a.getSpan().nextRegExp(n.checkInTime).parentTag("table7").tagContents().innerCapture(n.checkInTime,1),m=a.getSpan().nextRegExp(n.checkOutTime).parentTag("table7").tagContents().innerCapture(n.checkOutTime,1),n.noon&&""+m===n.noon&&(m=a.getDetachedSpan("12:00")),d=a.getSpan().nextText(n.occupancy).nextRegExp(n.checkInDate).nextDate(),n.noon&&""+l===n.noon&&(l=a.getDetachedSpan("12:00")),T=a.getSpan().nextText(n.occupancy).nextRegExp(n.checkOutDate).nextDate(),u=combineDateAndTime(d,l),h=combineDateAndTime(T,m),g=a.getSpan().nextText(n.roomCharges).nextTag("table6").lastInnerTag("td6").tagContents().innerCapture(/([\d,.]+)/,1),s=a.getSpan().nextText(n.roomCharges).nextTag("table6").lastInnerTag("td6").tagContents().innerCapture(/([^\d,.]+)/,1).trim(),x=a.getSpan().innerCapture(regExpFormatted(/\1\s*($<latitude>[-0-9]+\.?[0-9]*),\s*($<longitude>[-0-9]+\.?[0-9]*)/,n.gps));else if(2===n.version){r=a.getSpan().innerCapture(regExpFormatted(/\1 (.*?),/,n.name),1),p=a.getSpan().innerCapture(regExpFormatted(/\1 (\d+)/,n.reservationId),1),b=a.getSpan().nextText(n.modifyReservationUrl).nextLink(),k=b,i=a.getSpan().nextText(n.reservationDetails).nextTag("table7").nextTag("table7"),v=i.nextTag("td7").tagContents().innerCapture(/(.*?) </,1),S=i.innerLink(),i=i.nextTag("table9").allInnerTagsFiltered("td9"),y=[];for(var D=0;i.length>D;D++)i[D].innerTag("td10").exists()?y.push(i[D].split("[td10]").map(function(e){return e.tagContents()}).join(" ")):i[D].innerPhoneNumber().exists()?$=i[D]:y.push(i[D]);y=y.join(" "),u=a.getSpan().nextText(n.checkIn).nextDate(),h=a.getSpan().nextText(n.checkOut).nextDate();var E=a.getSpan().nextRegExp(n.pricing).nextTag("td8").tagContents().innerCapture(/($<currency>.)($<total>[\d,.]+)/);g=E?E.$total:null,s=E?E.$currency:null}return ASSERT(u,h,y)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:o},totalPrice:g,priceCurrency:s,checkinTime:u,checkoutTime:h,modifyReservationUrl:b,cancelReservationUrl:k,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:v,url:S,telephone:$,geo:valid(x)?{"@type":"http://schema.org/GeoCoordinates",latitude:x.$latitude,longitude:x.$longitude}:null,address:y}}]:void 0}}).call();
