// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){if(!e||!t||!n)return CONTINUE;var r=Scanner.fromMessage(e);r.setLocale(t);var a,g,o,i,p,x,d,s,l,m,c,E,u,h,R,F;return o=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.bookingNumber)).parentTag("table3"),x=o.innerRegExp(regExpFormatted(/\1/,n.bookingNumber)).nextTag("td3").tagContents(),m=getFuzzyDate(o.innerRegExp(regExpFormatted(/\1/,n.checkin)).nextTag("td3")),c=getFuzzyDate(o.innerRegExp(regExpFormatted(/\1/,n.checkout)).nextTag("td3")),o=o.innerRegExp(regExpFormatted(/\1/,n.bookedBy)).nextTag("td3").tagContents().innerCapture(/($<name>.*) \(($<email>.*)\)/),a=o?o.$name:null,g=o?o.$email:null,E=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.modifyReservationUrl)).previousTag("table3"),o=E.innerTag("td3").tagContents().innerCapture(/($<hotelName>.*?) <($<hotelUrl>.*)>/),h=o?o.$hotelName:null,u=o?o.$hotelUrl:null,o=E.innerTag("table5"),F=o.innerRegExp(regExpFormatted(/\1/,n.address)).nextTag("td5").tagContents(),F.innerAddress().getLength()===F.getLength()&&(F=F.innerAddress()),d=r.getSpan().nextText("Cancelled").exists()?"http://schema.org/ReservationCancelled":"http://schema.org/ReservationConfirmed",R=o.innerRegExp(regExpFormatted(/\1/,n.phone)).nextTag("td5").tagContents(),s=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.modifyReservationUrl)).nextLink(),l=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.cancelReservationUrl)).nextLink(),i=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.totalPrice)).nextAnyTag("td").tagContents().innerCapture(/([\d,.]+)/,1),0===(""+i).length&&(i=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.totalPriceAlternative)).nextAnyTag("td").tagContents().innerCapture(/([\d,.]+)/,1),/^\d+/.test(i)||(i="")),p=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.cancellationFees)).parentAnyTag("table").innerCapture(regExpFormatted(/\* (?:(?:\b\1 )?.* \[.*\](?: ?\1)?\s?: )?([A-Z]{2,3})/,n.from),1),ASSERT(m,c,F)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:g},totalPrice:i,priceCurrency:p,checkinTime:m,checkoutTime:c,modifyReservationUrl:s,cancelReservationUrl:l,reservationStatus:d,reservationId:x,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:h,url:u,telephone:R,address:F}}]:void 0}}).call();
