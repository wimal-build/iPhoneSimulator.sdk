// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,p,g,s,l,u,h,m,c,d,f,C,T,v,x,S=[],y=[],A=[];for(o=a.getSpan().innerCapture(regExpFormatted(/\1\s*(.+)/,r.reservationId),1),p=a.getSpan().next(r.passengersPrefix).nextTag("table5").allInnerTags("tr5"),f=a.getSpan().next(r.pricePrefix).nextTag("td5").tagContents().innerCapture(regExpFormatted(/^(.+)\1/,r.priceSuffix),1),f&&f.exists()&&(C=f.innerCapture(/([\d,.]+)/,1),T=f.innerCapture(/([^\d,.]+)/,1).trim()),v=3;p.length>v;v++)x=p[v].allInnerTags("td5"),3===x.length&&(n=x[1].tagContents(),i=x[2].tagContents(),S.push({name:""+n+" "+i}));for(g=a.getSpan().next(r.flightInfoPrefix).nextTag("table5").allInnerTags("tr5"),v=3;g.length>v;v++)x=g[v].allInnerTags("td5"),5===x.length&&(s=x[0].tagContents().innerCapture(/(\w{2})(\d+)/),3===s.length&&([,l,u]=s),h=x[1].tagContents(),c=x[2].tagContents(),m=x[3].tagContents(),d=x[4].tagContents(),ASSERT(l,u,m)&&y.push({airlineCode:l,flightNumber:u,departureAirport:h,arrivalAirport:c,departureTime:m,arrivalTime:d}));return ASSERT(o)&&S.forEach(function(e){y.forEach(function(t){var r={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"TAP Portugal",airlineCode:t.airlineCode,flightNumber:t.flightNumber,departureAirportFuzzy:t.departureAirport,departureTime:t.departureTime,arrivalAirportFuzzy:t.arrivalAirport,arrivalTime:t.arrivalTime},underName:{"@type":"http://schema.org/Person",name:e.name},reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:C,priceCurrency:T,reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat"}}};A.push(r)})}),A.length?A:void 0}}).call();
