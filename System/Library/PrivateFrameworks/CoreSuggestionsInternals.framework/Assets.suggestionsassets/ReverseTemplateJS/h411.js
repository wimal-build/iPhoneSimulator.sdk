// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);for(var r,s,i,o,p,c,d,g,m,l,u,h,x,T,S,$,v,C,k=0;n.confirmations.length>k;k++)if(n.confirmations[k].test(e.subject)){v=a.getSpan().innerCapture(regExpFormatted(/\1/,n.details)),s=v?v.$name:null;break}if(n.reminder.test(e.subject)&&(l=regExpFormatted(/\1 (.*)/,n.reminder).exec(e.subject)[1],v=a.getSpan().nextText(l).parentAnyTag("td").tagContents().innerCapture(n.details)),l=v?v.$eventName:l,u=v?v.$eventUrl:null,c=a.getSpan().nextRegExp(n.ticketToken).nextLink(),p=a.getSpan().innerCapture(regExpFormatted(/\1\s+(\w+)/,n.ticketNumber),1),i=a.getSpan().nextText(n.orderSummary).nextText(n.total).nextTag("td3").tagContents().innerCapture(/([\d,.]+)/,1),v=a.getSpan().nextText(n.aboutThisEvent).nextAnyTag("table"),C=v.getTagNumber(),v=v.allInnerTagsFiltered("td"+C),v.length){if(v[0].allInnerDates().length>0){var b=v[0].innerCapture(n.dates);b||(b=v[0].innerCapture(n.datesRange)),b||(b=v[0].innerCapture(n.startDate));var f=b.$timezone;h=b.$start,x=b.$end,b.$startTime&&(h=b.$start+" "+b.$startTime,x=b.$start+" "+b.$endTime),h=a.getDetachedSpan(h+"("+f+")").innerDate(),x&&(x=a.getDetachedSpan(x+"("+f+")").innerDate())}$=v[1].innerAddress(),v=v[1].innerCapture(/^($<place>.*)\n($<address>[\s\S]+)/),v&&(S=v.$place,$&&v.$address&&v.$address.getLength()>$.getLength()&&($=v.$address))}return ASSERT(h,l)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:s,totalPrice:i,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:p,ticketToken:c,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:d,seatRow:g,seatSection:m}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/Event"+(r||"Confirmed"),name:l,url:u,startDate:h,endDate:x,location:{"@type":"http://schema.org/Place",name:S,telephone:T,address:$}}}]:void 0}}).call();