// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e){if(startsWith(e.subject,"Please complete your sale")||startsWith(e.subject,"Your StubHub sale is cancelled")||startsWith(e.subject,"Charge Applied")||startsWith(e.subject,"Tickets sold"))return CONTINUE;if(startsWith(e.subject,"Create your new StubHub password"))return CONTINUE;if(startsWith(e.subject,"Refund Applied"))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var a,s,r,n,c,i,o,u,p,h,d,l,b,g,m,S,v;s=t.getSpan().innerCapture(/\bHi (\w+),\s/,1),c=t.getSpan().innerCapture(/\bOrder #: ([\d]+)/,1),i=t.getSpan().innerCapture(/\bbelow to print your tickets\.\s+<(.*)>/,1),i.exists()||(i=t.getDetachedSpan("http://www.StubHub.com")),b=t.getSpan().nextText("Event time subject to change - Check local listings").previousDate();var C=t.getSpan().innerCapture(/\b($<eventName>.*) at ($<address>.*)\s(?:.*)\s\(Event time subject to change/);C&&(d=C.$eventName,v=C.$address);var E=RegExp("\\(Event time subject to change - Check local listings\\)\\s+\\b($<seatSection>.*) \\| ($<numSeats>.*)\\s+(?:(?:Row )?($<seatRow>.*) \\| (?:Seats? )?($<seat>.*)\\s)?"),j=t.getSpan().innerCapture(E);return j&&(h=j.$seatSection,o=j.$numSeats,p=j.$seatRow,u=j.$seat),r=t.getSpan().nextText("Order total:").nextTag("td2").tagContents().innerCapture(/([\d,.]+)/,1),a="http://schema.org/EventConfirmed",startsWith(e.subject,"Event cancelled")||startsWith(e.subject,"Account Credit Applied")?a="http://schema.org/EventCancelled":(startsWith(e.subject,"Order Placed")||startsWith(e.subject,"Your tickets have shipped"))&&(a="http://schema.org/EventConfirmed"),ASSERT(b,d)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:s,totalPrice:r,priceCurrency:n,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:c,ticketToken:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:u,seatRow:p,seatSection:h}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:a,name:d,url:l,startDate:b,endDate:g,location:{"@type":"http://schema.org/Place",name:S,telephone:m,address:v}}}]:void 0}}).call();
