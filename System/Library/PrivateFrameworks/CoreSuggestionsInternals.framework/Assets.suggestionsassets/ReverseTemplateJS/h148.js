// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r,a){var n=Scanner.fromMessage(e);n.setLocale(t);var i,p,g,x,u,o,l,m,d=[],h=[],s=[],T=1,v="Confirmed";for(x=n.getSpan().nextText(r.price).nextText("\n"),x=n.getSpan().withInterval(x.getEnd(),x.nextText("\n").getStart()),u=x.innerCapture(regExpFormatted(/([\d\., ]+)/),1).trim(),o=x.innerCapture(regExpFormatted(/([^\d\., ]+)/),1),p=n.getSpan().nextText(r.flight).nextText("[1]"),n.getSpan().nextText(r.cancel).exists()?v="Cancelled":n.getSpan().nextText(r.limit).exists()?v="Pending":n.getSpan().nextText(r.refund).exists()&&(v="Cancelled");p.exists();){var S,c,z,f={},y=p.nextDate();f.flightNumber=p.nextRegExp(regExpFormatted(/\d{3,4}/)),c=f.flightNumber.nextDate(),S=f.flightNumber.nextDate().nextDate(),f.departureAirportFuzzy=n.getSpan().withInterval(f.flightNumber.getEnd(),c.previousText("(").getStart()).trim(),f.arrivalAirportFuzzy=n.getSpan().withInterval(f.flightNumber.nextText("-").getEnd(),S.previousText("(").getStart()).trim(),f.departureTime=getFuzzyDate(n.getDetachedSpan(y+" "+c)),f.arrivalTime=getFuzzyDate(n.getDetachedSpan(y+" "+S)),z=p.nextText(r.ticket),f.ticketNumber=n.getSpan().withInterval(z.getEnd(),z.nextText("\n").getStart()).trim(),f.seatNumber=[],ASSERT(f.arrivalAirportFuzzy,f.departureAirportFuzzy,f.flightNumber,f.departureTime,f.arrivalTime)&&d.push(f),T++,p=p.nextText("["+T+"]")}i=n.getSpan().nextText(r.passenger).nextText("\n"),i=n.getSpan().withInterval(i.getEnd(),i.nextText("\n").getStart()),m=n.getSpan().nextText(r.siege).nextText("\n"),T=0;do{if(ASSERT(i)&&h.push({name:i}),m.exists()){var F=n.getSpan().withInterval(m.nextText(i).getEnd(),m.nextText(i).nextText("\n").getStart()).trim().split(" ");for(var N in F){var b=F[N];""+b!="-"&&(d[N].seatNumber[T]=b)}m=n.getSpan().withInterval(m.getEnd(),m.nextText("\n").getStart())}i=i.nextText("\n"),i=n.getSpan().withInterval(i.getEnd(),i.nextText("\n").getStart()),T++}while(i.getLength());for(var A=0;d.length>A;A++)for(var E=d[A],C=0;h.length>C;C++){var w=h[C],D={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Airdo",airlineCode:"HD",flightNumber:E.flightNumber,departureAirportFuzzy:E.departureAirportFuzzy,departureAirportCode:E.departureAirportCode,departureTime:E.departureTime,arrivalAirportFuzzy:E.arrivalAirportFuzzy,arrivalAirportCode:E.arrivalAirportCode,arrivalTime:E.arrivalTime},underName:{"@type":"http://schema.org/Person",name:w.name},checkinUrl:l,reservationId:g,reservationStatus:"http://schema.org/Reservation"+v,totalPrice:u,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:E.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:E.seatNumber[C],seatingType:""}}};s.push(D)}return s.length?s:void 0}}).call();
