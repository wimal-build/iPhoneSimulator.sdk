// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,g,p,o,l,s,m,u,d,h,T,c=[],v=[],x=[];n=a.getSpan().next(r.reservationId).nextAnyTag("td").tagContents().trim();for(var f,b,A=a.getSpan().next(r.passengers).next(r.passenger);0!==(""+A).length;)f=A.innerCapture(r.passenger),m={},m.name=f.$name,m.ticketNumber=f.$ticketNumber,ASSERT(m.name)&&(b=!0,c.push(m)),A=A.next(r.passenger);for(d=a.getSpan().next(r.flightDetails).nextTag("table5").parentTag("table4").allInnerTags("table5"),l=0;d.length>l;l++)if(u={},s=d[l].allInnerTags("td5"),s.length>2){if(!b){var C=s[1].next(r.passengerAlt).parentTag("table6").allInnerTags("td6");for(y=0;C.length>y;y++)m={},m.name=C[y].nextTag("td7").tagContents().trim(),m.name&&(b=!0,c.push(m))}h=s[0].innerCapture(r.flightInfo),u.airlineCode=h.$airlineCode,u.flightNumber=h.$flightNumber,i=s[1].innerDate(),g=s[1].next(r.departure).nextTag("td6").innerDate(),u.departureTime=combineDateAndTime(i,g),u.departureAirport=s[1].next(r.departure).nextTag("td6").tagContents().innerCapture(/(.*)\s\n/,1),p=s[1].next(r.arrival).nextTag("td6").innerDate(),u.arrivalTime=combineDateAndTime(i,p),u.arrivalAirport=s[1].next(r.arrival).nextTag("td6").tagContents().innerCapture(/(.*)\s\n/,1),u.seatingType=s[1].next(r.seat).nextTag("td7").tagContents().trim(),ASSERT(u.departureAirport,u.arrivalAirport,u.departureTime,u.arrivalTime,u.airlineCode,u.flightNumber)&&v.push(u)}T=r.bookingPending?"Pending":"Confirmed";for(var y=0;c.length>y;y++)for(m=c[y],l=0;v.length>l;l++){u=v[l];var N={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Aero M\xe9xico",airlineCode:u.airlineCode,flightNumber:u.flightNumber,departureAirportFuzzy:u.departureAirport,departureTime:u.departureTime,arrivalAirportFuzzy:u.arrivalAirport,arrivalTime:u.arrivalTime},underName:{"@type":"http://schema.org/Person",name:m.name},checkinUrl:o,reservationId:n,reservationStatus:"http://schema.org/Reservation"+T,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:m.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:u.seatingType}}};x.push(N)}return x.length?x:void 0}}).call();
