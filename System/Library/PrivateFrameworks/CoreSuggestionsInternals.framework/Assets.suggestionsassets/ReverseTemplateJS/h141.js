// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,a){function t(r){r.test(e.plain)&&(o=i.getSpan().innerCapture(regExpFormatted(/\1([\s\S]+?)\n\n/,r),1),s=o.innerCapture(/From\s+($<departureFuzzy>.*)\(($<departureCode>.+?)\)\s+to\s+($<arrivalFuzzy>.*)\(($<arrivalCode>.+?)\)($<date>[\s\S]+)\s+Flight\s+($<flightNumber>\d+)\s+Depart.+?at\s+($<departureHour>[\d]{2})($<departureMinute>[\d]{2})\s+and arrive.*at\s+($<arrivalHour>[\d]{2})($<arrivalMinute>[\d]{2})/),v=s.$departureFuzzy,h=s.$departureCode,C=s.$arrivalFuzzy,F=s.$arrivalCode,g="FR",u=s.$flightNumber,m=i.getDetachedSpan(s.$date+" "+s.$departureHour+":"+s.$departureMinute).innerDate(),$=i.getDetachedSpan(s.$date+" "+s.$arrivalHour+":"+s.$arrivalMinute).innerDate(),ASSERT(u,m,v,$,C)&&T.push({airlineCode:g,flightNumber:u,departureAirport:v,departureCode:h,departureTime:m,arrivalAirport:C,arrivalCode:F,arrivalTime:$,passengers:A}))}var i=Scanner.fromMessage(e);i.setLocale(r);var n,p,o,u,d,l,s,g,m,v,h,c,$,C,F,y,z,S,f,N=[],T=[];y=i.getSpan().innerCapture(regExpFormatted(/\1\s+(.*)/,a.reservationId),1);var A=i.getSpan().innerCapture(regExpFormatted(/\1\n(.*)/,a.passengers),1).allInnerCapture(/\d\.\s+([\D]+)/,1);for(t(a.goingOut),t(a.comingBack),z=0;T.length>z;z++){c=T[z];for(var b=0;A.length>b;b++){var k={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:c.airlineName,airlineCode:c.airlineCode,flightNumber:c.flightNumber,departureAirportFuzzy:c.departureAirport,departureAirportCode:c.departureCode,departureTime:c.departureTime,arrivalAirportFuzzy:c.arrivalAirport,arrivalAirportCode:c.arrivalCode,arrivalTime:c.arrivalTime},underName:{"@type":"http://schema.org/Person",name:A[b]},checkinUrl:S,reservationId:y,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:d,priceCurrency:l,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:f,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:n,seatingType:p}}};N.push(k)}}return N.length?N:void 0}}).call();