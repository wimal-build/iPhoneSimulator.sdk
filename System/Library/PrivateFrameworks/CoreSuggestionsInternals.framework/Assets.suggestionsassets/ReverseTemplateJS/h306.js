// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,o,s,d,i,c,g,l,h,p,m,x,u,T,C,$,A,v,y,S;if(n.cancelled){if(v=a.getSpan().inner(regExpFormatted(/\1/,n.cancellationLabel)).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1/,n.cancellationHotelRegex)),!v)return STOP;T=v.$hotelName,r=v.$underName}else S=a.getSpan().nextTag("table4").nextTag("table4").allInnerTagsFiltered("td4")[0].tagContents().innerCapture(/($<hotelName>.*)\s+($<hotelAddress>.*)\s+(?:.*:\s+)?($<hotelPhone>.*)/),C=S.$hotelPhone,T=S.$hotelName,$=S.$hotelAddress.innerAddress().exists()?S.$hotelAddress.innerAddress():S.$hotelAddress;return y=a.getSpan().nextText(n.duration).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<checkIn>.*) . ($<checkOut>.*)/)),l=y.$checkIn,m=y.$checkOut,i=m.next(n.reservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1:\s+(\d+)/),1),A=i.nextLink(),r||(r=A.nextText(n.name).nextAnyTag("td").tagContents()),g=A.nextText(n.checkIn).nextDate(),p=g.nextDate(),h=a.getDetachedSpan(""+l+" "+g).innerDate(),x=a.getDetachedSpan(""+m+" "+p).innerDate(),o=p.nextText(n.price).nextAnyTag("td").tagContents(),s=o.innerCapture(/([\d,.]+)/,1),d=o.innerCapture(/([^\d,.]+)/,1).trim(),n.cancelled&&(c="Cancelled"),ASSERT(r,h,x)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r},totalPrice:s,priceCurrency:d,checkinTime:h,checkoutTime:x,modifyReservationUrl:A,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),reservationId:i,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:T,url:u,telephone:C,address:$}}]:void 0}}).call();
