// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a,i,n,o,p,l,m,u,d,s=[],h={},g=Scanner.fromMessage(e);for(g.setLocale(r),n=g.getSpan().innerCapture(regExpFormatted(/\1\n\n(.*)/,t.reservationId),1),u=g.getSpan().allTransitInformation(),p=0;u.length>p;p++)m={},l=u[p].previousDate(),a=u[p].nextDate(),m.departureCode=a.parentAnyTag("td").innerCapture(/\((.*?)[\)\s-]/,1),i=a.nextDate(),m.arrivalCode=i.parentAnyTag("td").innerCapture(/\((.*?)[\)\s-]/,1),d=u[p].innerCapture(/($<airlineCode>\D+)\s+($<flightNumber>\d+)/),m.airlineCode=d.$airlineCode,m.flightNumber=d.$flightNumber,m.departureTime=combineDateAndTime(l,a),m.arrivalTime=combineDateAndTime(l,i),ASSERT(m.departureTime,m.arrivalTime,m.airlineCode,m.flightNumber,m.departureCode,m.arrivalCode)&&s.push(m);h=g.getSpan().allInnerCapture(/\[table4\]\s\[tr4\]\s\[td4\]([^\[\]:><\uff1a\/]{4,})\[\/td4\]\s\[td4\]\s{3}/,1),ASSERT(h.length>0);var c,v=[];for(p=0;s.length>p;p++){m=s[p];for(var C=0;h.length>C;C++){var b=(""+h[C]).trim();c={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineCode:m.airlineCode,flightNumber:m.flightNumber,departureAirportFuzzy:m.departureAirport,departureAirportCode:m.departureCode,departureTime:m.departureTime,arrivalAirportFuzzy:m.arrivalAirport,arrivalAirportCode:m.arrivalCode,arrivalTime:m.arrivalTime},underName:{"@type":"http://schema.org/Person",name:b},checkinUrl:o,reservationId:n,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:null,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:null,seatingType:null}},totalPrice:null,priceCurrency:null,reservationStatus:"http://schema.org/ReservationConfirmed"},valid(b.membershipNumber)&&(c.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:b.membershipNumber,programName:"Frequent Flyer"}),v.push(c)}}return v.length?v:void 0}}).call();
