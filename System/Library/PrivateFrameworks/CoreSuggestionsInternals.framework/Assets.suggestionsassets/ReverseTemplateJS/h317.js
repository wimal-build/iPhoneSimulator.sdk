// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,g,p,d,s,c,x,u,l,m,h,T,S,v,C;return i=a.getSpan().innerCapture(regExpFormatted(/\b\1 (.*)\s/,n.email),1),d=a.getSpan().innerCapture(regExpFormatted(/\b\1 (\d+)/,n.reservationId),1),1===n.version?(o=a.getSpan().nextText(n.reservationDetails).nextTag("table4"),m=o.nextTag("td4").tagContents().innerCapture(/(.*?) </,1),l=o.innerLink(),h=o.innerPhoneNumber(),T=o.nextTag("table7").allInnerTagsFiltered("td7").slice(1,3).join(" "),x=a.getSpan().nextText(n.checkInDate).nextDate(),u=a.getSpan().nextText(n.checkOutDate).nextDate(),g=a.getSpan().next(n.price).nextTag("td5").tagContents().innerCapture(/([\d,.]+)/,1),p=a.getSpan().next(n.price).nextTag("td5").tagContents().innerCapture(/(.)([\d,.]+)/,1)):(m=n.name.exec(e.subject)[1],l=a.getSpan().next(m).parentAnyTag("td").innerLink(),T=a.getSpan().next(m).nextAnyTag("td").innerAddress(),h=T.nextAnyTag("td").innerPhoneNumber(),x=a.getSpan().next(n.checkInDate).nextAnyTag("td").nextAnyTag("td").innerDate(),u=a.getSpan().next(n.checkOutDate).nextAnyTag("td").nextAnyTag("td").innerDate(),C=a.getSpan().next(n.price).innerCapture(regExpFormatted(/\1\s+(.*)/,n.price),1),g=C.innerCapture(/([\d,.]+)/,1),p=C.innerCapture(/([^\d,.]+)/,1)),ASSERT(x,u,T)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:g,priceCurrency:p,checkinTime:x,checkoutTime:u,modifyReservationUrl:S,cancelReservationUrl:v,reservationStatus:"http://schema.org/Reservation"+(s||"Confirmed"),reservationId:d,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:l,telephone:h,geo:valid(c)?{"@type":"http://schema.org/GeoCoordinates",latitude:c.$latitude,longitude:c.$longitude}:null,address:T}}]:void 0}}).call();
