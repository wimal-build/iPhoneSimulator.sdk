// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,o,i,g,c,l,p,s,d,u,h,x,m,S;if(1===n.version)r=a.getSpan().innerCapture(n.bookingName,1),c=a.getSpan().innerCapture(n.confirmationNumber,1),p=a.getSpan().nextRegExp(n.checkInDate).nextDate(),s=a.getSpan().nextRegExp(n.checkOutDate).nextDate(),u=a.getSpan().nextText(n.cancellationConfirmed).nextTag("td1").tagContents(),x=u.nextTag("td1").tagContents(),x.innerAddress().getLength()>=x.getLength()&&(x=x.innerAddress()),i=a.getSpan().innerCapture(n.cancellationTotalPrice,1).innerCapture(/([\d,.]+)/,1),g=a.getSpan().innerCapture(n.cancellationTotalPrice,1).innerCapture(/([^\d,.]+)/,1).trim(),h=(""+a.getSpan().nextRegExp(n.cancellationPhone).parentTag("td1").innerPhoneNumber()).replace(n.cancellationPhone,"");else if(2===n.version){c=a.getSpan().nextText(n.reservationId).nextAnyTag("td").tagContents(),p=a.getSpan().nextText(n.checkInDate).nextAnyTag("td").innerDate(),s=a.getSpan().nextText(n.checkOutDate).nextAnyTag("td").innerDate();var T=a.getSpan().nextText(n.hotel).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1 ($<name>.+?) <($<url>.*)>/,n.hotel));u=x=T?T.$name:null,d=T?T.$url:null,o=a.getSpan().innerCapture(regExpFormatted(/\1 (.+?)\n/,n.email),1)}return ASSERT(p,s,x)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:o},totalPrice:i,priceCurrency:g,checkinTime:p,checkoutTime:s,modifyReservationUrl:m,cancelReservationUrl:S,reservationStatus:"http://schema.org/ReservationCancelled",reservationId:c,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:u,url:d,telephone:h,geo:valid(l)?{"@type":"http://schema.org/GeoCoordinates",latitude:l.$latitude,longitude:l.$longitude}:null,address:x}}]:void 0}}).call();
