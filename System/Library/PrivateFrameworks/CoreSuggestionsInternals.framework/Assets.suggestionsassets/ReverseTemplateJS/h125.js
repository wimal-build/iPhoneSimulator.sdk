// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(t);var i,n,p,l,o,m,g,d,s,u,T,b,h,v,C,c,x,A,N,f=[],y={};u=a.getSpan().next(r.total).nextTag("table5").nextTag("table5").nextTag("table5").nextTag("table5").nextTag("table5").nextTag("table5").nextTag("td5").tagContents(),p=u.innerCapture(/([\d,.]+)/,1),l=u.innerCapture(/([^\d,.]+)/,1),i=""+a.getSpan().innerCapture(r.reservationId,1),c=a.getSpan().nextRegExp(/Ticket number\(s\)/).nextTag("table3").nextTag("table3").allInnerTagsFiltered("td3");for(var F=0;c.length>F;F++)c[F].innerCapture(/($<name>.*) <.*?>/)&&(C=c[F].innerCapture(/($<name>.*) <.*?>/,1),x=c[F+1]&&c[F+1].innerCapture(/^(\d+)$/,1)),valid(C)&&(y[""+C]={name:C,ticketNumber:x,seats:{},seatingType:{},frequentFlier:""}),C=null;for(A=a.getSpan().next(r.terminal).nextTag("table4").nextTag("table4").allInnerTags("table5"),o=0;A.length>o;o+=5)T={},d=A[o].innerDate(),b=A[o+1].allInnerDates(),T.departureTime=combineDateAndTime(d,b[0]),T.arrivalTime=combineDateAndTime(d,b[1]),h=A[o+2].nextAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<departureAirport>.*)\s+\(($<departureCode>.*)\)\s+\1\s+($<arrivalAirport>.*)\s+\(($<arrivalCode>.*)\)/,r.to)),T.departureAirport=h.$departureAirport,T.departureCode=h.$departureCode,T.arrivalAirport=h.$arrivalAirport,T.arrivalCode=h.$arrivalCode,T.flightNumber=A[o+3].nextAnyTag("td").tagContents(),s=A[o+4].nextTag("table6"),v=y[s.nextAnyTag("td").tagContents()],v.frequentFlier=s.nextTag("table6").nextAnyTag("td").tagContents(),g=v.frequentFlier.nextTag("table6").nextAnyTag("td").tagContents(),r.select_seat.test(""+g)||(v.seats[T.flightNumber]=g),y[v.name]=v,ASSERT(T.flightNumber,T.departureTime,T.arrivalTime,T.departureCode,T.arrivalCode)&&f.push({airlineName:"JetBlue",airlineCode:"B6",flightNumber:T.flightNumber,departureTime:T.departureTime,departureCode:T.departureCode,departureAirport:T.departureAirport,arrivalTime:T.arrivalTime,arrivalCode:T.arrivalCode,arrivalAirport:T.arrivalAirport,passengers:y});var $=[];for(o=0;f.length>o;o++){var T=f[o];for(N=Object.keys(T.passengers),m=0;N.length>m;m++){var S=T.passengers[N[m]],k={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:T.airlineName,airlineCode:T.airlineCode,flightNumber:T.flightNumber,departureAirportFuzzy:T.departureAirport,departureAirportCode:T.departureCode,departureTime:T.departureTime,arrivalAirportFuzzy:T.arrivalAirport,arrivalAirportCode:T.arrivalCode,arrivalTime:T.arrivalTime},underName:{"@type":"http://schema.org/Person",name:S.name},checkinUrl:n,reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:p,priceCurrency:l,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:S.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:S.seats[T.flightNumber],seatingType:S.seatingType[T.flightNumber]}}};valid(S.membershipNumber,S.programName)&&(k.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:S.membershipNumber,programName:S.programName}),$.push(k)}}return $.length?$:void 0}}).call();