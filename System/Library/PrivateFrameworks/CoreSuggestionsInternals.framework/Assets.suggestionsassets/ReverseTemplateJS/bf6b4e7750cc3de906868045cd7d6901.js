// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("opentable.com-cancellation-en",function(e){return/(?:reservation has been canceled|Cancell?ation|booking cancellation)$/.test(e.subject)},function(e){if(/(?:reservation has been canceled|Cancell?ation|booking cancellation)$/.test(e.subject)){var t=loadHelper("opentable.com-microdata-parser.js"),n=t(e);if(n)return n;var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,o,s,i,p,l,u,c,g,m,d;if(r=a.getSpan().innerCapture(/(?:Dear|Hello) (.*),/,1),o=a.getSpan().innerCapture(/\boriginal reservation(?::| was) (\d+)/,1),a.getSpan().innerCapture(/\b has cancell?ed your reservation/)?(s=a.getSpan().innerCapture(concatRegExp(/^Dear ($<underName>.*)\,/,/\s*\n($<name>.*) has cancell?ed your reservation for ($<partySize>\d+) ($<startTime>on .*)\./,/\s*\n.*please contact ($=name) at ($<phone>.*?)\./)),p=s?s.$partySize:null,i=s?s.$name:null,u=s?s.$startTime:null,c=s?s.$phone.innerPhoneNumber():null):a.getSpan().innerCapture(/\bYou've successfully cancell?ed your reservation/)?(s=a.getSpan().innerCapture(/\breservation for a party of ($<partySize>\d+) at ($<name>.*) ($<startTime>on .*)\./),p=s?s.$partySize:null,i=s?s.$name:null,u=s?s.$startTime:null):a.getSpan().innerCapture(/\bYou've successfully cancelled your booking:/)&&(u=a.getSpan().firstDate(),p=a.getSpan().innerCapture(/Table for (\d+)/,1),i=a.getSpan().innerCapture(/Restaurant:\s+\n(.*)/,1).trim()),ASSERT(p,i,u,r))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:p,reservationId:o,reservationStatus:"http://schema.org/ReservationCancelled",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:i,url:l,telephone:c,address:g},startTime:u,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:r},cancelReservationUrl:d,modifyReservationUrl:m}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1284","SGf6006ebb"),new ReverseTemplate("opentable.com-confirmation-en",function(e){return/^Your Reservation Confirmation for/.test(e.subject)||/^Your request for a reservation [\s\S]* is confirmed$/.test(e.subject)||/booking change$/.test(e.subject)},function(e){if(/^Your Reservation Confirmation for/.test(e.subject)||/^Your request for a reservation [\s\S]* is confirmed$/.test(e.subject)||/booking change$/.test(e.subject)){var t="en_US",n=loadHelper("opentable.com-microdata-parser.js"),a=n(e,t);if(a)return a;if(int(e.epoch)<1325376e3)return CONTINUE;var r=Scanner.fromMessage(e);r.setLocale(t);var o={};o.partySize=/(?:Table\sfor|Party\sof)/,o.reservation="Your reservation is confirmed for",o.thanks="Thanks for using OpenTable!";var s,i,p,l,u,c,g,m,d,S,b;p=r.getSpan().innerCapture(/Your (?:table|reservation) for ($<partySize>\d+) at ($<name>.*)\s+(?:will be ready on|is confirmed for)\s+($<startTime>.*)\. The reservation is held under: ($<underName>.*)\./),s=r.getSpan().innerCapture(/^Dear (.*),/,1),s=p?p.$underName||s:null,s!==r.getNullSpan()&&null!==s||(s=r.getSpan().innerCapture(/Dear (.*),/,1),""+s==""&&(s=r.getSpan().next(o.partySize).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/(.*)\s+\1/,o.partySize),1)),""+s==""&&(s=r.getSpan().next(o.partySize).previousTag("td6").tagContents()),""+s==""&&(s=r.getSpan().next("Confirmation #").previousAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1 (.*)/,"Name:"),1))),u=p?p.$partySize:null,null===u&&(u=r.getSpan().next(o.partySize).parentAnyTag("td").innerCapture(regExpFormatted(/\1\s(\d+)\s/,o.partySize),1));var h=""+r.getSpan().next("Confirmation #: ").parentAnyTag("td").tagContents();if(h&&h!==r.getNullSpan()&&(i=/Confirmation #: ([0-9]*)/.exec(h)[1]),i&&i!==r.getNullSpan()||(i=r.getSpan().innerCapture(/\bYour confirmation number: (\d+)/,1)),i&&i!==r.getNullSpan()||(i=r.getSpan().nextText("Have questions?").parentTag("td4").innerCapture(/\bYou can reference reservation number (\d+)/,1)),d&&d!==r.getNullSpan()||(d=r.getSpan().next("Get directions").nextAnyTag("td"),d.innerAddress()!==r.getNullSpan()&&(d=d.innerAddress())),d&&d!==r.getNullSpan()||(d=r.getSpan().nextText("To get there:").collapseToEnd().withEnd(r.getSpan().nextText("Cross Street:").getStart()).trim(),d=not(d.innerAddress())?d.innerCapture(/^.*\r?\n(.*)$/,1):d.innerAddress()),d&&d!==r.getNullSpan()||(d=r.getSpan().nextTag("table8").nextTag("td8").tagContents().innerCapture(/^([.\S\s]*)\sCross\sStreet/,1),d.innerAddress()!==r.getNullSpan()&&(d=d.innerAddress())),m=r.getSpan().nextText("Questions about your reservation? You can always contact").nextPhoneNumber(),m===r.getNullSpan()&&(m=r.getSpan().nextTag("table8").nextTag("td8").innerPhoneNumber()),l=p?p.$name:null,null===l&&(e.epoch>1472768064&&/Reservation Confirmation/.exec(e.subject)?l=/Your Reservation Confirmation for (.*)/.exec(e.subject)[1]:(l=r.getSpan().innerCapture(/Restaurant:\s+\n(.*)/,1).trim(),l.exists()||(l=(""+r.getSpan().nextTag("table3").nextTag("td3").nextTag("td3").tagContents()).replace(o.reservation,"").replace(o.thanks,"").trim()))),g=p?r.getDetachedSpan(""+p.$startTime):null,null===g&&(g=r.getSpan().next(o.partySize).parentAnyTag("td").innerDate()),S=r.getSpan().nextText("Update your reservation date").nextLink(),S===r.getNullSpan()&&(S=r.getSpan().nextText("View or modify reservation").parentTag("td6").innerLink()),b=r.getSpan().nextText("Cancel your reservation").nextLink(),b===r.getNullSpan()&&(b=r.getSpan().nextText("Cancel reservation").parentTag("td6").innerLink()),ASSERT(u,l,g,s))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:u,reservationId:i,reservationStatus:"http://schema.org/ReservationConfirmed",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:l,url:c,telephone:m,address:d},startTime:g,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:s},cancelReservationUrl:b,modifyReservationUrl:S}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1286","SG9fec6b7b"),new ReverseTemplate("opentable.com-reservation-change-en",function(e){return/Change$/.test(e.subject)},function(e){if(/Change$/.test(e.subject)){var t=loadHelper("opentable.com-microdata-parser.js"),n=t(e);if(n)return n;var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,o,s,i,p,l,u,c,g,m,d,S;if(r=a.getSpan().innerCapture(/(?:Dear|Hello) (.*),/,1),o=a.getSpan().innerCapture(/\bConfirmation Number: (\d+)/,1),m=a.getSpan().nextText("To get there:").collapseToEnd().withEnd(a.getSpan().nextText("Cross Street:").getStart()).trim(),m=not(m.innerAddress())?m.innerCapture(/^.*\r?\n(.*)$/,1):m.innerAddress(),g=a.getSpan().nextText("Questions about your reservation? You can always contact").nextPhoneNumber(),s=a.getSpan().innerCapture(/\. ($<name>.*) will be ready for your party of ($<partySize>\d+) ($<startTime>at .*)\./),i=s?s.$name:null,p=s?s.$partySize:null,c=s?s.$startTime:null,d=a.getSpan().nextText("To make another change:").nextLink(),S=a.getSpan().nextText("To cancel:").nextLink(),ASSERT(p,i,c,r))return[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:p,reservationId:o,reservationStatus:"http://schema.org/Reservation"+(u||"Confirmed"),reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:i,url:l,telephone:g,address:m},startTime:c,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www.opentable.com/"},underName:{"@type":"http://schema.org/Person",name:r},cancelReservationUrl:S,modifyReservationUrl:d}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1288","SG7381b4bd"),new ReverseTemplate("opentable.jp-cancellation-jp",function(e){return/\u30ad\u30e3\u30f3\u30bb\u30eb/.test(e.subject)},function(e){if(!/\u30ad\u30e3\u30f3\u30bb\u30eb/.test(e.subject))return CONTINUE;var t={};t.hello="\u69d8",t.number="\u4e88\u7d04\u756a\u53f7",t.person=/(\d+)\s*\u540d\u69d8/,t.cancel=/(\u30eb\u3057\u307e\u3057\u305f\u3002|\u306e\u3054\u4e88\u7d04\u30ad\u30e3\u30f3\u30bb\u30eb\u3092\u627f\u308a\u307e\u3057\u305f\u3002)/,t.address="\u4f4f\u6240",t.nameCapture=/\u30aa\u30f3\u30e9\u30a4\u30f3\u306b\u3066\u300e(.*)\u300f\u306e\u3054\u4e88\u7d04\u30ad\u30e3\u30f3\u30bb\u30eb\u3092\u627f\u308a\u307e\u3057\u305f\u3002/,t.dateCapture=/($<year>\d{4}).*?($<month>\d{2}).*?($<day>\d{1,2}).*?($<time>\d{2}:\d{2})/;var n="ja_JP",a="opentable.jp",r=loadHelper("opentable.com-cancellation-skeleton.js");return r(e,n,t,a)},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1297","SGf3cc51c8"),new ReverseTemplate("opentable.jp-confirmation-jp",function(e){return/\u306e\u78ba\u8a8d$/.test(e.subject)||/\u660e\u65e5\u306e\u3054\u4e88\u7d04\u306e\u6700\u7d42\u78ba\u8a8d$/.test(e.subject)||/\u78ba\u8a8d\u30e1\u30fc\u30eb$/.test(e.subject)},function(e){if(/\u306e\u78ba\u8a8d$/.test(e.subject)||/\u660e\u65e5\u306e\u3054\u4e88\u7d04\u306e\u6700\u7d42\u78ba\u8a8d$/.test(e.subject)||/\u78ba\u8a8d\u30e1\u30fc\u30eb$/.test(e.subject)){var t="ja_JP",n=loadHelper("opentable.com-microdata-parser.js"),a=n(e,t);if(a)return a}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1298","SG93372f23"),new ReverseTemplate("opentable.jp-reservation-change-jp",function(e){return/\u306e\u5909\u66f4$/.test(e.subject)},function(e){if(!/\u306e\u5909\u66f4$/.test(e.subject))return CONTINUE;var t={};t.hello="\u69d8",t.number="\u4e88\u7d04\u756a\u53f7",t.person="\u540d\u69d8",t.infos=/(?:\u4e88\u7d04\u60c5\u5831|\u3092\u627f\u308a\u307e\u3057\u305f\u3002)/,t.infosCapture=/(\u4e88\u7d04\u60c5\u5831|\u3092\u627f\u308a\u307e\u3057\u305f\u3002)/,t.reservation="\u3054\u4e88\u7d04\u306e\u5909\u66f4",t.reservationAlt="\u306e\u3054\u4e88\u7d04\u5185\u5bb9\u306e\u5909\u66f4",t.address="\u4f4f\u6240 ",t.addressAlt="\u4f4f\u6240",t.description="\u30a2\u30af\u30bb\u30b9\u60c5\u5831";var n="ja_JP",a="opentable.jp",r=loadHelper("opentable.com-reservation-change-skeleton.js");return r(e,n,t,a)},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1219/1280/1299","SGaebf0c86")]);
