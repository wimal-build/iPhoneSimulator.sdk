// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){if(!e||!r||!t)return CONTINUE;var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,o,p,l,u,d,s,m,h,v,g,c,C,T=a.getSpan(),A=[];n=T.nextText(t.reservationId).parentTag("td3").tagContents().innerCapture(regExpFormatted(/\1(.+)/,t.reservationId),1).trim();var f=T.nextText(t.flightDetails).nextTag("table4").tagContents();[,d,p]=f.innerCapture(/([0-9A-Z]+)\s(\d+)\n/);var y=f.allInnerTagsFiltered("td4");[,m,h]=y[2].innerCapture(/(.+)\((.+)\)/),[,g,c]=y[4].innerCapture(/(.+)\((.+)\)/),s=y[2].innerDate(),v=y[4].innerDate(),ASSERT(p,s,v)&&A.push({airlineCode:d,flightNumber:p,departureTime:s,departureCode:h,departureAirport:m.trim(),arrivalTime:v,arrivalCode:c,arrivalAirport:g.trim()});var N=[];for(C=0;A.length>C;C++){var F=A[C],x={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Copa Airlines",airlineCode:"CM",flightNumber:F.flightNumber,departureAirportFuzzy:F.departureAirport,departureAirportCode:F.departureCode,departureTime:F.departureTime,arrivalAirportFuzzy:F.arrivalAirport,arrivalAirportCode:F.arrivalCode,arrivalTime:F.arrivalTime},underName:{"@type":"http://schema.org/Person",name:""},checkinUrl:o,reservationId:n,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:l,priceCurrency:u,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}};N.push(x)}return N.length?N:void 0}}).call();
