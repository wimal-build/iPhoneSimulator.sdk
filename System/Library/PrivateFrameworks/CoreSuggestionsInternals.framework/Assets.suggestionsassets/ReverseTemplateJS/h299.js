// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var n,i,o,p,s,d,m,g,l,c,h,u,v,T,f,C,y=[],A=[],N=[],x=[];for(C=a.getSpan().next(t.contactPerson).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.contactPerson),1),l=a.getSpan().next(t.passengers).parentAnyTag("table").allInnerTags("tr2"),n=1;l.length>n;n++)l[n].allInnerTags("td2").length>2&&(c=l[n],h={},h.name=c.nextAnyTag("td").tagContents(),N.push(h));for(o=a.getSpan().next(t.flightSummary).nextTag("table4").allInnerCapture(t.departure,0),n=0;o.length>n;n++)p=o[n],f={},s=(""+p.previousAnyTag("td").previousAnyTag("td").tagContents()).replace(/-/g," "),d=p.parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<departureAirport>.*)\s+\(($<departureCode>.*)\)\s+\1\s+($<departureTime>.*)/,t.departure)),f.departureAirport=d.$departureAirport,f.departureCode=d.$departureCode,f.departureTime=a.getDetachedSpan(""+s+" "+d.$departureTime).innerDate(),m=p.next(t.arrival).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<arrivalAirport>.*)\s+\(($<arrivalCode>.*)\)\s+\1\s+($<arrivalTime>.*)/,t.arrival)),f.arrivalAirport=m.$arrivalAirport,f.arrivalCode=m.$arrivalCode,f.arrivalTime=a.getDetachedSpan(""+s+" "+m.$arrivalTime).innerDate(),g=p.next(t.flight).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/($<airline>.*)\s+\1\s+($<flightNr>\d+)/,t.flight)),f.airlineName=g.$airline,f.flightNumber=g.$flightNr,f.seatingType=g.$flightNr.nextAnyTag("td").nextAnyTag("td").tagContents(),f.reservationId=a.getSpan().next(t.flightReservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.flightReservationId),1),ASSERT(f.airlineName,f.flightNumber,f.arrivalTime,f.departureTime,f.arrivalAirport,f.departureAirport)&&A.push(f);for(u=a.getSpan().next(t.carSummary).parentTag("table3").allInnerCapture(t.carPickup,0),n=0;u.length>n;n++)T=u[n],v={},v.pickupTime=T.parentAnyTag("td").tagContents().innerDate(),v.dropoffTime=T.next(t.carDropoff).parentAnyTag("td").tagContents().innerDate(),v.pickupAddress=v.dropoffAddress=T.next(t.carLocation).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.carLocation),1),v.reservationId=T.next(t.carReservationId).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\1\s+(.*)/,t.carReservationId),1),v.provider=T.parentTag("td4").tagContents().innerCapture(/(.*)\:/,1),v.name=C,ASSERT(v.name,v.provider,v.dropoffTime,v.pickupTime)&&x.push(v);for(n=0,f;A.length>n;n++){f=A[n];for(var b=0;N.length>b;b++){var S=N[b];i={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:f.airlineName,airlineCode:f.airlineCode,flightNumber:f.flightNumber,departureAirportFuzzy:f.departureAirport,departureAirportCode:f.departureCode,departureTime:f.departureTime,arrivalAirportFuzzy:f.arrivalAirport,arrivalAirportCode:f.arrivalCode,arrivalTime:f.arrivalTime},underName:{"@type":"http://schema.org/Person",name:S.name},checkinUrl:f.checkinUrl,reservationId:f.reservationId,reservationStatus:"http://schema.org/Reservation"+(f.reservationStatus||"Confirmed"),totalPrice:S.totalPrice,priceCurrency:S.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:S.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:f.seats,seatingType:f.seatingType}}},valid(S.membershipNumber,S.programName)&&(i.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:S.membershipNumber,programName:S.programName}),y.push(i)}}for(n=0,v;x.length>n;n++)v=x[n],i={"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:v.totalPrice,priceCurrency:v.priceCurrency,reservationId:v.reservationId,reservationStatus:"http://schema.org/Reservation"+(v.reservationStatus||"Confirmed"),checkinUrl:v.checkinUrl,modifyReservationUrl:v.modifyReservationUrl,cancelReservationUrl:v.cancelReservationUrl,underName:{"@type":"http://schema.org/Person",name:v.name,email:v.email},provider:{"@type":"http://schema.org/Organization",name:v.provider},pickupTime:v.pickupTime,pickupLocation:{"@type":"http://schema.org/Place",name:v.pickupName,telephone:v.pickupTelephone,address:v.pickupAddress},dropoffTime:v.dropoffTime,dropoffLocation:{"@type":"http://schema.org/Place",name:v.dropoffName,telephone:v.dropoffTelephone,address:v.dropoffAddress}},v.brand&&(i.reservationFor={"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:v.brand},license:v.license,color:v.color}),y.push(i);return y.length?y:void 0}}).call();