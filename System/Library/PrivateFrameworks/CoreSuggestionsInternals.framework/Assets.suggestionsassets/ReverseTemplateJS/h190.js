// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a=Scanner.fromMessage(e);a.setLocale(t);var n,i,o,g,l,p=a.getSpan(),m="Confirmed",s=[],T=[];return n=""+p.next(r.reservationId_prefix).parentAnyTag("td").tagContents(),n="en_GB"===t?/:\n(.*)\n/.exec(n):/: (.*)/.exec(n),2===n.length&&(n=n[1]),l="en_GB"===t?p.next(r.flightDetails_prefix).nextAnyTag("table").nextAnyTag("table").allInnerTags("tr5").filter(function(e,t){var a=""+e;return a.indexOf(r.airportsName_prefix)>-1}):p.next(r.flightDetails_prefix).nextAnyTag("table").nextAnyTag("table").allInnerTags("tr4").filter(function(e,t){var a=""+e;return a.indexOf(r.airportsName_prefix)>-1}),l.forEach(function(e,a){var n,i,o,g,l,m,T,d,x,u,A,h="Flybe",y="BE",c=e.nextAnyTag("td").innerDate(),f=(""+e.nextAnyTag("td").nextAnyTag("td").tagContents()).trim();n=/([0-9]{3,4})/.exec(f)[1];var b=e.nextAnyTag("td").nextAnyTag("td").nextAnyTag("td"),v=r.airportsName_regex.exec(b.tagContents());l=v[1],x=v[2],o=e.nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").innerDate(),T=e.nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").nextAnyTag("td").innerDate(),g=combineDateAndTime(c,o),d=combineDateAndTime(c,T),m=p.next(f).next(f).nextAnyTag("td").tagContents(),u=p.next(f).next(f).nextAnyTag("td").nextAnyTag("td").tagContents(),A="en_GB"===t?p.next(r.flightDetails_prefix).nextAnyTag("table").nextAnyTag("table").nextAnyTag("table").allInnerTags("tr5").filter(function(e,t){return 1===e.allInnerTags("th5").length&&""+e.allInnerTags("th5")[0].tagContents()!=""}):p.next(r.flightDetails_prefix).nextAnyTag("table").nextAnyTag("table").nextAnyTag("table").allInnerTags("tr4").filter(function(e,t){return 1===e.allInnerTags("th4").length&&""+e.allInnerTags("th4")[0].tagContents()!=""}),A.forEach(function(e,t){var r;r=e.nextAnyTag("th").tagContents(),s.push({airlineName:h,airlineCode:y,flightNumber:n,departureDateTime:g,departureAirport:l,departureAirportCode:m,arrivalDateTime:d,arrivalAirport:x,arrivalAirportCode:u,ticketNumber:i,underPersonName:r})})}),s.forEach(function(e,t){ASSERT(e.departureDateTime,e.arrivalDateTime,e.departureAirport,e.arrivalAirport,e.flightNumber,e.airlineCode),T.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:e.underPersonName},checkinUrl:g,reservationId:n,reservationStatus:"http://schema.org/Reservation"+m,totalPrice:i,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}},programMembershipUsed:{"@type":"http://schema.org/ProgramMembership",membershipNumber:e.membershipNumber,programName:e.programName}})}),T.length>=1?T:CONTINUE}}).call();
