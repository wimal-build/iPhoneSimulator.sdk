// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e){if(startsWith(e.subject,"Please complete your sale")||startsWith(e.subject,"Your StubHub sale is cancelled")||startsWith(e.subject,"Charge Applied")||startsWith(e.subject,"Tickets sold"))return CONTINUE;if(startsWith(e.subject,"Create your new StubHub password"))return CONTINUE;if(startsWith(e.subject,"Refund Applied"))return CONTINUE;var t=loadHelper("stubhub.com-microdata-parser.js"),a=t(e);if(a)return a;var s=Scanner.fromMessage(e);s.setLocale("en_US");var r,n,c,i,o,u,p,h,l,d,b,g,m,v,S,C,j;n=s.getSpan().innerCapture(/\bHi (\w+),\s/,1),o=s.getSpan().innerCapture(/\bOrder #: ([\d]+)/,1),u=s.getSpan().innerCapture(/\bbelow to print your tickets\.\s+<(.*)>/,1),u.exists()||(u=s.getDetachedSpan("http://www.StubHub.com")),m=s.getSpan().nextText("Event time subject to change - Check local listings").previousDate();var E=s.getSpan().innerCapture(/\b($<eventName>.*) at ($<address>.*)\s(?:.*)\s\(Event time subject to change/);E&&(b=E.$eventName,j=E.$address);var T=RegExp("\\(Event time subject to change - Check local listings\\)\\s+\\b($<seatSection>.*) \\| ($<numSeats>.*)\\s+(?:(?:Row )?($<seatRow>.*) \\| (?:Seats? )?($<seat>.*)\\s)?"),$=s.getSpan().innerCapture(T);return $&&(d=$.$seatSection,p=$.$numSeats,l=$.$seatRow,h=$.$seat),c=s.getSpan().nextText("Order total:").nextTag("td2").tagContents().innerCapture(/([\d,.]+)/,1),r="http://schema.org/EventConfirmed",startsWith(e.subject,"Event cancelled")||startsWith(e.subject,"Account Credit Applied")?r="http://schema.org/EventCancelled":(startsWith(e.subject,"Order Placed")||startsWith(e.subject,"Your tickets have shipped"))&&(r="http://schema.org/EventTentative"),ASSERT(m,b)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:n,totalPrice:c,priceCurrency:i,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:o,ticketToken:u,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:h,seatRow:l,seatSection:d}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:r,name:b,url:g,startDate:m,endDate:v,location:{"@type":"http://schema.org/Place",name:C,telephone:S,address:j}}}]:void 0}}).call();