// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){if(int(e.epoch)<1356998400)return STOP;var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,g,s,p,c,l,d,m,u,x,T,C;n.emailTitelConfirmation.test(e.subject)?r=a.getSpan().nextRegExp(n.thanksForBookingWithUsRegex).parentAnyTag("td").tagContents().innerCapture(n.thanksForBookingWithUsRegexCapture,1):n.emailTitelCancelConfirmation.test(e.subject)&&(r=a.getSpan().nextText(n.nameCancelled).parentAnyTag("td").tagContents().innerCapture(regExpFormatted(/\b(.*), \1/,n.nameCancelled),1),r.exists()||(r=a.getSpan().nextText(n.cancellation).nextAnyTag("td").nextAnyTag("td").tagContents()),p="Cancelled");var h=a.getSpan().firstTag("table7").nextTag("td7").nextTag("td7");x=a.getDetachedSpan((""+h.tagContents()).replace(/\| /g,"")).innerAddress(),not(x)&&(x=a.getSpan().firstTag("table7").nextTag("td7").nextTag("td7").tagContents()),d=h.previousLink(),m=d.parentAnyTag("td").tagContents().innerCapture(/(.*) </,1),u=h.nextPhoneNumber().innerCapture(n.phonePrefix,1).trim(),s=a.getSpan().innerCapture(n.confirmation,1),C=T=a.getSpan().innerCapture(n.modify,1);var y=a.getSpan().next(n.arrival).nextAnyTag("td").allInnerDates();c=combineDateAndTime(y[0],y[1]);var S=a.getSpan().next(n.departure).nextAnyTag("td").allInnerDates();return l=combineDateAndTime(S[0],S[1]),i=a.getSpan().next(n.price).nextAnyTag("td").innerCapture(/($<total>[\d,.]+)\s+($<currency>[A-Z]{3})/),o=i?i.$total:null,g=i?i.$currency:null,ASSERT(r,c,l)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r},totalPrice:o,priceCurrency:g,checkinTime:c,checkoutTime:l,modifyReservationUrl:C,cancelReservationUrl:T,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:d,telephone:u,address:x}}]:void 0}}).call();
