// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("ticketfly-cancellation-en",function(e){return/^REFUND Ticketfly Order/.test(e.subject)},function(e){if(/^REFUND Ticketfly Order/.test(e.subject)){var t="EventCancelled",n=loadHelper("ticketfly-schemaorg-parser.js"),r=n(e,t);return ASSERT(r),r}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1340/1417/1418","SG811af2f9"),new ReverseTemplate("ticketfly-confirmation-en",function(e){return/^Your Ticketfly Order/.test(e.subject)},function(e){if(/^Your Ticketfly Order/.test(e.subject)){var t="EventConfirmed",n=loadHelper("ticketfly-schemaorg-parser.js"),r=n(e,t);if(r)return r;var a=Scanner.fromMessage(e);a.setLocale("en_US");var t,o,i,s,c,p,g,d,l,u,m,T,f,h,x,k,v,S;S=a.getSpan().innerCapture(/\bYour order number is #($<ticketNumber>[\d]+) <($<ticketDownloadUrl>.*)>/),S&&(c=S.$ticketNumber,p=S.$ticketDownloadUrl),o=a.getSpan().innerText("Card #:").nextTag("table5").innerTag("td5").tagContents().innerCapture(/\b(.*)\s/,1).trim();var b=Scanner.fromMessage(e,"html");if(b=b.getSpan().nextText("event-name"),m=b.withEnd(b.getEnd()+500).innerCapture(/>(.*)</,1),T=a.getSpan().nextText("For additional venue info visit").parentTag("td3").tagContents().innerCapture(/<(.*)>/,1),f=getFuzzyDate(a.getSpan().nextText("Event Information").nextTag("table4")),k=a.getSpan().nextText("Event Information").nextTag("td4").nextTag("td4").tagContents().innerCapture(/\b(.*)\s/,1),v=k.nextAddress(),g=a.getSpan().nextText("Order Details").nextTag("table5").innerCapture(/(\d+ tickets?)/,1),i=a.getSpan().nextText("Order Details").nextText("Total").nextTag("td5").tagContents().innerCapture(/([\d,.]+)/,1),ASSERT(f,m))return[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:o,totalPrice:i,priceCurrency:s,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:c,ticketToken:p,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:d,seatRow:l,seatSection:u}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:m,url:T,startDate:f,endDate:h,location:{"@type":"http://schema.org/Place",name:k,telephone:x,address:v}}}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1340/1417/1419","SGcc2291cc"),new ReverseTemplate("ticketfly-mobile-confirmation-en",function(e){return/^Your Mobile Tickets for/.test(e.subject)},function(e){if(/^Your Mobile Tickets for/.test(e.subject)){var t="EventConfirmed",n=loadHelper("ticketfly-schemaorg-parser.js"),r=n(e,t);if(r)return r;var a=Scanner.fromMessage(e);a.setLocale("en_US");var t,o,i,s,c,p,g,d,l,u,m,T,f,h,x,k,v,S;if(S=a.getSpan().innerCapture(/\bOrder #:\s($<ticketNumber>[\d]+) <($<ticketDownloadUrl>.*)>/),S&&(c=S.$ticketNumber,p=S.$ticketDownloadUrl),o=a.getSpan().innerCapture(/\bPurchased by: ([\w ]+)/,1).trim(),m=a.getSpan().nextText("Purchased by:").nextTag("td3").tagContents(),g=m.nextTag("td3").tagContents(),f=getFuzzyDate(g.nextTag("td3")),k=g.nextTag("td4").tagContents(),v=k.nextTag("td4").tagContents(),T=v.nextTag("td4").tagContents().nextLink(),i=T.nextText("Price: ").parentTag("td4").tagContents().innerCapture(/([\d,.]+)/,1),ASSERT(f,m))return[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:o,totalPrice:i,priceCurrency:s,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:c,ticketToken:p,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:d,seatRow:l,seatSection:u}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:m,url:T,startDate:f,endDate:h,location:{"@type":"http://schema.org/Place",name:k,telephone:x,address:v}}}]}},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/1340/1417/1420","SGe635af39")]);
