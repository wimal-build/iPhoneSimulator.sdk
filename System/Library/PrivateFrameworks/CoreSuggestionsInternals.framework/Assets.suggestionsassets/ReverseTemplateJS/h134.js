// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){function a(){ASSERT(v.airlineCode,v.flightNumber,v.departureDate,v.arrivalDate,v.departureAirport,v.arrivalAirport)&&(C.push(v),v={})}function n(e){return(""+e.trim()).replace(/\n/g," ").replace(/\s+/g," ")}e.plain=e.plain.replace(RegExp(String.fromCharCode("0x200b"),"g"),"");var i=Scanner.fromMessage(e);i.setLocale(t);{var g,o,p,l,d,s,m,u,x,h,C=[],c=i.getSpan().nextText(r.reservationCodePrefix).parentTag("td2").tagContents().innerCapture(regExpFormatted(/\1\n(\w+)/,r.reservationCodePrefix),1).trim(),T=i.getSpan().next(r.passengerNamePrefix).nextTag("td5").tagContents().trim();i.getSpan().nextText(r.ticketNumberPrefix).nextTag("td5").tagContents().innerCapture(/(.*)</,1).trim()}g=i.getSpan().next(r.passengerNamePrefix).withEnd(i.getSpan().next(r.baggageRegulations).getStart()).allInnerTags("table1");for(var v={},f=0;g.length>f;f++){var N=g[f];p=N.innerText(r.reservationColumnHeader).nextTag("td1"),o=p.nextTag("td1").tagContents().innerCapture(regExpFormatted(/($<airlineCode>\w{2}) ($<flightNumber>\d+)\n\1\n($<airlineName>.+)/,r.operatedByPrefix)),v.airlineCode=o.$airlineCode.trim(),v.flightNumber=o.$flightNumber.trim(),v.airlineName=o.$airlineName.trim(),s=p.nextTag("td1").nextTag("td1").tagContents().allDates(),l=s[0],0===s.length?(l=p.nextTag("td1").nextTag("td1").tagContents(),d=l):d=s.length>1?s[1]:s[0],x=p.nextTag("td1").nextTag("td1").nextTag("td1").tagContents(),h=x.nextTag("td1").tagContents(),m=h.nextTag("td1").tagContents(),u=m.nextTag("td1").tagContents(),v.seatNumber=""+u.nextTag("td1").tagContents().innerCapture(regExpFormatted(/\1:(.*)/,r.seatPrefix),1).trim(),v.departureDate=i.getDetachedSpan((""+l).replace(".","")+" "+m).innerDate(),v.arrivalDate=i.getDetachedSpan((""+d).replace(".","")+" "+u).innerDate(),v.departureAirport=n(x),v.arrivalAirport=n(h),a()}for(var S=[],b=0;C.length>b;b++){var D=C[b];S.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:D.airlineName,airlineCode:D.airlineCode,flightNumber:D.flightNumber,departureAirportFuzzy:D.departureAirport,departureTime:D.departureDate,arrivalAirportFuzzy:D.arrivalAirport,arrivalTime:D.arrivalDate},underName:{"@type":"http://schema.org/Person",name:T},reservationId:c,reservationStatus:"http://schema.org/ReservationConfirmed",reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:D.seatNumber}}})}return S}}).call();