// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,a,r){if(!(e&&t&&a&&r))return CONTINUE;var n=loadHelper("opentable.com-microdata-parser.js"),p=n(e);if(p)return p;var o=Scanner.fromMessage(e);o.setLocale(t);var s,i,g,l,m,c,d,u,h,S,C,E;if(s=o.getSpan().innerCapture(regExpFormatted(/\b\1\s?(.*),/,a.hello),1),s.exists()||(s=o.getSpan().innerCapture(regExpFormatted(/(.+?)\s*\1/,a.hello),1)),i=o.getSpan().innerCapture(regExpFormatted(/\1: (\d+)/,a.number),1),l=o.getSpan().innerCapture(a.person,1),E=o.getSpan().next(a.cancel).collapseToEnd().withEnd(o.getSpan().next(a.cancel).nextText(a.number).getStart()).trim(),a.nameCapture&&(g=o.getSpan().innerCapture(a.nameCapture,1)),(a.nameCapture&&!g.exists()||!a.nameCapture)&&(g=E.innerCapture(regExpFormatted(/^(.+)/),1)),a.dateCapture){var v=o.getSpan().innerCapture(a.dateCapture),x=v.$year+"-"+v.$month+"-"+v.$day+" "+v.$time;c=getFuzzyDate(o.getDetachedSpan(x))}else d=E.allInnerDates(),d.length>0&&(d=o.getSpan().withStart(d[0].getStart()).withEnd(d[d.length-1].getEnd()),c=getFuzzyDate(o.getDetachedSpan((""+d).replace(/[^\d\sa-zA-z:]+/g,"").replace(/\s+/g," ").replace(/^(\d+)\s(\d+)\s/,"$1/$2/"))));return ASSERT(l,g,c,s)?[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:l,reservationId:i,reservationStatus:"http://schema.org/ReservationCancelled",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:g,url:m,telephone:u,address:h},startTime:c,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www."+r+"/"},underName:{"@type":"http://schema.org/Person",name:s},cancelReservationUrl:C,modifyReservationUrl:S}]:CONTINUE}}).call();
