// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t,a){if(int(e.epoch)<=1443052800)return CONTINUE;var n=Scanner.fromMessage(e);n.setLocale(r);var i,o,p,s,m,g,l=n.getSpan(),u=[],c=[];i=(""+l.innerCapture(regExpFormatted(/\1 (.*)/,t.reservationId_prefix),1)).trim(),p=l.next(t.price_prefix).nextAnyTag("td").tagContents(),o=l.next(t.price_prefix).nextAnyTag("td").nextAnyTag("td").tagContents(),s=l.next(t.checkinUrl_prefix).nextLink();var d=l.allInnerTags("tr4").filter(function(e,r){var t=""+e.tagContents();return 0!==t.length&&(t.indexOf("Depart ")>-1||t.indexOf("Arrive in")>-1)});return d.forEach(function(e,r){var a,i,o,p,s,c,d,h,v,f,C,N,T="Southwest Airlines",x="WN";e=e.allInnerTags("td4"),""+e[0].tagContents()!=""&&(m=g=e[0].tagContents()),a=e[1].tagContents();var A;A=e[e.length-1],i=/(?:Depart|Change planes.*in)\s(.*)\s\((.*)\).*at\s(.*)/.exec(""+A),s=i[1],c=i[2],o=i[3],d=/Arrive in\s(.*)\s\((.*)\)\s.*at\s(.*)\s\s\n/.exec(""+A),f=d[1],C=d[2],h=d[3],p=getFuzzyDate(n.getDetachedSpan(m+" "+o).firstDate()),v=getFuzzyDate(n.getDetachedSpan(g+" "+h).firstDate()),N=l.next(t.passengers_prefix).parentTag("table3").allInnerTags("tr4").filter(function(e,r){var t=e.allInnerTags("td4");return!(5!==t.length||!/^[0-9]*$/.exec((""+t[2].tagContents()).trim()))}),N.forEach(function(e,r){var t,n,i,o="Rapid Rewards";e=e.allInnerTags("td4"),t=e[0].tagContents(),n=e[2].tagContents(),i=(""+e[1].tagContents()).trim(),/^[0-9]*$/.exec(i)||(i=null),u.push({airlineName:T,airlineCode:x,flightNumber:a,departureDateTime:p,departureAirport:s,departureAirportCode:c,arrivalDateTime:v,arrivalAirport:f,arrivalAirportCode:C,ticketNumber:n,underPersonName:t,programName:o,membershipNumber:i})})}),u.forEach(function(e,r){ASSERT(e.departureDateTime,e.arrivalDateTime,e.departureAirportCode,e.arrivalAirportCode),c.push({"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:e.airlineName,airlineCode:e.airlineCode,flightNumber:e.flightNumber,departureAirportFuzzy:e.departureAirport,departureAirportCode:e.departureAirportCode,departureTime:e.departureDateTime,arrivalAirportFuzzy:e.arrivalAirport,arrivalAirportCode:e.arrivalAirportCode,arrivalTime:e.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:e.underPersonName},checkinUrl:s,reservationId:i,reservationStatus:"http://schema.org/Reservation"+a,totalPrice:o,priceCurrency:p,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:e.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:e.seatNumber,seatingType:e.seatType}},programMembershipUsed:{"@type":"http://schema.org/ProgramMembership",membershipNumber:e.membershipNumber,programName:e.programName}})}),c.length>=1?c:CONTINUE}}).call();
