// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,s,g,p,c,m,u,C,l,x,d,f;if(!n.emailTitelConfirmation.test(e.subject)&&!n.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;g=a.getSpan().nextRegExp(n.reservationId).nextAnyTag("td").tagContents(),r=a.getSpan().nextRegExp(n.guestName).nextAnyTag("td").tagContents().innerCapture(/.+\n(.+)/,1),i=a.getSpan().nextRegExp(n.guestEmail).nextAnyTag("td").tagContents().innerCapture(/(.+)/,1);var h=a.getSpan().nextRegExp(n.dates).nextAnyTag("td").tagContents();c=h.innerDate(),m=h.lastInnerDate();var T=a.getSpan().nextRegExp(n.price).tagContents().innerCapture(n.price,1);o=T.innerCapture(/([\d,.]+)/,1),s=T.innerCapture(/([^\d,.]+)/,1).trim();var E=a.getSpan().nextTag("td1").tagContents();if(C=E.innerCapture(regExpFormatted(/(.+)</),1),x=E.innerAddress(),l=a.getSpan().nextRegExp(n.hotelInfo).nextPhoneNumber(),u=a.getSpan().nextRegExp(n.hotelInfo).nextLink().nextLink(),n.emailTitelConfirmation.test(e.subject)){if(!ASSERT(r,g,c,m,x))return CONTINUE;p="Confirmed"}if(n.emailTitelCancelConfirmation.test(e.subject)){var T=a.getSpan().nextRegExp(n.cancelPrice).nextAnyTag("th").tagContents();if(o=T.innerCapture(/([\d,.]+)/,1),s=T.innerCapture(/([^\d,.]+)/,1).trim(),!ASSERT(r,g,c,m,x))return CONTINUE;p="Cancelled"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:o,priceCurrency:s,checkinTime:c,checkoutTime:m,modifyReservationUrl:d,cancelReservationUrl:f,reservationStatus:"http://schema.org/Reservation"+(p||"Confirmed"),reservationId:g,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:C,url:u,telephone:l,address:x}}]}}).call();
