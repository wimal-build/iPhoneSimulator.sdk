// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("zipcar.com-important-change-en",function(e){return/^Important change to your Zipcar reservation/.test(e.subject)},function(e){if(!/^Important change to your Zipcar reservation/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var r,n,a,i,o,s,p,c,h,d,g,m,l,v,u,S,f,C,T,y,R=/\b(?:The|These|This) Zip(?:cars?|vans?) (?:are|is) (?:located|parked) (?:in (?:a|the)|in|at|on) ([\s\S]*?)\./;return r=t.getSpan().innerCapture(/\bHi (.*),/,1),h=t.getSpan().innerCapture(/\bYour new reservation is for\s+(.*?) at/,1),m=t.getSpan(),valid(m)&&(n=m.allDates(),1===n.length?(y=t.getDateDD(n[0]).iso8601,S=t.getDateDD(n[0]).endIso8601):n.length>1&&(y=n[0],S=n[n.length-1]),m.innerAddress().exists()?(C=m.innerAddress(),f=m.innerCapture(R,1)):C=m.innerCapture(R,1),valid(S)&&(v=C,l=f)),ASSERT(r,h,C,y)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:p,priceCurrency:c,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",checkinUrl:i,modifyReservationUrl:o,cancelReservationUrl:s,underName:{"@type":"http://schema.org/Person",name:r},provider:{"@type":"http://schema.org/Organization",name:"Zipcar"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:h},license:d,color:g},pickupTime:y,pickupLocation:{"@type":"http://schema.org/Place",name:f,telephone:T,address:C},dropoffTime:S,dropoffLocation:{"@type":"http://schema.org/Place",name:l,telephone:u,address:v}}]:void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/10/238/239","SG51744501"),new ReverseTemplate("zipcar.com-reservation-reminder-en",function(e){return/^ZIPCAR:\s+You\s+reserved/.test(e.subject)},function(e){if(!/^ZIPCAR:\s+You\s+reserved/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);if(t.setLocale("en_US"),!t.getSpan().nextText("Thanks for reserving").exists())return CONTINUE;var r,n,a,i,o,s,p,c,h,d,g,m,l,v,u,S,f,C,T,y,R,x=/(?:\b(?:The|These|This) Zip(?:cars?|vans?) (?:are|is) (?:located|parked) (?:in (?:a|the)|in|at|on) ([\s\S]*?)\.|Need to change or cancel)/;return r=t.getSpan().innerCapture(/\bHi (.*),/,1),o=t.getSpan().next(/(?:View|check out) your reservation confirmation/).nextLink(),o&&(a=o.innerCapture(/reservation_id=(\d+)/,1)),m=t.getSpan().innerCapture(/you .+ reservation with ($<brand>.*?)(?: \(($<license>\w+)\))? on ($<date>.*)\./),m&&(h=m.$brand,d=m.$license,R=m.$date,m=t.getSpan().withInterval(t.getSpan().nextRegExp(/(\bYou've got a trip coming up!|This is a reminder)/).getStart(),t.getSpan().nextRegExp(x).getEnd())),C=t.getSpan().innerCapture(/Location: (.*)/,1),valid(m)&&(n=m.allDates(),1===n.length?(y=t.getDateDD(n[0]).iso8601,S=t.getDateDD(n[0]).endIso8601):n.length>1&&(y=n[0],S=n[n.length-1]),C.exists()?C.innerAddress().exists()&&(C=C.innerAddress()):m.innerAddress().exists()?(C=m.innerAddress(),f=m.innerCapture(x,1)):C=m.innerCapture(x,1),valid(S)&&(v=C,l=f)),ASSERT(r,a,h,C,y)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:p,priceCurrency:c,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",checkinUrl:i,modifyReservationUrl:o,cancelReservationUrl:s,underName:{"@type":"http://schema.org/Person",name:r},provider:{"@type":"http://schema.org/Organization",name:"Zipcar"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:h},license:d,color:g},pickupTime:y,pickupLocation:{"@type":"http://schema.org/Place",name:f,telephone:T,address:C},dropoffTime:S,dropoffLocation:{"@type":"http://schema.org/Place",name:l,telephone:u,address:v}}]:void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/10/238/240","SG92061331"),new ReverseTemplate("zipcar.com-upcoming-reservation-en",function(e){return/^ZIPCAR: /.test(e.subject)},function(e){if(!/^ZIPCAR: /.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);if(t.setLocale("en_US"),!t.getSpan().nextText("To see your reservation confirmation visit").exists())return CONTINUE;var r,n,a,i,o,s,p,c,h,d,g,m,l,v,u,S,f,C,T,y,R=/\b(?:The|These|This) Zip(?:cars?|vans?) (?:are|is) (?:located|parked) (?:in (?:a|the)|in|at|on) ([\s\S]*?)\./;return r=t.getSpan().innerCapture(/\b(?:Hi|Hello) (.*),/,1),o=t.getSpan().nextText("To see your reservation confirmation visit").nextLink(),o&&(a=o.innerCapture(/reservation_id=(\d+)/,1)),m=t.getSpan().innerCapture(/\bZip(?:van|car) reservation on ($<brand>.*) from (?:.*) from ($<date>.*)\./),m&&(h=m.$brand,m=t.getSpan().withInterval(t.getSpan().nextRegExp(/\bThis(?: email)? is a reminder/).getStart(),t.getSpan().nextRegExp(R).getEnd())),valid(m)&&(n=m.allDates(),1===n.length?(y=t.getDateDD(n[0]).iso8601,S=t.getDateDD(n[0]).endIso8601):n.length>1&&(y=n[0],S=n[n.length-1],t.getDateDD(S).endIso8601.length&&(S=t.getDateDD(S).endIso8601)),m.innerAddress().exists()?(C=m.innerAddress(),f=m.innerCapture(R,1)):C=m.innerCapture(R,1),valid(S)&&(v=C,l=f)),ASSERT(r,a,h,C,y)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:p,priceCurrency:c,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",checkinUrl:i,modifyReservationUrl:o,cancelReservationUrl:s,underName:{"@type":"http://schema.org/Person",name:r},provider:{"@type":"http://schema.org/Organization",name:"Zipcar"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:h},license:d,color:g},pickupTime:y,pickupLocation:{"@type":"http://schema.org/Place",name:f,telephone:T,address:C},dropoffTime:S,dropoffLocation:{"@type":"http://schema.org/Place",name:l,telephone:u,address:v}}]:void 0},"0/1/2/3/4/5/6/5/7/7/7/7/4/8/9/10/238/241","SGce9c411a")]);
