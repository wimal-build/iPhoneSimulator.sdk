// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("ticketmaster.com-1",function(e){return/^Your/.test(e.subject)||/^Event Reminder/.test(e.subject)?!0:void 0},function(e){if(/ticketmaster\.ca/.test(e.plain)||/^Your Ticketmaster Order for/.test(e.subject))return CONTINUE;if(/your ticket/i.test(e.subject)||/^Event Reminder/.test(e.subject)){var t=Scanner.fromMessage(e);t.setLocale("en_US");var r,n,a,s,i,c,o,u,p,m,l,d,S,k,T,v,f;if(startsWith(e.subject,"Event Reminder"))r=t.getSpan().innerCapture(/Hi (.*?)[.,]/,1),l=r.nextLink(),m=l.parentAnyTag("td").tagContents().innerCapture(/\b(.*) <.*?>/,1),d=t.getSpan().nextText("When:").nextDate(),not(d)&&(d=getFuzzyDate(m.nextTag("table3"))),f=t.getSpan().nextText("Where:").nextTag("td7").tagContents().innerCapture(/\b($<place>.*) <(?:.*)>\s($<address>[\s\S]+?)</),f&&(T=f.$place,v=d.nextAddress(),(""+v).length<(""+f.$address.trim()).length&&(v=f.$address.trim())),not(v)&&(v=m.nextTag("table3").nextTag("table3").innerAddress(),T=v.parentTag("td3").tagContents().innerCapture(/\b(.*) <.*?>/,1)),i=t.getSpan().nextText("View Your Tickets").nextLink();else if(startsWith(e.subject,"Your Ticketmaster Order")){s=t.getSpan().innerCapture(/Your order number for this purchase is (.*?)\./,1);var g=["PRINT YOUR TICKETS","Print my tickets"];for(var h in g)if(t.getSpan().nextText(g[h]).exists()){i=t.getSpan().innerCapture(RegExp(regExpEscape(g[h])+" <(.*)>"),1);break}i||(i=t.getSpan().innerCapture(/Show complete order detail <(.*)>/,1)),d=t.getSpan().nextRegExp(/You purchased (.*) to:/).nextDate();var b=RegExp("You purchased ($<numSeats>.*) to:(?:[\\s_]+)\\b($<eventName>.*)\\s\\b($<address>.*)\\s(?:[\\s\\S]+)\\bOrder for: ($<name>.*)\\s\\bSeat location:(?: section ($<seatSection>.*?),?)?(?: row ($<seatRow>.*?),?)?(?: seats ($<seat>.*?))?\\s\\bTotal Charge: ($<priceCurrency>\\w+)?(.*?)($<price>[\\d.,]+)\\s");f=t.getSpan().innerCapture(b),f&&(c=f.$numSeats,m=f.$eventName,v=f.$address,r=f.$name,p=f.$seatSection,u=f.$seatRow,o=f.$seat,n=f.$price,a=f.$priceCurrency)}else{if(!startsWith(e.subject,"Your tickets have been printed!"))return CONTINUE;r=t.getSpan().innerCapture(/Hello (\w+),/,1),s=t.getSpan().innerCapture(/Order Number: (.*)\s/,1),d=s.nextDate(),v=d.nextAddress(),f=d.super(v),f=f.innerCapture(/\b($<eventName>.*) <($<eventUrl>.*)>/),f&&(m=f.$eventName,l=f.$eventUrl)}if(ASSERT(d,m))return[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:r,totalPrice:n,priceCurrency:a,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s,ticketToken:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:o,seatRow:u,seatSection:p}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:m,url:l,startDate:d,endDate:S,location:{"@type":"http://schema.org/Place",name:T,telephone:k,address:v}}}]}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/779/827/831","SGa43ce21a"),new ReverseTemplate("ticketmaster.com-confirmation-en_CA",function(e){return/^Your Ticketmaster Order/.test(e.subject)},function(e){if(/^Your Ticketmaster Order for/.test(e.subject)&&/ticketmaster\.ca/.test(e.plain)){var t={};t.thanks="Thanks",t.total="Total Charges",t.section="Section",t.seatRow="Row",t.seatNumber="Seat",t.order="Order #",t.print="Print now";var r="en_CA",n=loadHelper("ticketmaster.com-en_CA-confirmation-skeleton.js");return n(e,r,t)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/779/827/833","SG8449dfb7"),new ReverseTemplate("ticketmaster.com-confirmation-en_US",function(){},function(e){if(/^Your Ticketmaster Order for/.test(e.subject)&&!/ticketmaster\.ca/.test(e.plain)){var t={};t.thanks="Thanks",t.total="Total Charges",t.section="Section",t.seatRow="Row",t.seatNumber="Seat",t.order="Order #",t.print="Print now";var r="en_US",n=loadHelper("ticketmaster.com-en_CA-confirmation-skeleton.js");return n(e,r,t)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/779/827/834","SG5124f356"),new ReverseTemplate("ticketmaster.com-invite-cancellation-en_US",function(e){return/canceled your Ticket Transfer Invite/.test(e.subject)},function(e){if(!/canceled your Ticket Transfer Invite/.test(e.subject))return CONTINUE;var t={};t.hi="Hi",t.seat="Seat",t.accept='Please click "Accept Tickets"';var r="en_US",n=loadHelper("ticketmaster.com-en_US-invite-cancellation-skeleton.js");return n(e,r,t)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/779/827/835","SG5a32e6c1"),new ReverseTemplate("ticketmaster.com-invite-en_US",function(e){return/sent you tickets for/.test(e.subject)},function(e){if(!/sent you tickets for/.test(e.subject))return CONTINUE;var t={};t.hi="Hi",t.seat="Seat",t.accept='Please click "Accept Tickets"';var r="en_US",n=loadHelper("ticketmaster.com-en_US-invite-skeleton.js");return n(e,r,t)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/779/827/836","SG5e16719a")]);