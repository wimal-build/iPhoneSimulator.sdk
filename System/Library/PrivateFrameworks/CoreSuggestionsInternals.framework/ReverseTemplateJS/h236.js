// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n,r){var a=loadHelper("opentable.com-microdata-parser.js"),o=a(e);if(o)return o;if(!(e&&t&&n&&r))return CONTINUE;var s=Scanner.fromMessage(e);s.setLocale(t);var i,p,d,g,x,m,l,h,c,S,u,E,T,v,f;return i=s.getSpan().innerCapture(regExpFormatted(/\1.*\n(.*?)(\2)?\n/m,n.infos,n.hello),1).trim(),i.exists()||(i=s.getSpan().innerCapture(regExpFormatted(/(.*) \(.*\) \1/,n.hello),1)),p=s.getSpan().innerCapture(regExpFormatted(/\1(:|\uff1a) (\d+)/,n.number),2),S=s.getSpan().nextText(n.address+":"),S.exists()||(S=s.getSpan().nextText(n.addressAlt+"\uff1a")),S=S.collapseToEnd().withEnd(s.getSpan().nextText(n.description).getStart()).trim(),c=not(S.innerAddress())?S.innerCapture(/^.*\r?\n(.*)/,1):S.innerAddress(),h=not(S.innerPhoneNumber())?S.innerCapture(/(\d{11})/,1):S.innerPhoneNumber(),d=s.getDetachedSpan(e.subject).innerCapture(regExpFormatted(/\1 (.*)/,n.reservation),1),d.exists()||(d=s.getDetachedSpan(e.subject).innerCapture(regExpFormatted(/(.*)(\1|\2)/,n.reservation,n.reservationAlt),1).trim()),T=s.getSpan().nextText(n.infos).nextText(n.person),g=s.getSpan().withStart(T.previousText("\n").getEnd()).withEnd(T.nextText("\n").getStart()).innerCapture(regExpFormatted(/(\d+)/),1),v=s.getSpan().nextText(n.infos).collapseToEnd().withEnd(s.getSpan().nextText(n.infos).nextText(n.number).getStart()).trim(),f=v.allInnerDates(),f=s.getSpan().withStart(f[0].getStart()).withEnd(f[f.length-1].getEnd()),l=getFuzzyDate(s.getDetachedSpan((""+f).replace(/[^\d\sa-zA-z:]+/g,"").replace(/\s+/g," ").replace(/^(\d+)\s(\d+)\s/,"$1/$2/"))),u=s.getSpan().nextText(n.modify).nextLink(),E=s.getSpan().nextText(n.cancel).nextLink(),ASSERT(g,d,l,i)?[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:g,reservationId:p,reservationStatus:"http://schema.org/Reservation"+(m||"Confirmed"),reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:d,url:x,telephone:h,address:c},startTime:l,bookingAgent:{"@type":"http://schema.org/Organization",name:"OpenTable",url:"http://www."+r+"/"},underName:{"@type":"http://schema.org/Person",name:i},cancelReservationUrl:E,modifyReservationUrl:u}]:CONTINUE}}).call();