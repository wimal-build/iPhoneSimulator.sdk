// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("ticketweb.com-confirmation-en",function(e){return/^Order Confirmation/.test(e.subject)},function(e){if(/^Order Confirmation/.test(e.subject)){var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,n,s,i,c,o,p,m,d=[];for(r=a.getSpan().innerCapture(/\bName: (.*)\s/,1),n=a.getSpan().innerCapture(/\bOrder Number: (.*?)\s/,1),m=a.getSpan().nextText("Order Summary");m.nextText("Delivery Type:").exists();)s={},m=m.nextText("Delivery Type:"),p=m.previousTag("td3").tagContents(),s.eventName=p.innerCapture(/\b(.*)\n/,1).trim(),s.startDate=p.innerDate(),valid(s.eventName,s.startDate)&&(s.name=r,s.ticketNumber=n,s.address=p.innerAddress(),s.address.exists()&&(i=a.getAddressDD(s.address).text,c=p.innerCapture(RegExp("\\b($<place>.*?), ($<address>.*(?:"+regExpEscape(i)+").*)")),c&&(s.place=c.$place,o=c.$address.trim(),(""+o).length>i.length&&(s.address=o))),s.numSeats=p.nextText("Delivery Type:").nextTag("td2").tagContents(),s.price=s.numSeats.nextTag("td2").nextTag("td2").tagContents().innerCapture(/([\d,.]+)/,1),ASSERT(s.name,s.eventName,s.startDate,s.ticketNumber,s.address)&&d.push(s));if(1==d.length&&(d[0].price=a.getSpan().nextText("Total Charges:").nextTag("td2").tagContents().trim().innerCapture(/([\d.,]+)$/,1)),d.length){for(var u=[],g=0;t=d[g++];)u.push({"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:t.name,totalPrice:t.price,priceCurrency:t.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:t.ticketNumber,ticketToken:t.ticketDownloadUrl,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:t.seat,seatRow:t.seatRow,seatSection:t.seatSection}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:t.eventName,url:t.eventUrl,startDate:t.startDate,endDate:t.endDate,location:{"@type":"http://schema.org/Place",name:t.place,telephone:t.phoneNumber,address:t.address}}});return u}}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/778/779","SGd747d1f7"),new ReverseTemplate("ticketweb.com-ticket-update-en",function(e){return/^An important update regarding/.test(e.subject)},function(e){if(/^An important update regarding/.test(e.subject)){var a=Scanner.fromMessage(e);a.setLocale("en_US");var r,n,s,i=[];if(r={},s=/\b($<eventName>.*)\s+at ($<place>.*)\s+on/,n=a.getSpan().innerCapture(s),n&&(r.eventName=n.$eventName,r.place=n.$place),r.startDate=a.getSpan().firstDate(),r.ticketNumber=a.getSpan().innerCapture(/Confirmation #:\s+(.*)\s+/,1),ASSERT(r.eventName,r.startDate)&&i.push(r),i.length){for(var c=[],o=0;t=i[o++];)c.push({"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:t.name,totalPrice:t.price,priceCurrency:t.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:t.ticketNumber,ticketToken:t.ticketDownloadUrl,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:t.seat,seatRow:t.seatRow,seatSection:t.seatSection}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:t.eventName,url:t.eventUrl,startDate:t.startDate,endDate:t.endDate,location:{"@type":"http://schema.org/Place",name:t.place,telephone:t.phoneNumber,address:t.address}}});return c}}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/778/781","SG64839520")]);