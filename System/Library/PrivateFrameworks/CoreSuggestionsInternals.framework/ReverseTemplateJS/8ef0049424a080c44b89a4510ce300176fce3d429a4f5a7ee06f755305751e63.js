// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("ticketmaster.com-1",function(){return!0},function(e){if(/ticketmaster\.ca/.test(e.plain))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,r,a,s,i,c,o,p,u,m,l,d,S,T,g,v,k;if(startsWith(e.subject,"Event Reminder"))n=t.getSpan().innerCapture(/Hi (.*?)[.,]/,1),l=n.nextLink(),m=l.parentAnyTag("td").tagContents().innerCapture(/\b(.*) <.*?>/,1),d=t.getSpan().nextText("When:").nextDate(),not(d)&&(d=getFuzzyDate(m.nextTag("table3"))),k=t.getSpan().nextText("Where:").nextTag("td7").tagContents().innerCapture(/\b($<place>.*) <(?:.*)>\s($<address>[\s\S]+?)</),k&&(g=k.$place,v=d.nextAddress(),(""+v).length<(""+k.$address.trim()).length&&(v=k.$address.trim())),not(v)&&(v=m.nextTag("table3").nextTag("table3").innerAddress(),g=v.parentTag("td3").tagContents().innerCapture(/\b(.*) <.*?>/,1)),i=t.getSpan().nextText("View Your Tickets").nextLink();else if(startsWith(e.subject,"Your Ticketmaster Order")){s=t.getSpan().innerCapture(/Your order number for this purchase is (.*?)\./,1);var h=["PRINT YOUR TICKETS","Print my tickets"];for(var C in h)if(t.getSpan().nextText(h[C]).exists()){i=t.getSpan().innerCapture(RegExp(regExpEscape(h[C])+" <(.*)>"),1);break}i||(i=t.getSpan().innerCapture(/Show complete order detail <(.*)>/,1)),d=t.getSpan().nextRegExp(/You purchased (.*) to:/).nextDate();var b=RegExp("You purchased ($<numSeats>.*) to:(?:[\\s_]+)\\b($<eventName>.*)\\s\\b($<address>.*)\\s(?:[\\s\\S]+)\\bOrder for: ($<name>.*)\\s\\bSeat location:(?: section ($<seatSection>.*?),?)?(?: row ($<seatRow>.*?),?)?(?: seats ($<seat>.*?))?\\s\\bTotal Charge: ($<priceCurrency>\\w+)?(.*?)($<price>[\\d.,]+)\\s");k=t.getSpan().innerCapture(b),k&&(c=k.$numSeats,m=k.$eventName,v=k.$address,n=k.$name,u=k.$seatSection,p=k.$seatRow,o=k.$seat,r=k.$price,a=k.$priceCurrency)}else{if(!startsWith(e.subject,"Your tickets have been printed!"))return CONTINUE;n=t.getSpan().innerCapture(/Hello (\w+),/,1),s=t.getSpan().innerCapture(/Order Number: (.*)\s/,1),d=s.nextDate(),v=d.nextAddress(),k=d.super(v),k=k.innerCapture(/\b($<eventName>.*) <($<eventUrl>.*)>/),k&&(m=k.$eventName,l=k.$eventUrl)}return ASSERT(d,m)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:n,totalPrice:r,priceCurrency:a,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s,ticketToken:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:o,seatRow:p,seatSection:u}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:m,url:l,startDate:d,endDate:S,location:{"@type":"http://schema.org/Place",name:g,telephone:T,address:v}}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/760/763","SGa43ce21a"),new ReverseTemplate("ticketmaster.com-confirmation-en_CA",function(e){return/^Your Ticketmaster Order/.test(e.subject)},function(e){if(!/^Your Ticketmaster Order/.test(e.subject))return CONTINUE;var t={};t.thanks="Thanks",t.total="Total Charges",t.section="Section",t.order="Order #",t.print="Print now";var n="en_CA",r=loadHelper("ticketmaster.com-en_CA-confirmation-skeleton.js");return r(e,n,t)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/760/765","SG8449dfb7"),new ReverseTemplate("ticketmaster.com-invite-cancellation-en_US",function(e){return/canceled your Ticket Transfer Invite/.test(e.subject)},function(e){if(!/canceled your Ticket Transfer Invite/.test(e.subject))return CONTINUE;var t={};t.hi="Hi",t.seat="Seat",t.accept='Please click "Accept Tickets"';var n="en_US",r=loadHelper("ticketmaster.com-en_US-invite-cancellation-skeleton.js");return r(e,n,t)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/760/766","SG5a32e6c1"),new ReverseTemplate("ticketmaster.com-invite-en_US",function(e){return/sent you tickets for/.test(e.subject)},function(e){if(!/sent you tickets for/.test(e.subject))return CONTINUE;var t={};t.hi="Hi",t.seat="Seat",t.accept='Please click "Accept Tickets"';var n="en_US",r=loadHelper("ticketmaster.com-en_US-invite-skeleton.js");return r(e,n,t)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/760/767","SG5e16719a")]);