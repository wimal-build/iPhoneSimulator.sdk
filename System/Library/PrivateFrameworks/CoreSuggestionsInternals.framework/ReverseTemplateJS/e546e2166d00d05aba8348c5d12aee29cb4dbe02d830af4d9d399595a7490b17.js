// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("airbnb.com-billing-receipt-en",function(e){return/^Billing receipt for reservation/.test(e.subject)},function(e){if(!/^Billing receipt for reservation/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,i,o,s,g,p,c,d,u,m,x,T,C,l;if(x=t.getSpan().innerCapture(/View Itinerary <(.*)>/,1),l=t.getSpan().nextText("Accommodation Address").previousTag("td7").tagContents(),p=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),n=t.getSpan().nextRegExp(/\[td7\] Names? \[\/td7\]/).previousTag("td7").tagContents(),d=getFuzzyDate(t.getSpan().nextText("Check In").parentTag("table7")),m=getFuzzyDate(t.getSpan().nextText("Check Out").parentTag("table7")),T=t.getSpan().nextRegExp(/\[td7\] Property \[\/td7\]/).previousTag("td7").tagContents(),o=t.getSpan().nextText("Accommodations").parentTag("table6"),s=o.innerText("Total").exists()?"Total":"Accommodations",o=o.innerText(s).nextTag("td6").tagContents().innerCapture(/($<price>[\d,.]+)\s?($<currency>[a-zA-Z]{3})?/),o&&(i=o.$price,g=o.$currency),int(e.epoch)>=1405397228){p=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),n=t.getSpan().nextRegExp(/Guests/).nextAnyTag("td").tagContents().innerCapture(/(.+)\,/,1),l=t.getSpan().nextRegExp(/Accommodation Address/).nextAnyTag("td").tagContents(),T=t.getSpan().nextRegExp(/Travel Property/).nextAnyTag("td").tagContents();var c=t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").tagContents();c=c+" "+t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").nextAnyTag("td").tagContents(),d=getFuzzyDate(t.getDetachedSpan(c));var u=t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").tagContents();u=u+" "+t.getSpan().nextRegExp(/Check Out/).nextAnyTag("td").nextAnyTag("td").tagContents(),m=getFuzzyDate(t.getDetachedSpan(u)),r=t.getSpan().nextRegExp(/Total/).nextAnyTag("td").tagContents(),i=r.innerCapture(/([\d,.]+)/,1),g=r.innerCapture(/([^\d,.]+)/,1).trim()}return ASSERT(d,m,l)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:n,email:a},totalPrice:i,priceCurrency:g,checkinTime:d,checkoutTime:m,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:T,url:x,telephone:C,address:l}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/328","SG57f9a3cf"),new ReverseTemplate("airbnb.com-confirmed-de",function(e){return/Buchung best\xe4tigt/.test(e.subject)},function(e){var t="de_DE",n={};n.emailTitelConfirmation=/Buchung best\xe4tigt/,n.guestName=/Hallo (.+)\,/,n.reservationId=/Best\xe4tigungscode\:\s+(.+)/,n.checkInDate=/Check-In/,n.checkOutDate=/Check-Out/,n.host=/Dein Gastgeber/,n.price=/Gesamtsumme/;var a=loadHelper("airbnb.com-confirmed.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/332","SG65274196"),new ReverseTemplate("airbnb.com-confirmed-zh",function(e){return/\u9884\u8ba2\u5df2\u786e\u8ba4/.test(e.subject)},function(e){var t="zh_Hans_CN",n={};n.emailTitelConfirmation=/\u9884\u8ba2\u5df2\u786e\u8ba4/,n.guestName=/(.+)\uff0c\u60a8\u597d\uff01/,n.reservationId=/\u786e\u8ba4\u7801\uff1a\s+(.+)/,n.checkInDate=/\u5165\u4f4f/,n.checkOutDate=/\u9000\u623f/,n.host=/\u60a8\u7684\u623f\u4e1c/,n.price=/\u603b\u4ef7/;var a=loadHelper("airbnb.com-confirmed.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/333","SG57841796"),new ReverseTemplate("airbnb.com-itinerary-en",function(e){return/^Reservation (?:Confirmed|Itinerary from)/.test(e.subject)},function(e){if(!/^Reservation (?:Confirmed|Itinerary from)/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,i,o,s,g,p,c,d,u,m,x,T,C,l,h,S,v;if(a=t.getSpan().innerCapture(/\s+(?:Hello|Dear|Hi there|Hi) (.*),/g,1),t.getSpan().nextText("Sent with \u2665 from Airbnb HQ").exists())s=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),x=t.getSpan().innerCapture(/View itinerary <(.*)>/,1),n=t.getSpan().nextText("Your Host").nextTag("td3").nextTag("td3").tagContents().innerCapture(/($<name>.+?)\n($<telephone>.+?)\n/),v=n?n.$telephone.trim():null,h=n?n.$name.trim():null,l=t.getSpan().nextText("Itinerary").nextAddress(),T=l.nextTag("table3").innerCapture(/\s+(.*) <(?:.*)>/,1),p=t.getSpan().nextRegExp(/CHECK IN|Check In/).nextTag("td5").tagContents(),g=p.nextTag("td5").tagContents(),c=t.getDetachedSpan(""+p+" "+g).innerDate(),u=t.getSpan().nextRegExp(/CHECK OUT|Check Out/).nextTag("td5").tagContents(),d=u.nextTag("td5").tagContents(),m=t.getDetachedSpan(""+u+" "+d).innerDate(),i="3";else{not(a)&&(a=t.getSpan().innerCapture(/\bThis itinerary has been shared with you by (.*) \(/,1)),x=t.getSpan().nextText("View Itinerary").parentTag("td4").innerCapture(/View Itinerary <(.*)>/,1),s=t.getSpan().nextText("Confirmation Code:").parentTag("table4").innerCapture(/Confirmation Code: (.*)\s/,1),p=t.getDetachedSpan(""+t.getSpan().nextText("Check In").previousTag("td6").tagContents()).allInnerDates(),c=combineDateAndTime(p[0],p[1]),u=t.getDetachedSpan(""+t.getSpan().nextText("Check Out").previousTag("td6").tagContents()).allInnerDates(),m=combineDateAndTime(u[0],u[1]),n=t.getSpan().nextText("The billing information you supplied").previousTag("table6");var b=n.allPhoneNumbers();v=[];for(var y,f=0;y=b[f++];)v.push(""+y);v=v.join("\n"),h=n.nextTag("td6").nextTag("td6").tagContents().innerCapture(/(.+?) </,1),S=n.lastInnerTag("td6").tagContents().innerCapture(/\n(.+?)$/,1),l=n.previousTag("table6").innerAddress(),n=n.previousTag("table6").allInnerTagsFiltered("td6"),n.length>=2&&(not(l)&&(l=n[1]),T=n[0].innerCapture(/(.*) <http:(?:.*)>/,1)),i="6"}if(i){var A=t.getSpan().nextText("Accommodations").parentTag("table"+i),I=A.innerText("Total").exists()?"Total":"Accommodations";A=A.innerText(I).nextTag("td"+i).tagContents().innerCapture(/($<price>[\d,.]+)\s?($<currency>[a-zA-Z]{3})?/),A&&(r=A.$price,o=A.$currency)}return ASSERT(c,m,l)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a},provider:valid(OR(h,S,v))?{"@type":"http://schema.org/Person",name:h,email:S,telephone:v}:null,totalPrice:r,priceCurrency:o,checkinTime:c,checkoutTime:m,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:T,url:x,telephone:C,address:l}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/335","SG05538bc5")]);