// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("alaskaair.com-trip-reminder-en",function(e){return/^Need Anything for Your Trip to/.test(e.subject)},function(e){if(int(e.epoch)<1356998400)return CONTINUE;var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,i,n,o,p,s,m,u,l,g,h,c=[],d={};if(/^Need Anything for Your Trip to/.test(e.subject)){if(n=r.getSpan().innerCapture(/How Can We Help You, (.*)\?/,1),not(n))return CONTINUE;d[""+n]={name:n,seats:{},seatingType:{}},t=r.getSpan().nextText("Your confirmation code is").nextTag("td7").tagContents(),o=r.getSpan().nextText("Trip Details").nextTag("table3").allInnerTags("table8").map(function(e){return e.allInnerTagsFiltered("td8")}).filter(function(e){return e.length>0});for(var v=/($<name>.*) ($<flightNumber>\d+)$/,N=/.*\(([A-Z]{3})\)/,T=0;o.length>T;T++)i=o[T],i[0].innerCapture(v)?(s=i[0].innerCapture(v),m=s.$name,p=s.$flightNumber):i[0].innerCapture(N)&&(not(l)?(l=i[0].innerCapture(N,1),u=getFuzzyDate(i[0])):(h=i[0].innerCapture(N,1),g=getFuzzyDate(i[0]),ASSERT(m,p,l,u,h,g)&&c.push({airlineName:m,flightNumber:p,departureCode:l,departureTime:u,arrivalCode:h,arrivalTime:g,passengers:d}),s=m=p=l=u=h=g=null))}for(var b=[],T=0;c.length>T;T++)for(var f=c[T],C=Object.keys(f.passengers),y=0;C.length>y;y++){var S=f.passengers[C[y]];schema={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:f.airlineName,airlineCode:f.airlineCode,flightNumber:f.flightNumber,departureAirportFuzzy:f.departureAirport,departureAirportCode:f.departureCode,departureTime:f.departureTime,arrivalAirportFuzzy:f.arrivalAirport,arrivalAirportCode:f.arrivalCode,arrivalTime:f.arrivalTime},underName:{"@type":"http://schema.org/Person",name:S.name},checkinUrl:a,reservationStatus:"http://schema.org/Reservation"+(f.reservationStatus||"Confirmed"),reservationId:valid(f.reservationId)?f.reservationId:t,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:S.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:S.seats[f.flightNumber],seatingType:S.seatingType[f.flightNumber]}},totalPrice:S.totalPrice,priceCurrency:S.priceCurrency},not(S.membershipNumber)||(schema.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:S.membershipNumber,programName:S.programName}),b.push(schema)}return b.length?b:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/127/181/185","SG15f5bd75")]);