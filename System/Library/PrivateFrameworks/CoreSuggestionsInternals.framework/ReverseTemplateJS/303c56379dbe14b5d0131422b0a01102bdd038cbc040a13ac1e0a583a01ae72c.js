// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("hawaiiairlines.com-reservation-confirmation-en",function(e){return/^Reservation Confirmation/.test(e.subject)},function(e){if(/^Reservation Confirmation/.test(e.subject)){var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,n,i,o,l,s,m,p,g,u,d,h,c,T,b,C,v,f,N,x,y,A=[],$={};a=r.getSpan().innerCapture(/Reservation Confirmation:\s+([A-Z]{6})\s+</,1),n=r.getSpan().nextText("Web Check-in <").nextLink(),o=r.getSpan().nextText("Passenger and Seating Information").nextTag("table2").allInnerTags("table3"),u=r.getSpan().nextText("TOTAL COST").parentAnyTag("td").tagContents();var S=u.innerCapture(/TOTAL COST \(([A-Z]{3})\)/,1),D=u.nextAnyTag("td").tagContents().innerCapture(/([\d,.]+)/,1);if(o.length)for(var k=o[0].allInnerTagsFiltered("td3"),F=1;o.length>F;F++){d=o[F].allInnerTags("td3");var I;if(d.length>=4&&((""+k[0]).indexOf("HawaiianMiles")>=0?(i=d[1].tagContents().innerCapture(/($<name>[^\d]+)(?:($<membershipNumber>[\d ]+))?/),I=i?i.$membershipNumber:null,i=i?i.$name.trim():null,t=d[2].tagContents()):(""+k[1]).indexOf("HawaiianMiles")>=0&&(i=d[1].tagContents(),I=d[2].tagContents(),t=d[3].tagContents()),valid(i)&&($[""+i]={name:i,seats:{},seatingType:{},programName:"Hawaiian Miles",membershipNumber:I,ticketNumber:t,totalPrice:D,priceCurrency:S},l=o[F].innerTag("table4").innerTag("tr4").allInnerTags("td4").map(function(e){return e.tagContents()}),l.length%2==0)))for(var R=0;l.length/2>R;R++)l[2*R].getLength()&&($[""+i].seats[""+l[2*R]]=l[2*R+1].tagContents())}p=r.getSpan().nextText("Flight").nextText("Date").nextText("Depart").nextText("Arrive").parentTag("table2").allInnerTags("table3").map(function(e){return e.allInnerTagsFiltered("td3")}).filter(function(e){return e.length>=5});for(var F=1;p.length>F;F++)m=p[F],h=m[0].innerCapture(/($<code>\D+)($<flightNumber>\d+)/),c=h?h.$code:null,g=h?h.$flightNumber:null,s=m[1].innerDate(),b=combineDateAndTime(s,m[2].innerDate()),N=combineDateAndTime(s,m[3].innerDate()),T=m[2].innerCapture(/($<airport>.*) \(($<code>[A-Z]{3})\)/),C=T?T.$airport:null,v=T?T.$code:null,f=m[3].innerCapture(/($<airport>.*) \(($<code>[A-Z]{3})\)[^+]+($<nextDay>\+1)?/),x=f?f.$airport:null,y=f?f.$code:null,f&&valid(f.$nextDay)&&(N=modifyDate(N,1)),ASSERT(c,g,b,v,N,y)&&A.push({airlineCode:c,flightNumber:g,departureTime:b,departureAirport:C,departureCode:v,arrivalTime:N,arrivalAirport:x,arrivalCode:y,passengers:$});for(var O=[],F=0;A.length>F;F++)for(var w=A[F],z=Object.keys(w.passengers),L=0;z.length>L;L++){var M=w.passengers[z[L]],P={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:w.airlineName,airlineCode:w.airlineCode,flightNumber:w.flightNumber,departureAirportFuzzy:w.departureAirport,departureAirportCode:w.departureCode,departureTime:w.departureTime,arrivalAirportFuzzy:w.arrivalAirport,arrivalAirportCode:w.arrivalCode,arrivalTime:w.arrivalTime},underName:{"@type":"http://schema.org/Person",name:M.name},checkinUrl:n,reservationId:a,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:M.totalPrice,priceCurrency:M.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:t,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:M.seats[""+w.airlineCode+(""+w.flightNumber)],seatingType:M.seatingType[w.flightNumber]}}};valid(M.membershipNumber,M.programName)&&(P.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:M.membershipNumber,programName:M.programName}),O.push(P)}if(O.length)return O}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/127/244/245","SG5fc144b3")]);