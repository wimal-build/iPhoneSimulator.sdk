// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,p,o,u,m,g=[],l=[],d=[];p=a.getSpan().innerCapture(regExpFormatted(/\1 : (.*)/,t.reference),1),o=a.getSpan().innerCapture(regExpFormatted(/\1: ($<totalPrice>[\d\.,]+) ($<priceCurrency>\w{3}) /,t.amount)),o&&(u=o.$totalPrice,m=o.$priceCurrency),i=a.getSpan().allInnerCapture(regExpFormatted(/\1 \d+ : (.+?) - \2 : (\d+)/,t.traveler,t.number));for(var c in i){var h=i[c],v={};v.name=h[1],v.ticketNumber=h[2],l.push(v)}n=a.getSpan().withInterval(a.getSpan().nextText(t.yourTrip).nextText("\n").nextText("\n").getEnd(),a.getSpan().nextText(t.modify).getStart()).trim(),n=n.split("\n");for(var s in n){var x,y=n[s],z={};x=y.innerDate(),z.flightNumber=y.innerCapture(regExpFormatted(/\- \1:(.*?) \-/,t.flight),1).trim(),z.departureTime=getFuzzyDate(a.getDetachedSpan(x+" "+x.nextDate())),z.arrivalTime=getFuzzyDate(a.getDetachedSpan(x+" "+x.nextDate().nextDate())),z.departureAirportFuzzy=a.getSpan().withInterval(y.nextText(t.departure+":").getEnd(),x.nextDate().getStart()).trim(),z.arrivalAirportFuzzy=a.getSpan().withInterval(y.nextText(t.arrival+":").getEnd(),x.nextDate().nextDate().getStart()).trim(),ASSERT(z.arrivalAirportFuzzy,z.departureAirportFuzzy,z.flightNumber,z.departureTime,z.arrivalTime)&&g.push(z)}for(var S=0;g.length>S;S++)for(var T=g[S],F=0;l.length>F;F++){var v=l[F],f={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"AirCorsica",airlineCode:"XK",flightNumber:T.flightNumber,departureAirportFuzzy:T.departureAirportFuzzy,departureAirportCode:T.departureAirportCode,departureTime:T.departureTime,arrivalAirportFuzzy:T.arrivalAirportFuzzy,arrivalAirportCode:T.arrivalAirportCode,arrivalTime:T.arrivalTime},underName:{"@type":"http://schema.org/Person",name:v.name},checkinUrl:"",reservationId:p,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:u,priceCurrency:m,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:v.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}};d.push(f)}return d.length?d:void 0}}).call();