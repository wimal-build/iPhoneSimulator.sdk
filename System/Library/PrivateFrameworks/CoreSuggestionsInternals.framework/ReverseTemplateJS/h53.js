// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var n,i,o,p,g,u=[],l=[],m=[];o=a.getSpan().innerCapture(regExpFormatted(/\1: (.*)/,t.reservation),1),n=a.getSpan().nextText(t.reservation).nextTag("table2").allInnerTags("tr2");for(var s=1;n.length>s;s++){var d=n[s],h={};h.name=d.innerTag("td2").tagContents(),h.ticketNumber=d.innerTag("td2").nextTag("td2").innerCapture(regExpFormatted(/(\d+) </),1),l.push(h)}i=a.getSpan().nextTag("table2").nextTag("table2").allInnerTags("table3");for(var v=1;i.length>v;v++){var c,T={},z=i[v].innerTag("tr3").allInnerTags("td3");z.length>5||(c=z[0].innerDate(),T.flightNumber=z[3].tagContents().trim(),T.departureAirportFuzzy=z[1].tagContents().innerCapture(regExpFormatted(/^(.*)\,/),1),T.arrivalAirportFuzzy=z[2].tagContents().innerCapture(regExpFormatted(/^(.*)\,/),1),T.departureTime=getFuzzyDate(a.getDetachedSpan(c+" "+z[1].innerDate())),T.arrivalTime=getFuzzyDate(a.getDetachedSpan(c+" "+z[1].innerDate().nextDate())),ASSERT(T.departureTime,T.arrivalTime,T.arrivalAirportFuzzy,T.departureAirportFuzzy),u.push(T))}for(var y=0;u.length>y;y++)for(var T=u[y],F=0;l.length>F;F++){var h=l[F],A={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Aeroflot Russian Airlines",airlineCode:"SU",flightNumber:T.flightNumber,departureAirportFuzzy:T.departureAirportFuzzy,departureAirportCode:T.departureAirportCode,departureTime:T.departureTime,arrivalAirportFuzzy:T.arrivalAirportFuzzy,arrivalAirportCode:T.arrivalAirportCode,arrivalTime:T.arrivalTime},underName:{"@type":"http://schema.org/Person",name:h.name},checkinUrl:"",reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:p,priceCurrency:g,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:h.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}};m.push(A)}return m.length?m:void 0}}).call();