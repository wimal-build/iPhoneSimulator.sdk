// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){function e(e){return(""+e.tagContents().trim()).length>0}return function(t,r,a){var n=Scanner.fromMessage(t);n.setLocale(r);for(var i,p=n.getSpan().nextText(a.pricePrefix).nextTag("td3").nextTag("td3").tagContents().innerCapture(/($<price>[\d,\. ]+)($<currency>[^\d,\.]+)/),g=p.$price.trim(),o=p.$currency.trim(),l=n.getSpan().nextText(a.reservationIdPrefix).parentTag("td3").innerCapture(RegExp(regExpEscape(a.reservationIdPrefix)+"(.+)"),1).trim(),s=n.getSpan().nextText(a.reservationIdPrefix).nextTag("table3").allInnerTags("table4"),m=[],c=0;s.length>c;c++){i=s[c];var d=i.allInnerTags("td4").filter(e),u=d[1].innerDate(),h=d[3].innerDate(),v=combineDateAndTime(u,h),T=n.getSpan().withInterval(h.parentTag("td4").tagContents().getStart(),h.getStart()).trim(),f=d[5].innerDate(),x=combineDateAndTime(u,f),S=n.getSpan().withInterval(f.parentTag("td4").tagContents().getStart(),f.getStart()).trim(),C=d[6].innerCapture(/\n($<name>.*?)\s+\(($<code>\w+)\s*($<number>\d+)\)/);if(C)var b=C.$name,y=C.$code,I=C.$number;ASSERT(b,y,I,v,T,x,S)&&m.push({departureDateTime:v,departureAirport:T,arrivalDateTime:x,arrivalAirport:S,airlineName:b,airlineCode:y,flightNumber:I})}var $=n.getSpan().nextText(a.passengerHeader).parentTag("table3").allInnerTags("tr3");$.splice(0,1);for(var A=[],D=0;$.length>c;c++){var N=$[D].allInnerTags("td3");if(0===N.filter(e).length)break;A.push(N[0].tagContents())}var z,F,P,k=[];for(c=0;m.length>c;c++)for(F=m[c],D=0;A.length>D;D++)P=A[D],z={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:F.airlineName,airlineCode:F.airlineCode,flightNumber:F.flightNumber,departureAirportFuzzy:F.departureAirport,departureTime:F.departureDateTime,arrivalAirportFuzzy:F.arrivalAirport,arrivalTime:F.arrivalDateTime},underName:{"@type":"http://schema.org/Person",name:P},reservationId:l,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:g,priceCurrency:o,reservedTicket:{"@type":"http://schema.org/Ticket",ticketedSeat:{"@type":"http://schema.org/Seat"}}},k.push(z);return k.length?k:void 0}}).call();