// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){function n(e){return e=e.replace(/[^\d\sa-zA-z:]+/g," ").replace(/\s+/g," ").replace(/^(\d+)\s(\d+)\s/,"$1/$2/"),e=getFuzzyDate(a.getDetachedSpan(e))}var a=Scanner.fromMessage(e);a.setLocale(t);var i,o,c,s,p,u,m,g,l,h,C,d,f,S;if(!r.emailTitelConfirmation.test(e.subject)&&!r.emailTitelCancelConfirmation.test(e.subject))return CONTINUE;p=a.getSpan().innerCapture(r.reservationId,1),i=a.getSpan().innerCapture(r.guestName,1);var v=a.getSpan().innerCapture(r.price,1);if(c=v.innerCapture(/([\d,.]+)/,1),s=v.innerCapture(/([^\d,.]+)/,1),m=""+a.getSpan().innerCapture(r.checkInDate,1),m=n(m),g=""+a.getSpan().innerCapture(r.checkOutDate,1),g=n(g),S=f=(""+a.getSpan().innerCapture(r.modifyUrl,1)).trim(),h=a.getSpan().innerCapture(r.hotelName,1),C=a.getSpan().innerCapture(r.hotelPhone,1),r.emailTitelConfirmation.test(e.subject)){if(!ASSERT(i,p,m,g,h))return CONTINUE;u="Confirmed"}return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:i,email:o},totalPrice:c,priceCurrency:s,checkinTime:m,checkoutTime:g,modifyReservationUrl:f,cancelReservationUrl:S,reservationStatus:"http://schema.org/Reservation"+(u||"Confirmed"),reservationId:p,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:h,url:l,telephone:C,address:d}}]}}).call();