// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,o,s,g,c,p,l,d,m,x,T,C,u;if(!(n.emailTitelConfirmation.test(e.subject)||n.emailTitelCancelConfirmation.test(e.subject)||n.emailTitelModifyConfirmation.test(e.subject)))return CONTINUE;g=a.getSpan().nextRegExp(n.reservationId).parentTag("td3").tagContents().innerCapture(n.reservationId,1),r=a.getSpan().nextText(n.guestName).nextTag("td7").tagContents();var h=a.getSpan().nextText(n.checkIn).nextTag("td7").tagContents().allInnerDates();p=2===h.length?combineDateAndTime(h[0],h[1]):h[0];var h=a.getSpan().nextText(n.checkOut).nextTag("td7").tagContents().allInnerDates();l=2===h.length?combineDateAndTime(h[0],h[1]):h[0];var v=a.getSpan().nextRegExp(n.hotel).nextRegExp(n.hotel).parentTag("table7").nextTag("td7").nextTag("td7").tagContents();return m=v.innerCapture(/(.+) </,1),d=v.innerLink(),T=v.innerCapture(/\n(.+\n.+)\n/,1),x=v.innerPhoneNumber(),o=a.getSpan().nextText(n.price).nextTag("td8").tagContents().innerCapture(/([\d,.]+)/,1),s=a.getSpan().nextText(n.price).nextTag("td8").tagContents().innerCapture(/([^\d,.]+)/,1),C=a.getSpan().nextText(n.modifyUrl).parentTag("td5").innerLink(),u=a.getSpan().nextText(n.cancelUrl).parentTag("td5").innerLink(),n.emailTitelConfirmation.test(e.subject)&&(c="Confirmed"),n.emailTitelCancelConfirmation.test(e.subject)&&(c="Cancelled",g=a.getSpan().nextRegExp(n.reservationIdCancel).parentTag("td3").tagContents().innerCapture(n.reservationIdCancel,1)),n.emailTitelModifyConfirmation.test(e.subject)&&(g=a.getSpan().nextRegExp(n.reservationIdModify).parentTag("td3").tagContents().innerCapture(n.reservationIdModify,1)),ASSERT(p,l,T)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:r,email:i},totalPrice:o,priceCurrency:s,checkinTime:p,checkoutTime:l,modifyReservationUrl:C,cancelReservationUrl:u,reservationStatus:"http://schema.org/Reservation"+(c||"Confirmed"),reservationId:g,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:m,url:d,telephone:x,address:T}}]:void 0}}).call();