// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("airbnb.com-billing-receipt-en",function(e){return/^Billing receipt for reservation/.test(e.subject)},function(e){if(!/^Billing receipt for reservation/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,i,o,s,c,g,p,u,d,m,l,h,T,v;if(l=t.getSpan().innerCapture(/View Itinerary <(.*)>/,1),v=t.getSpan().nextText("Accommodation Address").previousTag("td7").tagContents(),g=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),n=t.getSpan().nextRegExp(/\[td7\] Names? \[\/td7\]/).previousTag("td7").tagContents(),u=getFuzzyDate(t.getSpan().nextText("Check In").parentTag("table7")),m=getFuzzyDate(t.getSpan().nextText("Check Out").parentTag("table7")),h=t.getSpan().nextRegExp(/\[td7\] Property \[\/td7\]/).previousTag("td7").tagContents(),o=t.getSpan().nextText("Accommodations").parentTag("table6"),s=o.innerText("Total").exists()?"Total":"Accommodations",o=o.innerText(s).nextTag("td6").tagContents().innerCapture(/($<price>[\d,.]+)\s?($<currency>[a-zA-Z]{3})?/),o&&(i=o.$price,c=o.$currency),int(e.epoch)>=1405397228){g=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),n=t.getSpan().nextRegExp(/Guests/).nextAnyTag("td").tagContents().innerCapture(/(.+)\,/,1),v=t.getSpan().nextRegExp(/Accommodation Address/).nextAnyTag("td").tagContents(),h=t.getSpan().nextRegExp(/Travel Property/).nextAnyTag("td").tagContents();var p=t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").tagContents();p=p+" "+t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").nextAnyTag("td").tagContents(),u=getFuzzyDate(t.getDetachedSpan(p));var d=t.getSpan().nextRegExp(/Check In/).nextAnyTag("td").tagContents();d=d+" "+t.getSpan().nextRegExp(/Check Out/).nextAnyTag("td").nextAnyTag("td").tagContents(),m=getFuzzyDate(t.getDetachedSpan(d)),r=t.getSpan().nextRegExp(/Total/).nextAnyTag("td").tagContents(),i=r.innerCapture(/([\d,.]+)/,1),c=r.innerCapture(/([^\d,.]+)/,1).trim()}return ASSERT(u,m,v)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:n,email:a},totalPrice:i,priceCurrency:c,checkinTime:u,checkoutTime:m,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:g,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:h,url:l,telephone:T,address:v}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/328","SG57f9a3cf"),new ReverseTemplate("airbnb.com-billing-receipt-zh",function(e){return/^\u9884\u8ba2\u7684\u5e10\u5355\u6536\u636e$/.test(e.subject)},function(e){if(!/^\u9884\u8ba2\u7684\u5e10\u5355\u6536\u636e$/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("zh_Hans_CN");var n,a,r,i,o,s,c,g,p,u,d;return g=t.getSpan().innerCapture(/\u67e5\u770b\u884c\u7a0b <(.*)>/,1),d=t.getSpan().nextText("\u4f4f\u5bbf\u5730\u5740").previousTag("td7").tagContents(),o=t.getSpan().innerCapture(/\u786e\u8ba4\u7801\uff1a (.*)/,1).trim(),n=t.getSpan().nextRegExp(/\[td7\] \u4e2a\u540d\u5b57 \[\/td7\]/).previousTag("td7").tagContents(),s=getFuzzyDate(t.getSpan().nextText("\u5165\u4f4f\u65f6\u95f4").parentTag("table7")),c=getFuzzyDate(t.getSpan().nextText("\u9000\u623f\u65f6\u95f4").parentTag("table7")),p=t.getSpan().nextRegExp(/\[td7\] \u623f\u6e90 \[\/td7\]/).previousTag("td7").tagContents(),r=t.getSpan().nextText("\u603b\u4ef7").nextAnyTag("td").tagContents(),a=r.innerCapture(/([\d,.]+)/,1),i=r.innerCapture(/([^\d,.]+)/,1),ASSERT(s,c,d)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:n},totalPrice:a,priceCurrency:i,checkinTime:s,checkoutTime:c,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:p,url:g,telephone:u,address:d}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/329","SGf1b445fb"),new ReverseTemplate("airbnb.com-cancelled-de",function(e){return/Buchung .+ storniert/.test(e.subject)},function(e){var t="de_DE",n={};n.emailTitelConfirmation=/Buchung .+ storniert/,n.cancellationUs=/Wir haben wie gew\xfcnscht die Buchung .+ storniert/,n.cancellationThem=/Unfortunately\, we have some bad news about your upcoming trip/,n.cancellationUs.test(e.plain)&&(n.guestName=/Hallo (.+)\,/,n.reservationId=/Wir haben wie gew\xfcnscht die Buchung (.+), beginnend/,n.checkInDate=/beginnend am/,n.providerName=/beginnend .+ bei (.+) storniert/),n.cancellationThem.test(e.plain)&&(n.dates=/Your reservation for (.+) was canceled by/,n.providerName=/was canceled by (.+)\s<.+>\s\,/,n.hotelName=/was canceled by .+\, your host at (.+)\. We want you/,n.checkInDate=/Check In/,n.checkOutDate=/Check Out/);var a=loadHelper("airbnb.com-cancelled.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/330","SG21b76aff"),new ReverseTemplate("airbnb.com-cancelled-en",function(e){return/Reservation canceled at|Reservation .+ Canceled/.test(e.subject)},function(e){var t="en_US",n={};n.emailTitelConfirmation=/Reservation.+[Cc]anceled/,n.cancellationUs=/We have canceled reservation .+ as you requested/,n.cancellationThem=/Unfortunately\, we have some bad news about your upcoming trip/,n.cancellationUs.test(e.plain)&&(n.guestName=/Hi (.+)\,/,n.reservationId=/We have canceled reservation (.+) starting/,n.checkInDate=/starting on/,n.providerName=/starting on .+ with (.+) as you requested/),n.cancellationThem.test(e.plain)&&(n.dates=/Your reservation for (.+) was canceled by/,n.providerName=/was canceled by (.+)\s<.+>\s\,/,n.hotelName=/was canceled by .+\, your host at (.+)\. We want you/,n.checkInDate=/Check In/,n.checkOutDate=/Check Out/);var a=loadHelper("airbnb.com-cancelled.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/331","SG6645765e"),new ReverseTemplate("airbnb.com-itinerary-de",function(e){return/Reiseplan von/.test(e.subject)},function(e){var t="de_DE",n={};n.emailTitelConfirmation=/Reiseplan von/,n.reservationId=/Best\xe4tigungscode\: (.+)/,n.checkInDate=/Check-In/,n.checkOutDate=/Check-Out/,n.guestName=/Name/,n.guestEmail=/Dieser Reiseplan/;var a=loadHelper("airbnb.com-itinerary.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/334","SG6ee1921f"),new ReverseTemplate("airbnb.com-itinerary-en",function(e){return/^Reservation (?:Confirmed|Itinerary from)/.test(e.subject)},function(e){if(!/^Reservation (?:Confirmed|Itinerary from)/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,i,o,s,c,g,p,u,d,m,l,h,T,v,x,C,b;if(a=t.getSpan().innerCapture(/\s+(?:Hello|Dear|Hi there|Hi) (.*),/g,1),t.getSpan().nextText("Sent with \u2665 from Airbnb HQ").exists())s=t.getSpan().innerCapture(/Confirmation Code: (.*)/,1).trim(),l=t.getSpan().innerCapture(/View itinerary <(.*)>/,1),n=t.getSpan().nextText("Your Host").nextTag("td3").nextTag("td3").tagContents().innerCapture(/($<name>.+?)\n($<telephone>.+?)\n/),b=n?n.$telephone.trim():null,x=n?n.$name.trim():null,v=t.getSpan().nextText("Itinerary").nextAddress(),h=v.nextTag("table3").innerCapture(/\s+(.*) <(?:.*)>/,1),g=t.getSpan().nextRegExp(/CHECK IN|Check In/).nextTag("td5").tagContents(),c=g.nextTag("td5").tagContents(),p=t.getDetachedSpan(""+g+" "+c).innerDate(),d=t.getSpan().nextRegExp(/CHECK OUT|Check Out/).nextTag("td5").tagContents(),u=d.nextTag("td5").tagContents(),m=t.getDetachedSpan(""+d+" "+u).innerDate(),i="3";else{not(a)&&(a=t.getSpan().innerCapture(/\bThis itinerary has been shared with you by (.*) \(/,1)),l=t.getSpan().nextText("View Itinerary").parentTag("td4").innerCapture(/View Itinerary <(.*)>/,1),s=t.getSpan().nextText("Confirmation Code:").parentTag("table4").innerCapture(/Confirmation Code: (.*)\s/,1),g=t.getDetachedSpan(""+t.getSpan().nextText("Check In").previousTag("td6").tagContents()).allInnerDates(),p=combineDateAndTime(g[0],g[1]),d=t.getDetachedSpan(""+t.getSpan().nextText("Check Out").previousTag("td6").tagContents()).allInnerDates(),m=combineDateAndTime(d[0],d[1]),n=t.getSpan().nextText("The billing information you supplied").previousTag("table6");var S=n.allPhoneNumbers();b=[];for(var y,f=0;y=S[f++];)b.push(""+y);b=b.join("\n"),x=n.nextTag("td6").nextTag("td6").tagContents().innerCapture(/(.+?) </,1),C=n.lastInnerTag("td6").tagContents().innerCapture(/\n(.+?)$/,1),v=n.previousTag("table6").innerAddress(),n=n.previousTag("table6").allInnerTagsFiltered("td6"),n.length>=2&&(not(v)&&(v=n[1]),h=n[0].innerCapture(/(.*) <http:(?:.*)>/,1)),i="6"}if(i){var R=t.getSpan().nextText("Accommodations").parentTag("table"+i),D=R.innerText("Total").exists()?"Total":"Accommodations";R=R.innerText(D).nextTag("td"+i).tagContents().innerCapture(/($<price>[\d,.]+)\s?($<currency>[a-zA-Z]{3})?/),R&&(r=R.$price,o=R.$currency)}return ASSERT(p,m,v)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a},provider:valid(OR(x,C,b))?{"@type":"http://schema.org/Person",name:x,email:C,telephone:b}:null,totalPrice:r,priceCurrency:o,checkinTime:p,checkoutTime:m,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:s,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:h,url:l,telephone:T,address:v}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/335","SG05538bc5"),new ReverseTemplate("airbnb.com-itinerary-zh",function(e){return/\u7684\u9884\u8ba2\u884c\u7a0b\u5355/.test(e.subject)},function(e){var t="zh_Hans_CN",n={};n.emailTitelConfirmation=/\u7684\u9884\u8ba2\u884c\u7a0b\u5355/,n.reservationId=/\u786e\u8ba4\u7801\uff1a (.+)/,n.checkInDate=/\u5165\u4f4f\u65e5\u671f/,n.checkOutDate=/\u9000\u623f\u65e5\u671f/,n.guestName=/\u4e2a\u540d\u5b57/,n.guestEmail=/\u60a8\u7684\u623f\u6e90\u7684\u623f\u5ba2/;var a=loadHelper("airbnb.com-itinerary.js");return a(e,t,n)},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/336","SG53a351a1"),new ReverseTemplate("airbnb.com-meetup-en",function(e){return/^You've registered for an Airbnb Meetup/.test(e.subject)},function(e){if(!/^You've registered for an Airbnb Meetup/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,i,o,s,c,g;return a=t.getSpan().innerCapture(/\bYou've registered for an upcoming Airbnb meetup, (.*)\./,1),n=t.getSpan().nextText("When").parentTag("td4").tagContents(),c=n.innerAddress(),g=n.withEnd(c.getStart()).trim(),i=t.getDateDD(n.lastInnerDate()),2===n.allDates().length&&i.iso8601&&i.endIso8601?(o=combineDateAndTime(n.nextDate(),i.iso8601),s=combineDateAndTime(n.nextDate(),i.endIso8601)):o=getFuzzyDate(n),ASSERT(a,o,c)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",reservationStatus:"http://schema.org/ReservationConfirmed",reservationFor:{url:r,"@type":"http://schema.org/SocialEvent",name:a,startDate:o,endDate:s,location:{"@type":"http://schema.org/Place",name:g,address:c}}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/337","SG93adc33b"),new ReverseTemplate("airbnb.com-reservation-reminder-en",function(e){return/^Reservation reminder/.test(e.subject)},function(e){if(!/^Reservation reminder/.test(e.subject))return CONTINUE;var t=Scanner.fromMessage(e);if(t.setLocale("en_US"),!t.getSpan().nextRegExp(/This is a reminder that you have an upcoming reservation\./).exists())return CONTINUE;var n,a,r,i,o,s,c,g,p,u,d,m,l,h;n=t.getSpan().innerCapture(/\s+(?:Hello|Dear) (.*),/g,1),g=t.getSpan().innerCapture(/Print & pack your itinerary <(.*)>/,1);var T=t.getSpan().nextText("This is a reminder that you have an upcoming reservation"),v=T.nextDate().nextDate();return o=t.getDateDD(v),s=t.getDetachedSpan(o.iso8601),c=t.getDetachedSpan(o.endIso8601),d=T.nextRegExp(/>\s+3\. .+?\n/).innerCapture(/>\s+3\. (.+?)\n/,1),p=d.super(v).innerCapture(/2. (.*) <(?:.*)>/,1),m=d.nextRegExp(/\n1\. (.+?)\n/).innerCapture(/\n1\. (.+?)\n/,1),l=d.nextRegExp(/\n2\. (.+?)\n/).innerCapture(/\n2\. (.+?)\n/,1),h=d.nextRegExp(/\n3\. (.+?)\n/).innerCapture(/\n3\. (.+?)\n/,1),ASSERT(s,c,d)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:n},provider:valid(OR(m,l,h))?{"@type":"http://schema.org/Person",name:m,email:l,telephone:h}:null,totalPrice:a,priceCurrency:r,checkinTime:s,checkoutTime:c,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:i,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:p,url:g,telephone:u,address:d}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/317/327/338","SG1a1ed5b7")]);