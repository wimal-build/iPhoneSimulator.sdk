// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("expedia.com-flight-changes-en",function(e){return/^Changes have been made to your .*? flight/.test(e.subject)||/^Your flight itinerary .*? changed$/.test(e.subject)},function(e){if(/^Changes have been made to your .*? flight/.test(e.subject)||/^Your flight itinerary .*? changed$/.test(e.subject)){if(!/notifications@expedia.com/.test(e.from)){var r="en_US",t={};t.itineraryLabel="Revised Itinerary",t.confirmationLabel="Airline confirmation code",t.passenger="Traveler(s)",t.traveler="Traveler",t.ticketNo="Airline Ticket No.",t.cancelled=/Per your request, your flight is canceled/,t.cancelledLabel="CANCELED";var a=loadHelper("expediamail.com-flight-alternative-skeleton.js");return a(e,r,t)}var i=Scanner.fromMessage(e);i.setLocale("en_US");var n,l,o,s,c,d,p,u,m,g,h,f,v,y,T,C,b=[],S={};if(n=i.getSpan().nextText("Passenger(s):").parentAnyTag("td").tagContents().innerCapture(/\bPassenger\(s\): (.*)/,1),not(n))return CONTINUE;n=n.split(",").map(function(e){return e.trim()});for(var x=0;n.length>x;x++)S[""+n[x]]={name:n[x],seats:{},seatingType:{}};c=i.getSpan().nextText("Your updated flight itinerary is below").nextText("Flight Details").parentAnyTag("table");var k=c.getTagNumber();c=c.withStart(i.getSpan().nextText("Your updated flight itinerary is below").getEnd()).allInnerTags("tr"+k).map(function(e){return e.allInnerTagsFiltered("td"+k)}).filter(function(e){return e.length>0});for(var N=0;c.length>N;N++)if(l=c[N],l[0].innerCapture(/^Flight(?: Change)? Details/)&&l[1])h=l[1];else if(l[1]&&l[1].innerCapture(/^Flight Number:/))p=l[0],d=l[1].innerCapture(/^Flight Number: ($<code>\w{2})($<flightNumber>\d+)/),u=d?d.$code:null,m=d?d.$flightNumber:null,i.getSpan().nextText(""+p+" confirmation code:").exists()&&(o=i.getSpan().innerCapture(RegExp(regExpEscape(""+p)+" confirmation code: (.*)\\s"),1));else if(l[0].innerCapture(/^From:/)&&l[1])f=l[0].innerCapture(/^From: \(([A-Z]{3})\)/,1);else if(l[0].innerCapture(/^To:/)&&l[1])y=l[0].innerCapture(/^To: \(([A-Z]{3})\)/,1),T=l[1].innerCapture(/^Arrive: .* \+1 day$/),v=combineDateAndTime(h,l[1].lastInnerDate()),not(T)||(v=modifyDate(v,1));else if(l[1]&&l[1].innerCapture(/^Class:/))C=l[1].innerCapture(/^Class: (.*)/,1);else if(l[0].innerCapture(/^Equipment:/)){if(l[1]&&l[1].innerCapture(/^Seats:/)&&(s=l[1].innerCapture(/^Seats: (.*)/,1).split(",").map(function(e){return e.trim()})),valid(m)){n=Object.keys(S);for(var x=0;n.length>x;x++)valid(s)&&(S[n[x]].seats[""+m]=s[x]),valid(C)&&(S[n[x]].seatingType[""+m]=C)}ASSERT(u,m,h,f,v,y)&&b.push({airlineName:p,airlineCode:u,flightNumber:m,departureTime:h,departureCode:f,arrivalTime:v,arrivalCode:y,reservationId:o,passengers:S}),d=p=u=m=g=h=f=v=y=C=s=o=null}for(var A,I=[],N=0;b.length>N;N++){A=b[N];for(var j=Object.keys(A.passengers),F=0;j.length>F;F++){var R=A.passengers[j[F]],D={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:A.airlineName,airlineCode:A.airlineCode,flightNumber:A.flightNumber,departureAirportFuzzy:A.departureAirport,departureAirportCode:A.departureCode,departureTime:A.departureTime,arrivalAirportFuzzy:A.arrivalAirport,arrivalAirportCode:A.arrivalCode,arrivalTime:A.arrivalTime},underName:{"@type":"http://schema.org/Person",name:R.name},checkinUrl:A.checkinUrl,reservationId:A.reservationId,reservationStatus:"http://schema.org/Reservation"+(A.reservationStatus||"Confirmed"),totalPrice:R.price,priceCurrency:R.currency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:R.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:R.seats[A.flightNumber],seatingType:R.seatingType[A.flightNumber]}}};valid(R.membershipNumber,R.programName)&&(D.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:R.membershipNumber,programName:R.programName}),I.push(D)}}if(I.length)return I}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/597","SG7272f80d"),new ReverseTemplate("expediamail.com-car-cancellation-en",function(e){return/^Expedia Car Booking Cancelled/.test(e.subject)},function(e){if(/^Expedia Car Booking Cancelled/.test(e.subject)){var r="en_US",t={};t.total="Total Price",t.reserved="Reserved for",t.pickUp="Pick up",t.dropOff="Drop off",t.cancelled=/Expedia Car Booking Cancelled/;var a=loadHelper("expediamail.com-car-skeleton.js");return a(e,r,t)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/598","SG54e4ebe4"),new ReverseTemplate("expediamail.com-flight-cancellation-en",function(e){return/^Your flight itinerary .*? cancell?ed$/.test(e.subject)||/\(Itin(?:erary)?# \d+\)$/.test(e.subject)},function(e){var r,t="en_US",a={};return/This reservation has been fully cancell?ed/.test(e.plain)?(a.travellers=/Travell?er Information/,a.priceSummary="Price Summary",a.totalPrice="Total:",a.priceCurrency="All prices quoted in",a.reservationId="Itinerary #",a.cancelled=/This reservation has been fully cancell?ed/,a.noProgramName="No frequent flyer details provided",a.ticketNumber="Ticket #",a.totalTravelTime="Total travel time",a.seat="Seat",(r=loadHelper("expediamail.com-flight-itinerary-skeleton.js"))(e,t,a)):/^Your flight itinerary .*? cancell?ed$/.test(e.subject)?(a.itineraryLabel="Revised Itinerary",a.confirmationLabel="Airline confirmation code",a.passenger="Traveler(s)",a.traveler="Traveler",a.ticketNo="Airline Ticket No.",a.reservationId="Expedia Itinerary No.",a.cancelled=/Per your request, your flight is canceled/,a.cancelledLabel="CANCELED",(r=loadHelper("expediamail.com-flight-alternative-skeleton.js"))(e,t,a)):void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/600","SG31e236d5"),new ReverseTemplate("expediamail.com-flight-itinerary-en",function(e){return/\(Itin(?:erary)?# \d+\)$/.test(e.subject)},function(e){if(/Travell?er Information/.test(e.plain)&&/Airline Rules & Regulations/.test(e.plain)){var r={};r.travellers=/Travell?er Information/,r.priceSummary="Price Summary",r.totalPrice="Total:",r.priceCurrency="All prices quoted in",r.reservationId="Itinerary #",r.cancelled=/This reservation has been fully cancell?ed/,r.noProgramName="No frequent flyer details provided",r.ticketNumber="Ticket #",r.totalTravelTime="Total travel time",r.seat="Seat";var t="en_US",a=loadHelper("expediamail.com-flight-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/602","SG5a713d71"),new ReverseTemplate("expediamail.com-hotel-cancellation-en",function(e){return/^Expedia Hotel Cancellation Confirmation/.test(e.subject)},function(e){if(/^Expedia Hotel Cancellation Confirmation/.test(e.subject)){var r=Scanner.fromMessage(e);r.setLocale("en_US");var t,a,i,n,l,o,s,c,d,p,u,m,g,h,f;if(d=r.getDateDD(r.getSpan().nextTag("table6").nextTag("td6").innerDate()),valid(d)&&(p=r.getDetachedSpan(d.iso8601),u=r.getDetachedSpan(d.endIso8601)),i=r.getSpan().nextTag("table9").allInnerTagsFiltered("td9")[0],valid(i)&&(g=i.innerCapture(/(.*)\s/,1),f=i.innerCapture(/\s+(.*)$/,1),i.innerAddress().getLength()>=f.getLength()&&(f=i.innerAddress())),t=r.getSpan().nextText("Reserved for").nextTag("td9").nextTag("td9").tagContents(),o=r.getSpan().innerCapture(/Expedia Itinerary number: (\d+)/,1),ASSERT(f,p))return[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:t,email:a},totalPrice:n,priceCurrency:l,checkinTime:p,checkoutTime:u,modifyReservationUrl:s,cancelReservationUrl:c,reservationStatus:"http://schema.org/ReservationCancelled",reservationId:o,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:g,url:m,telephone:h,address:f}}]}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/606","SG2b1c7dbc"),new ReverseTemplate("expediamail.com-hotel-itinerary-en",function(e){return/^Expedia Itinerary #:/.test(e.subject)||/^Expedia travel confirmation/.test(e.subject)},function(e){if(/View hotel details/.test(e.plain)){var r={};r.reservedFor="Reserved for",r.reservationId="Itinerary #",r.hotelDetails="View hotel details <",r.telephone="Tel:",r.checkin="Checking in",r.checkinTime="Check-in time starts",r.priceSummary="Price Summary",r.totalPrice="Total",r.priceCurrency="All prices quoted in";var t="en_US",a=loadHelper("expediamail.com-hotel-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/607","SG20b2853d"),new ReverseTemplate("expediamail.com-travel-itinerary-en",function(e){return/^Your Trip Details/.test(e.subject)||/^Final Details For Your Trip/.test(e.subject)},function(e){if(/^Your Trip Details/.test(e.subject)||/^Final Details For Your Trip/.test(e.subject)){var r={flight:{},car:{},hotel:{}};r.emailHeader=["My Itineraries","My Account","Customer Support","Feedback"],r.mainContact="Main contact:",r.emailAddress="Email address:",r.confirmationCode="Confirmation Code:",r.flight.verify="Airline rules and regulations",r.flight.travelers=/Travell?er's name\(s\):/,r.flight.checkinUrl=/Online(?: Flight)? Check-in/,r.flight.details="Flight Details",r.flight.depart="Depart",r.flight.arrive="Arrive",r.flight.flightNumber="Flight Number:",r.flight.seatUnassigned="Seat Unassigned",r.car.verify="Car rules and regulations",r.car.pickup="Pick-up",r.car.dropoff="Drop-off",r.car.address="Address:",r.car.modify="Change/ Cancel <",r.hotel.verify="Hotel rules and regulations",r.hotel.checkin="Check-in",r.hotel.checkout="Check-out",r.hotel.modify="Change/Cancel",r.hotel.address="Address:",r.hotel.telephone="Telephone:";var t="en_US",a=loadHelper("expediamail.com-travel-itinerary-skeleton.js");return a(e,t,r)}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/577/596/614","SG1eed6715")]);