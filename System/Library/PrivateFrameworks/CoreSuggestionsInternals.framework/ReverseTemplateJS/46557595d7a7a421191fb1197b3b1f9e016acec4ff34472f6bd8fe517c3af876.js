// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("kayak.com-car-en",function(e){return/^Your KAYAK reservation(?: receipt)? for/.test(e.subject)},function(e){if(int(e.epoch)<1388534400)return CONTINUE;if(/^Your KAYAK reservation(?: receipt)? for/.test(e.subject)&&/You reserved a rental car/.test(e.plain)){var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,a,r,o,i,s,p,c,g,l,T,d,u,h,m,x,f,C,v,S,y,b,k,A;if(/has been canceled$/.test(e.subject)&&(o="Cancelled"),h=t.getSpan().nextText("Renter").nextTag("table4").lastInnerTag("tr4"),n=h.innerTag("td4").tagContents(),a=h.lastInnerTag("td4").tagContents(),r=t.getSpan().innerCapture(/Your confirmation number: (\w+)\s/,1),c=t.getSpan().nextText("Rental Car Total").nextTag("td3").nextTag("td3").tagContents().innerCapture(/([\d,.]+)/,1),l=t.getSpan().nextText("Pick up").previousTag("table4").nextTag("td4").nextTag("td4").nextTag("td4").tagContents(),p=t.getSpan().nextText("Cancel this booking <").nextLink(),S=t.getSpan().nextText("Pick up").parentAnyTag("table"),A=S.innerDate(),h=S.innerTag("table5").allInnerTagsFiltered("td5").map(function(e){return""+e}),h.length>=2&&(y=h[0],b=t.getDetachedSpan(h.slice(1).join("-"))),k=S.innerText("Phone:").parentAnyTag("td").tagContents().innerCapture(/Phone: (.*)/,1),m=t.getSpan().nextText("Drop off").parentAnyTag("table"),v=m.innerDate(),h=m.innerTag("table5").allInnerTagsFiltered("td5").map(function(e){return""+e}),h.length>=2?(x=h[0],f=t.getDetachedSpan(h.slice(1).join("-")),C=S.innerText("Phone:").parentAnyTag("td").tagContents().innerCapture(/Phone: (.*)/,1)):m.innerText("same location as pick-up").exists()&&(x=y,f=b,C=k),u=t.getSpan().nextText("You reserved a rental car on").parentAnyTag("td").tagContents().innerCapture(/You reserved a rental car on (\w+)/,1),not(u)&&(u=y),ASSERT(u,n,l,b,A))return[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:c,priceCurrency:g,reservationId:r,reservationStatus:"http://schema.org/Reservation"+(o||"Confirmed"),checkinUrl:i,modifyReservationUrl:s,cancelReservationUrl:p,underName:{"@type":"http://schema.org/Person",name:n},provider:{"@type":"http://schema.org/Organization",name:u},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:l},license:T,color:d},pickupTime:A,pickupLocation:{"@type":"http://schema.org/Place",name:y,telephone:k,address:b},dropoffTime:v,dropoffLocation:{"@type":"http://schema.org/Place",name:x,telephone:C,address:f}}]}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/535/581/582","SGf340a05f")]);