// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){if(!e||!t||!n)return CONTINUE;var r=Scanner.fromMessage(e);r.setLocale(t);var a,g,o,i,p,x,d,s,l,m,c,E,u,h,R;return o=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.bookingNumber)).parentTag("table3"),x=o.innerRegExp(regExpFormatted(/\1/,n.bookingNumber)).nextTag("td3").tagContents(),l=getFuzzyDate(o.innerRegExp(regExpFormatted(/\1/,n.checkin)).nextTag("td3")),m=getFuzzyDate(o.innerRegExp(regExpFormatted(/\1/,n.checkout)).nextTag("td3")),o=o.innerRegExp(regExpFormatted(/\1/,n.bookedBy)).nextTag("td3").tagContents().innerCapture(/($<name>.*) \(($<email>.*)\)/),a=o?o.$name:null,g=o?o.$email:null,c=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.modifyReservationUrl)).previousTag("table3"),o=c.innerTag("td3").tagContents().innerCapture(/($<hotelName>.*?) <($<hotelUrl>.*)>/),u=o?o.$hotelName:null,E=o?o.$hotelUrl:null,o=c.innerTag("table5"),R=o.innerRegExp(regExpFormatted(/\1/,n.address)).nextTag("td5").tagContents(),R.innerAddress().getLength()===R.getLength()&&(R=R.innerAddress()),h=o.innerRegExp(regExpFormatted(/\1/,n.phone)).nextTag("td5").tagContents(),d=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.modifyReservationUrl)).nextLink(),s=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.cancelReservationUrl)).nextLink(),i=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.totalPrice)).nextAnyTag("td").tagContents().innerCapture(/([\d,.]+)/,1),0===(""+i).length&&(i=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.totalPriceAlternative)).nextAnyTag("td").tagContents().innerCapture(/([\d,.]+)/,1),/^\d+/.test(i)||(i="")),p=r.getSpan().nextRegExp(regExpFormatted(/\1/,n.cancellationFees)).parentAnyTag("table").innerCapture(regExpFormatted(/\* (?:(?:\b\1 )?.* \[.*\](?: ?\1)?\s?: )?([A-Z]{2,3})/,n.from),1),ASSERT(l,m,R)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:g},totalPrice:i,priceCurrency:p,checkinTime:l,checkoutTime:m,modifyReservationUrl:d,cancelReservationUrl:s,reservationStatus:"http://schema.org/ReservationConfirmed",reservationId:x,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:u,url:E,telephone:h,address:R}}]:void 0}}).call();