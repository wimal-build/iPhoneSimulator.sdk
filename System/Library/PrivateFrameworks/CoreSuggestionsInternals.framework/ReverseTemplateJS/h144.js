// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var n=Scanner.fromMessage(e);n.setLocale(t);var a,i,o,p,s,m,g,c,u,d,h,x;if(r.reservationCancelled.test(e.subject))x="Cancelled";else{if(!r.confirmation.test(e.subject))return CONTINUE;x="Confirmed"}a=n.getSpan().innerCapture(regExpFormatted(/\1.(.*)\2/,r.underPersonNamePrefix,r.underPersonNameSuffix),1).trim(),o=n.getSpan().innerCapture(regExpFormatted(/\1(?::|\uff1a)(.*)/,r.hotelNamePrefix),1).trim(),p=n.getSpan().innerCapture(regExpFormatted(/\1\s*.\s*([\d|\-|\+]+)/,r.hotelPhonePrefix),1).trim(),m=n.getSpan().innerCapture(r.hotelAddressRegExp,1).trim(),g=n.getSpan().innerCapture(regExpFormatted(/\1.(.*)/,r.reservationIdPrefix),1).trim();var f=n.getSpan().innerCapture(regExpFormatted(/\1.(.*)/,r.pricePrefix),1).trim();c=n.getSpan().nextText(r.checkInDateTimePrefix).nextDate();var l=n.getSpan().innerCapture(regExpFormatted(/\1.(.*)\2/,r.stayLengthPrefix,r.stayLengthSuffix),1).trim();return l&&(u=modifyDate(c,int(""+l))),d=f.innerCapture(/([\d,.]+)/,1),h=f.innerCapture(/([^\d,.]+)/,1).trim(),ASSERT(a,o,c)?[{"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:a,email:i},totalPrice:d,priceCurrency:h,checkinTime:c,checkoutTime:u,reservationStatus:"http://schema.org/Reservation"+x,reservationId:g,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:o,telephone:p,url:s,address:m}}]:CONTINUE}}).call();