// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);for(var r,s,o,g,i,c,d,l,p,m,h,u,x,T,S,v,D,k,b=0;n.confirmations.length>b;b++)if(n.confirmations[b].test(e.subject)){D=a.getSpan().innerCapture(regExpFormatted(/\1/,n.details)),s=D?D.$name:null;break}return n.reminder.test(e.subject)&&(m=regExpFormatted(/\1 (.*)/,n.reminder).exec(e.subject)[1],D=a.getSpan().nextText(m).parentAnyTag("td").tagContents().innerCapture(n.details)),m=D?D.$eventName:m,h=D?D.$eventUrl:null,c=a.getSpan().nextRegExp(n.ticketToken).nextLink(),o=a.getSpan().nextText(n.orderSummary).nextText(n.total).nextTag("td3").tagContents().innerCapture(/([\d,.]+)/,1),D=a.getSpan().nextText(n.aboutThisEvent).nextAnyTag("table"),k=D.getTagNumber(),D=D.allInnerTagsFiltered("td"+k),D.length&&(D[0].allInnerDates().length>0&&(u=D[0].innerDate(),a.getDateDD(u).endIso8601?x=a.getDateDD(u).endIso8601:D[0].allInnerDates().length>1&&(x=D[0].lastInnerDate())),v=D[1].innerAddress(),D=D[1].innerCapture(/^($<place>.*)\n($<address>[\s\S]+)/),D&&(S=D.$place,v&&D.$address&&D.$address.getLength()>v.getLength()&&(v=D.$address))),ASSERT(u,m)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:s,totalPrice:o,priceCurrency:g,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:i,ticketToken:c,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:d,seatRow:l,seatSection:p}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/Event"+(r||"Confirmed"),name:m,url:h,startDate:u,endDate:x,location:{"@type":"http://schema.org/Place",name:S,telephone:T,address:v}}}]:void 0}}).call();