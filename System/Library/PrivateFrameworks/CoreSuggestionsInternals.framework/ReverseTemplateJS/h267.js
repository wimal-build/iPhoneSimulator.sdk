// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){if(!e||!t||!n)return CONTINUE;var a=loadHelper("seatme.com-microdata-parser.js"),r=a(e),i=Scanner.fromMessage(e);if(i.setLocale(t),r)return delete r[0].modifiedTime,r[0].startTime=i.getSpan().innerDate(),r[0]["@context"]="http://schema.org",r[0].reservationStatus="http://schema.org/ReservationConfirmed",r;var s,o,l,p,m,c,d,g,u,h,x,S;return s=i.getSpan().innerCapture(n.underNameLabel,1),u=i.getSpan().nextText(n.addressLabel).nextAddress(),g=i.getSpan().nextText(n.contactLabel).nextPhoneNumber(),S=i.getSpan().nextRegExp(n.agentUrlLabel).nextLink(),c=i.getSpan().nextText(n.urlLabel).nextLink(),n.confirmationLabel.test(e.subject)?(l=i.getSpan().innerCapture(n.detailsLabel),m=l?l.$partySize:null,p=l?l.$name:null,d=l?i.getDetachedSpan(""+l.$startTime):null):n.editLabel.test(e.subject)&&(l=i.getSpan().innerCapture(n.editChangeLabel),m=l?l.$partySize:null,p=l?l.$name:null,d=l?i.getDetachedSpan(""+l.$startTime):null),h=i.getSpan().nextText(n.modifyUrlLabel).nextLink(),h.exists()&&h.innerRegExp(/\/edit\/[-\w]+\//)&&(o=h.innerCapture(/\/edit\/([-\w]+)\//,1)),x=i.getSpan().nextText(n.cancelUrlLabel).nextLink(),ASSERT(m,p,d,s)?[{"@context":"http://schema.org","@type":"http://schema.org/FoodEstablishmentReservation",partySize:m,reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",reservationFor:{"@type":"http://schema.org/FoodEstablishment",name:p,url:c,telephone:g,address:u},startTime:d,bookingAgent:{"@type":"http://schema.org/Organization",name:"SeatMe",url:S},underName:{"@type":"http://schema.org/Person",name:s},cancelReservationUrl:x,modifyReservationUrl:h}]:void 0}}).call();