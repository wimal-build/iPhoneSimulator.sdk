// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("evite.com-invitation-en",function(e){return/^Evite Invitation:/.test(e.subject)},function(e){if(/^Evite Invitation:/.test(e.subject)){if(int(e.epoch)<1325376e3)return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,r,a,i,s,o,m,d,p,c,l,v;if(r=t.getSpan().innerCapture(/($<eventCreator>.*?)\s+invited you to\s+($<eventName>.*)\s+<($<eventUrl>http.*)>/),r&&(s=r.$eventCreator,a=r.$eventName,i=r.$eventUrl,i.exists()&&(i.innerText("utm_content").exists()&&(i=i.split("?",1)[0]),i=i.rstrip("/v"))),not(a))return CONTINUE;if(n=a.collapseToEnd().withEnd(1/0),!n.innerDate())return CONTINUE;if(o=n.allInnerDates(),2==o.length?(m=t.getDateDD(o[1]),m.iso8601&&m.endIso8601&&(l=combineDateAndTime(o[0],m.iso8601),v=combineDateAndTime(o[0],m.endIso8601))):3==o.length&&(l=combineDateAndTime(o[0],o[1]),v=o[2]),not(l)&&(l=o[0]),d=getFuzzyAddress(n),p=t.getSpan().innerCapture(/Where:\s+($<name>.*)\n($<address>[^]*)\s+Will you attend/),p&&(not(d)?d=t.getDetachedSpan(""+p.$name+" "+p.$address).trim():startsWith(""+d,""+p.$name)||(c=p.$name)),ASSERT(a,s,i,l,d))return[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",reservationStatus:"http://schema.org/ReservationPending",appleInvitedBy:s,reservationFor:{url:i,"@type":"http://schema.org/SocialEvent",name:a,startDate:l,endDate:v,location:valid(c)?{"@type":"http://schema.org/Place",name:c,address:d}:d}}]}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/513/521/522","SGb489462e"),new ReverseTemplate("evite.com-reminder-en",function(e){return/^Event Reminder:/.test(e.subject)},function(e){if(/^Event Reminder:/.test(e.subject)&&/Event Reminder/.test(e.plain)){var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,r,a,i,s,o,m,d,p,c,l,v,u;if(r=t.getSpan().nextText("Event Reminder").nextTag("td1").tagContents().innerCapture(/($<name>.*) <($<url>http.*)>/),a=r?r.$name:null,not(a))return CONTINUE;if(i=r?r.$url:null,i.exists()&&(i.innerText("utm_content").exists()&&(i=i.split("?",1)[0]),i=i.rstrip("/v")),s=t.getSpan().innerCapture(/Hosted by:\s+(.*)\n/,1).trim(),n=a.collapseToEnd().withEnd(1/0),!n.innerDate())return CONTINUE;if(o=n.allInnerDates(),2==o.length?(m=t.getDateDD(o[1]),m.iso8601&&m.endIso8601&&(l=combineDateAndTime(o[0],m.iso8601),v=combineDateAndTime(o[0],m.endIso8601))):3==o.length&&(l=combineDateAndTime(o[0],o[1]),v=o[2]),not(l)&&(l=o[0]),d=getFuzzyAddress(n),p=t.getSpan().innerCapture(/Where:\s+($<name>.*)\n($<address>[^]*)\s+Your reply is/),p&&(not(d)?d=t.getDetachedSpan(""+p.$name+" "+p.$address).trim():startsWith(""+d,""+p.$name)||(c=p.$name)),n=t.getSpan().innerCapture(/Your reply is: (.*)/,1),"yes"==n.getString().toLowerCase().trim()&&(u="Confirmed"),ASSERT(a,i,l))return[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",reservationStatus:"http://schema.org/Reservation"+(u||"Pending"),appleInvitedBy:s,reservationFor:{url:i,"@type":"http://schema.org/SocialEvent",name:a,startDate:l,endDate:v,location:valid(c)?{"@type":"http://schema.org/Place",name:c,address:d}:d}}]}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/513/521/523","SG82c406c0")]);