// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("jetblue.com-itinerary-checkin-2013",function(e){return/^Itinerary for your upcoming trip$/.test(e.subject)||/^Check in for your flight to/.test(e.subject)},function(e){if(/^Itinerary for your upcoming trip/.test(e.subject)||/^Check in for your flight to/.test(e.subject)){var r=Scanner.fromMessage(e);if(r.setLocale("en_US"),r.getSpan().nextRegExp(/Your ticket(?:\(s\) is\/| numbers )?are:/).exists()){var t,a,n,i,o,s,l,u,p,m,g,c,h,d,b=[],v={};t=r.getSpan().innerCapture(/\bYour confirmation number is (\w+)[.\s]/,1),a=r.getSpan().nextText("Skip the line, check in now!").nextTag("td2").innerLink(),not(a)&&(a=r.getSpan().nextText("Your confirmation number is").nextTag("table3").allInnerLinks(),a=5==a.length?a[1]:null),o=r.getSpan().nextRegExp(/Your ticket(?:\(s\) is\/| numbers )?are:/).nextTag("table3").allInnerTagsFiltered("td3");for(var f=0;o.length>f;f++){n=o[f].innerCapture(/($<name>.*): ($<ticketNumber>\w+)/),i=n?n.$name:null;var T=n?n.$ticketNumber:null;valid(i)&&(v[""+i]={name:i,ticketNumber:T,seats:{},seatingType:{}})}l=r.getSpan().nextText("Your itinerary").nextAnyTag("table"),tagNum=l.getTagNumber(),l=l.allInnerTags("tr"+tagNum).map(function(e){return e.allInnerTags("td"+tagNum).map(function(e){return e.innerTag("td"+(int(tagNum)+1)).exists()?e.allInnerTagsFiltered("td"+(int(tagNum)+1)):e.tagContents()})}).filter(function(e){return e.length>=6});for(var N=0;l.length>N;N++){n=[];for(var y=0;l[N].length>y;y++)l[N][y]instanceof Array?n=n.concat(l[N][y]):n.push(l[N][y]);l[N]=n}for(var N=0;l.length>N;N++)if(l[N][0].innerDate().exists()){s=l[N],p=combineDateAndTime(s[0].innerDate(),s[1].innerDate()),c=combineDateAndTime(s[0].lastInnerDate(),s[1].lastInnerDate()),n=s[2].innerCapture(/^($<departureAirport>.*?)(?:\s+\(($<departureCode>[A-Z]{3})\))?\s+to\s+($<arrivalAirport>.*?)(?:\s+\(($<arrivalCode>[A-Z]{3})\))?$/),m=n?n.$departureAirport:null,g=n?n.$departureCode:null,h=n?n.$arrivalAirport:null,d=n?n.$arrivalCode:null,u=s[3],i=s[4];var C=""+s[5]=="N/A"?"":s[5],A=/Select seat/.test(""+s[6])?"":s[6];valid(i,u)&&(valid(C)&&(v[""+i].membershipNumber=C,v[""+i].programName="Frequent Flyer"),valid(A)&&(v[""+i].seats[""+u]=A)),ASSERT(u,p,m,c,h)&&b.push({airlineName:"JetBlue",airlineCode:"B6",flightNumber:u,departureTime:p,departureCode:g,departureAirport:m,arrivalTime:c,arrivalCode:d,arrivalAirport:h,passengers:v})}for(var k=[],N=0;b.length>N;N++)for(var x=b[N],S=Object.keys(x.passengers),y=0;S.length>y;y++){var $=x.passengers[S[y]],F={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode,flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:$.name},checkinUrl:a,reservationId:t,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:$.totalPrice,priceCurrency:$.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:$.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:$.seats[x.flightNumber],seatingType:$.seatingType[x.flightNumber]}}};valid($.membershipNumber,$.programName)&&(F.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:$.membershipNumber,programName:$.programName}),k.push(F)}if(k.length)return k}}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/112/223/224","SG4bb0ac88"),new ReverseTemplate("jetblue.com-itinerary-checkin-2014",function(e){return/^Itinerary for your upcoming trip$/.test(e.subject)||/^Check in for your flight to/.test(e.subject)},function(e){if(/^Itinerary for your upcoming trip$/.test(e.subject)||/^Check in for your flight to/.test(e.subject)){var r=Scanner.fromMessage(e);if(r.setLocale("en_US"),r.getSpan().nextRegExp(/Ticket number\(s\)/).exists()){var t,a,n,i,o,s,l,u,p,m,g,c,h,d,b,v=[],f={};t=r.getSpan().innerCapture(/\bYour confirmation number is (\w+)[.\s]/,1),a=r.getSpan().nextText("Skip the line, check in now!").nextTag("td2").innerLink(),not(a)&&(a=r.getSpan().nextText("Your confirmation number is").nextTag("table3").allInnerLinks(),a=5==a.length?a[1]:null),o=r.getSpan().nextRegExp(/Ticket number\(s\)/).parentTag("table3").allInnerTagsFiltered("td3").slice(2);for(var T=0;o.length>T;T++)o[T].innerCapture(/($<name>.*) <.*?>/)&&(i=o[T].innerCapture(/($<name>.*) <.*?>/,1),s=o[T+1]&&o[T+1].innerCapture(/^(\d+)$/,1)),valid(i)&&(f[""+i]={name:i,ticketNumber:s,seats:{},seatingType:{}}),i=null;u=r.getSpan().nextText("Your itinerary").nextAnyTag("table"),tagNum=u.getTagNumber(),u=u.allInnerTags("tr"+tagNum).map(function(e){return e.allInnerTags("td"+tagNum).map(function(e){return e.innerTag("td"+(int(tagNum)+1)).exists()?e.allInnerTagsFiltered("td"+(int(tagNum)+1)):e.tagContents()})}).filter(function(e){return e.length>=6});for(var N=0;u.length>N;N++){n=[];for(var y=0;u[N].length>y;y++)u[N][y]instanceof Array?n=n.concat(u[N][y]):n.push(u[N][y]);u[N]=n}for(var N=0;u.length>N;N++)if(u[N][0].innerDate().exists()){l=u[N],m=combineDateAndTime(l[0].innerDate(),l[1].innerDate()),h=combineDateAndTime(l[0].lastInnerDate(),l[1].lastInnerDate()),n=l[2].innerCapture(/^($<departureAirport>.*?)(?:\s+\(($<departureCode>[A-Z]{3})\))?\s+to\s+($<arrivalAirport>.*?)(?:\s+\(($<arrivalCode>[A-Z]{3})\))?$/),g=n?n.$departureAirport:null,c=n?n.$departureCode:null,d=n?n.$arrivalAirport:null,b=n?n.$arrivalCode:null,p=l[3],i=l[4];var C=""+l[5]=="N/A"?"":l[5],A=/Select seat/.test(""+l[6])?"":l[6];valid(i,p)&&(valid(C)&&(f[""+i].membershipNumber=C,f[""+i].programName="Frequent Flyer"),valid(A)&&(f[""+i].seats[""+p]=A)),ASSERT(p,m,g,h,d)&&v.push({airlineName:"JetBlue",airlineCode:"B6",flightNumber:p,departureTime:m,departureCode:c,departureAirport:g,arrivalTime:h,arrivalCode:b,arrivalAirport:d,passengers:f})}for(var k=[],N=0;v.length>N;N++)for(var x=v[N],S=Object.keys(x.passengers),y=0;S.length>y;y++){var $=x.passengers[S[y]],F={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:x.airlineName,airlineCode:x.airlineCode,flightNumber:x.flightNumber,departureAirportFuzzy:x.departureAirport,departureAirportCode:x.departureCode,departureTime:x.departureTime,arrivalAirportFuzzy:x.arrivalAirport,arrivalAirportCode:x.arrivalCode,arrivalTime:x.arrivalTime},underName:{"@type":"http://schema.org/Person",name:$.name},checkinUrl:a,reservationId:t,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:$.totalPrice,priceCurrency:$.priceCurrency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:$.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:$.seats[x.flightNumber],seatingType:$.seatingType[x.flightNumber]}}};valid($.membershipNumber,$.programName)&&(F.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:$.membershipNumber,programName:$.programName}),k.push(F)}if(k.length)return k}}},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/112/223/225","SG9042978f")]);