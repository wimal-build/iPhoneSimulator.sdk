// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,p,o,d,g=[],m=[];for(p=a.getSpan().next(t.code).parentTag("td4").tagContents().innerCapture(regExpFormatted(/\1(.*)/,t.code),1).trim(),i=a.getSpan().innerCapture(regExpFormatted(/\1(.*),/,t.dear),1).trim(),n=a.getSpan().next(t.manage);n.next(t.checkIn).exists();){var l={},u=n.nextTag("table3").allInnerTagsFiltered("td3"),s=u[0].tagContents(),c=u[1].split("\u2212");l.departureAirport=c[0].trim(),l.arrivalAirport=c[1].trim();var h=u[2].split("\u2212");l.departureAirportCode=h[0].trim(),l.arrivalAirportCode=h[1].trim(),l.flightNumber=n.nextTag("table5").nextTag("tr5").nextTag("tr5").tagContents().innerCapture(/(\d+)/,1);var T=n.nextTag("table6").next(/\d{2}:\d{2}/),v=T.nextTag("tr6").innerTag("td6").tagContents(),x=s+" "+v;x=x.replace(/[^\.\d\s:]+/g,""),dTimeStr=s+" "+T,dTimeStr=dTimeStr.replace(/[^\.\d\s:]+/g,""),l.departureTime=getFuzzyDate(a.getDetachedSpan(dTimeStr)),l.arrivalTime=getFuzzyDate(a.getDetachedSpan(x)),-1!==(""+v.parentTag("td6")).indexOf("+1")&&(l.arrivalTime=modifyDate(l.arrivalTime,1)),ASSERT(l.departureAirport,l.arrivalAirport,l.departureTime,l.arrivalTime,l.flightNumber)&&g.push(l),n=n.next(t.checkIn)}for(var C=0;g.length>C;C++){var l=g[C],A={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:"Lufthansa",airlineCode:"LH",flightNumber:l.flightNumber,departureAirportFuzzy:l.departureAirport,departureAirportCode:l.departureAirportCode,departureTime:l.departureTime,arrivalAirportFuzzy:l.arrivalAirport,arrivalAirportCode:l.arrivalAirportCode,arrivalTime:l.arrivalTime},underName:{"@type":"http://schema.org/Person",name:i},checkinUrl:"",reservationId:p,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:o,priceCurrency:d,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:p,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:"",seatingType:""}}};m.push(A)}return m.length?m:void 0}}).call();