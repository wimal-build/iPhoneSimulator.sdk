// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,r){var a,n,i,m,p,g,o,s,l,d,T,x,u,h,c=[],b=/[A-Z]{2,3}/,v=/[0-9]{3,4}[a-zA-Z]?/,f=Scanner.fromMessage(e),y=[];f.setLocale(t);var C,N,A;for(C=f.getSpan().nextTag("table1"),N=C.nextTag("tr1").nextTag("tr1"),d=N.nextText(r.reservationIdLabel).parentTag("td1").innerCapture(regExpFormatted(/\1\s*([A-Za-z0-9]*)/,r.reservationIdLabel),1).tagContents(),N=C.nextText(r.passengerCellTitle).nextTag("tr1");-1===(""+N.nextTag("td1")).indexOf(r.fromLabel);){var L={},F=N.allInnerTags("td1");if(N=N.nextTag("tr1"),!(2>F.length)){L.ticketNumber=F[1].tagContents().trim(),L.name=F[0].tagContents();var S=f.getSpan().nextText(r.id);S.exists()&&F.length>=4&&(L.membershipNumber=F[2].tagContents().trim(),L.programName=S.nextTag("td1").tagContents()),c.push(L)}}var z,k,E,D;for(N=N.nextText(r.fromLabel).parentTag("tr1");N!==f.getNullSpan();){A=N.nextTag("td1"),m=A.tagContents().innerCapture(regExpFormatted(/\1\s*([\w \.\-]*)/,r.fromLabel),1).trim(),A=A.nextTag("td1"),o=A.innerCapture(regExpFormatted(/\1\s*([\w \.\-]*)/,r.toLabel),1).trim(),A=A.nextTag("td1"),z=A.innerCapture(regExpFormatted(/.*(\1)\s*(\2).*/,b,v)),z&&(n=z[1],i=z[2]),a="",-1!=(""+A.nextTag("td1").nextTag("td1")).indexOf(r.codeshareLabel)&&(a=A.nextTag("td1").nextTag("td1").innerCapture(regExpFormatted(/\1\s+([^\[]*).*$/,r.codeshareLabel),1).trim()),g=A.nextText(r.departureTimeLabel).nextDate(),departureTimeArray=g.split(", "),departureTimeArray&&2==departureTimeArray.length&&(E=departureTimeArray[0]);var I=0;if(l=A.nextText(r.arrivalTimeLabel).nextDate(),-1!=(""+A.nextText(r.arrivalTimeLabel).parentTag("td1")).indexOf("+1")&&(I=1),arrivalTimeArray=l.split(", ")){if(1==arrivalTimeArray.length&&E){D=arrivalTimeArray[0];var O=f.getDetachedSpan(""+E+" "+D);l=O.innerDate(),l=modifyDate(l,I)}}else l=null;if(h=A.nextText(r.class).parentTag("td1").innerCapture(regExpFormatted(/\1\s+([^\[]*).*$/,r.class),1).trim(),ASSERT(n,i,g,m,l,o))for(var L=0;c.length>L;L++){var R=c[L],k={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:a,airlineCode:n,flightNumber:i,departureAirportFuzzy:m,departureAirportCode:p,departureTime:g,arrivalAirportFuzzy:o,arrivalAirportCode:s,arrivalTime:l},underName:{"@type":"http://schema.org/Person",name:R.name},checkinUrl:"",reservationId:d,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:T,priceCurrency:x,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:R.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatingType:h,seatNumber:u}}};valid(OR(R.membershipNumber,R.programName))&&(k.programMembershipUsed={"@type":"http://schema.org/ProgramMembership",membershipNumber:R.membershipNumber,programName:R.programName}),y.push(k)}N=N.nextTag("tr1").nextText(r.fromLabel).parentTag("tr1")}return y.length?y:void 0}}).call();