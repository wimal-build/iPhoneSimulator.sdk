// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var r=Scanner.fromMessage(e);r.setLocale(t);var a,i,o,d,p,s,x,g,c,T,l,m,u,h,f,P,C,v,k,A,y;o=r.getSpan().innerCapture(regExpFormatted(/\1 (\d+)/,n.confirmationNumberPrefix),1),o.exists()||(o=r.getSpan().innerCapture(regExpFormatted(/\1 (\d+)/,n.confirmationNumberAlternatePrefix),1)),u=r.getSpan().nextText(n.detailsHeader).nextTag("table1"),u.exists()||(u=r.getSpan().nextText(n.detailsAlternateHeader).nextTag("table1")),a=u.innerText(n.namePrefix).nextTag("td1").nextTag("td1").tagContents(),i=u.innerText(n.emailPrefix).nextTag("td1").nextTag("td1").tagContents().innerCapture(/(.*)\s?/,1),T=u.innerText(n.vehicleTypePrefix).nextTag("td1").nextTag("td1").tagContents(),T=T.split("-"),T=T.length?T[T.length-1].trim():null;var N=u.innerText(n.pickupHeader).withEnd(u.innerText(n.dropoffHeader).getStart());v=N.innerText(n.pickupNamePrefix).nextTag("td1").nextTag("td1").tagContents(),y=N.innerText(n.pickupTimePrefix).nextTag("td1").nextTag("td1").innerDate(),k=N.innerText(n.pickupAddressPrefix).nextTag("td1").nextTag("td1"),k=k.tagContents().getLength()>k.innerAddress().getLength()||not(k.innerAddress())?k.tagContents():k.innerAddress(),A=N.innerText(n.pickupTelephonePrefix).nextTag("td1").nextTag("td1"),A=A.innerPhoneNumber()?A.innerPhoneNumber():A.tagContents();var R=u.innerText(n.dropoffHeader).withEnd(u.getEnd());h=R.innerText(n.pickupNamePrefix).nextTag("td1").nextTag("td1").tagContents(),C=R.innerText(n.pickupTimePrefix).nextTag("td1").nextTag("td1").innerDate(),f=R.innerText(n.pickupAddressPrefix).nextTag("td1").nextTag("td1"),f=f.tagContents().getLength()>f.innerAddress().getLength()||not(f.innerAddress())?f.tagContents():f.innerAddress(),f=not(f)&&valid(R.innerText(n.pickupAddressPrefix).parentTag("td1").innerAddress())?R.innerText(n.pickupAddressPrefix).parentTag("td1").innerAddress():R.innerCapture(regExpFormatted(/\1 ([-\w\n, ]+)\2/,n.pickupAddressPrefix,n.pickupTelephonePrefix),1).trim(),P=R.innerText(n.pickupTelephonePrefix).nextTag("td1").nextTag("td1"),P=P.innerPhoneNumber()?P.innerPhoneNumber():P.tagContents(),not(P)&&(P=R.innerCapture(regExpFormatted(/\1 ([-.+() \d]+)(?: ext|\n)/,n.pickupTelephonePrefix),1)),/^National Car Rental Reservation Cancellation/.test(e.subject)&&(d="Cancelled");var S=u.innerCapture(/\(($<priceCurrency>[A-Z]{3})\)\s+Approximate Estimated Conversion:\s+.*?($<totalPrice>[\d,.]+)/);return g=S?S.$totalPrice:null,c=S?S.$priceCurrency:null,s=r.getSpan().nextText(n.modifyReservationUrlPrefix).nextLink(),x=r.getSpan().nextText(n.modifyReservationUrlPrefix).nextLink(),(not(h)||valid(h,v)&&""+v==""+h)&&(f=k,not(P)&&(P=A)),ASSERT(a,T,o,y,OR(v,k))?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:g,priceCurrency:c,reservationId:o,reservationStatus:"http://schema.org/Reservation"+(d||"Confirmed"),checkinUrl:p,modifyReservationUrl:s,cancelReservationUrl:x,underName:{"@type":"http://schema.org/Person",name:a,email:i},provider:{"@type":"http://schema.org/Organization",name:"National"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:T},license:l,color:m},pickupTime:y,pickupLocation:{"@type":"http://schema.org/Place",name:v,telephone:A,address:k},dropoffTime:C,dropoffLocation:{"@type":"http://schema.org/Place",name:h,telephone:P,address:f}}]:void 0}}).call();