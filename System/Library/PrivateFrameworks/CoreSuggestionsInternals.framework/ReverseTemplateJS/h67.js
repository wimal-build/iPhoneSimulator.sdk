// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,r,t){var a=Scanner.fromMessage(e);a.setLocale(r);var i,n,p,o,s,u=[],l=[];t.reservationId.test(e.subject)&&(o=t.reservationId.exec(e.subject)[1]);for(var m=a.getSpan().next(t.itinerary);m.exists();)i={},n=regExpFormatted(/\1\s*(.*)/,t.departureAirport),i.departureAirport=m.next(n).innerCapture(n,1),n=regExpFormatted(/\n\1\s*(.*)/,t.arrivalAirport),i.arrivalAirport=m.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*($<airlineCode>\D+)($<flightNr>\d+)/,t.flight),p=m.next(n).innerCapture(n),i.airlineCode=p.$airlineCode,i.flightNumber=p.$flightNr,n=regExpFormatted(/\1\s*(.*)/,t.depart),i.departureDate=m.next(n).innerDate(),n=regExpFormatted(/\1\s*(.*)/,t.arrival),i.arrivalDate=m.next(n).innerDate(),n=regExpFormatted(/\1\s*(.*)/,t.cabin),i.seatType=m.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*(.*)/,t.codeShare),i.airlineName=m.next(n).innerCapture(n,1),n=regExpFormatted(/\1\s*(.*)/,t.passenger),i.passengerName=m.next(n).innerCapture(n,1),ASSERT(i.airlineName,i.airlineCode,i.flightNumber,i.departureDate,i.departureAirport,i.arrivalDate,i.arrivalAirport)&&l.push(i),m=m.next(t.itinerary);for(var d=0;l.length>d;d++){s=l[d];var g={"@context":"http://schema.org","@type":"http://schema.org/FlightReservation",reservationFor:{"@type":"http://apple.com/FuzzyFlight",airlineName:s.airlineName,airlineCode:s.airlineCode,flightNumber:s.flightNumber,departureAirportFuzzy:s.departureAirport,departureTime:s.departureDate,arrivalAirportFuzzy:s.arrivalAirport,arrivalTime:s.arrivalDate},underName:{"@type":"http://schema.org/Person",name:s.passengerName},reservationId:o,reservationStatus:"http://schema.org/ReservationConfirmed",totalPrice:s.price,priceCurrency:s.currency,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s.ticketNumber,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:s.seatNumber,seatingType:s.seatType}}};u.push(g)}return u.length?u:void 0}}).call();