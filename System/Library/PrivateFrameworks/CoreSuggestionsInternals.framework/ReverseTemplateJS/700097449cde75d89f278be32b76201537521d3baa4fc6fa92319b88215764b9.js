// Copyright 2014 Apple Inc.  All Rights Reserved.
new ReverseTemplateList([new ReverseTemplate("ticketmaster.com-1",function(){return!0},function(e){if(/ticketmaster\.ca/.test(e.plain))return CONTINUE;var t=Scanner.fromMessage(e);t.setLocale("en_US");var n,r,a,s,i,p,o,c,u,d,g,m,S,h,$,l,x;if(startsWith(e.subject,"Event Reminder"))n=t.getSpan().innerCapture(/Hi (.*?)[.,]/,1),g=n.nextLink(),d=g.parentAnyTag("td").tagContents().innerCapture(/\b(.*) <.*?>/,1),m=t.getSpan().nextText("When:").nextDate(),not(m)&&(m=getFuzzyDate(d.nextTag("table3"))),x=t.getSpan().nextText("Where:").nextTag("td7").tagContents().innerCapture(/\b($<place>.*) <(?:.*)>\s($<address>[\s\S]+?)</),x&&($=x.$place,l=m.nextAddress(),(""+l).length<(""+x.$address.trim()).length&&(l=x.$address.trim())),not(l)&&(l=d.nextTag("table3").nextTag("table3").innerAddress(),$=l.parentTag("td3").tagContents().innerCapture(/\b(.*) <.*?>/,1)),i=t.getSpan().nextText("View Your Tickets").nextLink();else if(startsWith(e.subject,"Your Ticketmaster Order")){s=t.getSpan().innerCapture(/Your order number for this purchase is (.*?)\./,1);var T=["PRINT YOUR TICKETS","Print my tickets"];for(var v in T)if(t.getSpan().nextText(T[v]).exists()){i=t.getSpan().innerCapture(RegExp(regExpEscape(T[v])+" <(.*)>"),1);break}i||(i=t.getSpan().innerCapture(/Show complete order detail <(.*)>/,1)),m=t.getSpan().nextRegExp(/You purchased (.*) to:/).nextDate();var C=RegExp("You purchased ($<numSeats>.*) to:(?:[\\s_]+)\\b($<eventName>.*)\\s\\b($<address>.*)\\s(?:[\\s\\S]+)\\bOrder for: ($<name>.*)\\s\\bSeat location:(?: section ($<seatSection>.*?),?)?(?: row ($<seatRow>.*?),?)?(?: seats ($<seat>.*?))?\\s\\bTotal Charge: ($<priceCurrency>\\w+)?(.*?)($<price>[\\d.,]+)\\s");x=t.getSpan().innerCapture(C),x&&(p=x.$numSeats,d=x.$eventName,l=x.$address,n=x.$name,u=x.$seatSection,c=x.$seatRow,o=x.$seat,r=x.$price,a=x.$priceCurrency)}else{if(!startsWith(e.subject,"Your tickets have been printed!"))return CONTINUE;n=t.getSpan().innerCapture(/Hello (\w+),/,1),s=t.getSpan().innerCapture(/Order Number: (.*)\s/,1),m=s.nextDate(),l=m.nextAddress(),x=m.super(l),x=x.innerCapture(/\b($<eventName>.*) <($<eventUrl>.*)>/),x&&(d=x.$eventName,g=x.$eventUrl)}return ASSERT(m,d)?[{"@context":"http://schema.org","@type":"http://schema.org/EventReservation",name:n,totalPrice:r,priceCurrency:a,reservedTicket:{"@type":"http://schema.org/Ticket",ticketNumber:s,ticketToken:i,ticketedSeat:{"@type":"http://schema.org/Seat",seatNumber:o,seatRow:c,seatSection:u}},reservationFor:{"@type":"http://schema.org/Event",eventStatus:"http://schema.org/EventConfirmed",name:d,url:g,startDate:m,endDate:S,location:{"@type":"http://schema.org/Place",name:$,telephone:h,address:l}}}]:void 0},"0/1/2/3/4/5/3/5/6/6/6/6/4/7/726/760/763","SGa43ce21a")]);