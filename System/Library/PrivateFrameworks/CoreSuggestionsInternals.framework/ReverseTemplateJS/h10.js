// Copyright 2014 Apple Inc.  All Rights Reserved.
(function(){return function(e,t,n){var a=Scanner.fromMessage(e);a.setLocale(t);var r,i,p,o,g,s,c,l,d,u,m,C,h,x,S,T,v,f,b,y,k;if(n.confirm.test(e.subject)){p=a.getSpan().innerCapture(n.reservationId,1),r=(""+a.getSpan().innerCapture(n.guestName,1)).trim();var D=a.getSpan().nextRegExp(n.bookingDetails).nextTag("table4").tagContents();k=D.innerDate(),y=D.innerPhoneNumber(),b=D.innerAddress(),0===(""+b).length&&(D=""+D,D=D.substr(0,D.indexOf(""+y)),D=D.split("\n"),D=""+D.slice(2).join("\n"),b=D);var P=a.getSpan().nextRegExp(n.bookingDetails).nextTag("table4").nextTag("table4").tagContents();v=P.innerDate(),T=P.innerPhoneNumber(),S=P.innerAddress(),0===(""+S).length&&(P=""+P,P=P.substr(0,P.indexOf(""+T)),P=P.split("\n"),P=""+P.slice(2).join("\n"),S=P),u=a.getSpan().nextText(n.car).nextTag("table4").nextTag("td4").nextTag("td4").nextTag("td4").nextTag("td4").tagContents(),l=a.getSpan().nextText(n.totalPrice).nextTag("td5").tagContents().innerCapture(/([\d,.]+)/,1),d=a.getSpan().nextText(n.totalPrice).nextTag("td5").tagContents().innerCapture(/([^\d,.]+)/,1),c=s=a.getSpan().nextText(n.modifyUrl).parentTag("td3").innerLink()}else{if(!n.cancel.test(e.subject))return CONTINUE;p=a.getSpan().innerCapture(n.cancellationId,1),r=a.getSpan().innerCapture(n.guestNameCancel,1),i=a.getSpan().innerCapture(n.guestEmailCancel,1);var D=""+a.getSpan().innerCapture(n.pickUp,1);D=D.split("\n"),k=""+D[0],b=D[1]+"\n"+D[2],y=""+D[3];var h=""+a.getSpan().innerCapture(n.pickUp,1);h=h.split("\n"),k=getFuzzyDate(a.getDetachedSpan(""+h[0])),b=h[1]+"\n"+h[2],y=""+h[3];var h=""+a.getSpan().innerCapture(n.dropOff,1);h=h.split("\n"),v=getFuzzyDate(a.getDetachedSpan(""+h[0])),S=h[1]+"\n"+h[2],T=""+h[3],u=a.getSpan().innerCapture(n.carCancel,1);var R=a.getSpan().innerCapture(n.priceCancel,1);l=R.innerCapture(/([\d,.]+)/,1),d=R.innerCapture(/([^\d,.]+)/,1),o="Cancelled"}return ASSERT(p,r,u,b,k)?[{"@context":"http://schema.org","@type":"http://schema.org/RentalCarReservation",totalPrice:l,priceCurrency:d,reservationId:p,reservationStatus:"http://schema.org/Reservation"+(o||"Confirmed"),checkinUrl:g,modifyReservationUrl:s,cancelReservationUrl:c,underName:{"@type":"http://schema.org/Person",name:r,email:i},provider:{"@type":"http://schema.org/Organization",name:"Budget"},reservationFor:{"@type":"http://schema.org/Car",brand:{"@type":"http://schema.org/Organization",name:u},license:m,color:C},pickupTime:k,pickupLocation:{"@type":"http://schema.org/Place",name:f,telephone:y,address:b},dropoffTime:v,dropoffLocation:{"@type":"http://schema.org/Place",name:x,telephone:T,address:S}}]:void 0}}).call();